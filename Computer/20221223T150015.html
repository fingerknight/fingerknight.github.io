<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title> GiHub Page + Cloudflare + NameSilo 的域名配置 - Ward of Dust </title>
<meta name="author" content="MrDust">
<link rel="shortcut icon" href="/static/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="/static/Slippery/style.css"><link rel="stylesheet" type="text/css" href="/static/style.css">
</head>
<body>
<div id="preamble" class="status">
<div class="header">
<div class="title">
<a href="/">Ward of Dust</a>
</div>
<div class="navigation">
<a class="item" href="/archive.html">Archives</a>
<a class="item" href="/taxonomy.html">Taxonomy</a>
<a class="item" href="/about.html">About</a></div>
</div>
</div>
<div id="content" class="content">
<h1 class="title">GiHub Page + Cloudflare + NameSilo 的域名配置</h1>
<div class="post">
<div class="metadata">
<div class="date"><span>2022-12-23</span></div>
<div class="tags">
<a class="tag" href="/tag/cloudflare.html">#cloudflare</a> <a class="tag" href="/tag/dns.html">#dns</a> <a class="tag" href="/tag/githubpage.html">#githubpage</a> <a class="tag" href="/tag/namesilo.html">#namesilo</a> <a class="tag" href="/tag/site.html">#site</a> <a class="tag" href="/tag/post.html">#post</a></div>
<div class="category">
<a href="/category/Computer.html">$Computer</a>
</div>
</div>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#简介">简介</a></li>
<li><a href="#域名购买">域名购买</a></li>
<li><a href="#域名配置">域名配置</a></li>
<li><a href="#Cloudflare 接管">Cloudflare 接管</a>
<ul>
<li><a href="#注册站点">注册站点</a></li>
<li><a href="#托管域名服务器">托管域名服务器</a></li>
<li><a href="#Cloudflare 域名解析">Cloudflare 域名解析</a></li>
<li><a href="#配置 HTTPS">配置 HTTPS</a></li>
<li><a href="#Github Page 自定义域名">Github Page 自定义域名</a></li>
<li><a href="#问题记录">问题记录</a>
<ul>
<li><a href="#301 无限循环">301 无限循环</a></li>
<li><a href="#无效 TSL ，状态码返回 526">无效 TSL ，状态码返回 526</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-简介" class="outline-2">
<h2 id="简介"><a href="#简介">简介</a></h2>
<div class="outline-text-2" id="text-orga2a23b5">
<p>
先是折腾了一下 GitHub Page 的子项目，目的是可以让博客和其他项目分开（比如我想做的一些教程），分别用不同的模板。详见：<a target="_blank" href="github-page-project.html">GitHub Page 多项目</a>。
</p>

<p>
老早就想有一个自己的域名 —— 主要还是之前用的好友的域名买设备施展魔法，然后发现速度不行，还是得用人家的服务。折腾 GitHub Page 多项目的时候发现有些文章提到子域名，这么一想感觉也挺合适。于是在好友的推荐下给自己的博客买了个域名，这里记录一下过程。
</p>
</div>
</div>

<div id="outline-container-域名购买" class="outline-2">
<h2 id="域名购买"><a href="#域名购买">域名购买</a></h2>
<div class="outline-text-2" id="text-org3324a8d">
<p>
好友推荐了几个厂商，口碑都不错，如下：
</p>
<ul class="org-ul">
<li><a target="_blank" href="https://www.godaddy.com/">Domain Names, Websites, Hosting &amp; Online Marketing Tools - GoDaddy SG</a></li>
<li><a target="_blank" href="https://porkbun.com">porkbun.com | An oddly satisfying experience.</a></li>
<li><a target="_blank" href="https://alldomains.hosting">alldomains.hosting | Web Hosting &amp; 400+ Domains kaufen | 1A Qualität</a></li>
<li><a target="_blank" href="https://www.namesilo.com/">Cheap Domain Names &amp; Web Hosting Starting at $0.99! | NameSilo</a></li>
</ul>

<p>
最终我选择了 <a target="_blank" href="https://www.namesilo.com/">NameSilo</a> ，一个是它比较实惠，二是我在它找到了 <code>.icu</code> 的后缀，我更没有理由不拿。
</p>

<p>
购买过程就很简单，注册帐号，搜索域名，认准之后就下单，选择支付宝支付，这就到手了。
</p>

<p>
具体可以参考这篇文章：<a target="_blank" href="https://zhuanlan.zhihu.com/p/33921436">Namesilo 域名购买及使用教程（附 Namesilo 优惠码） - 知乎</a>，里面连配置都给说了。
</p>

<p>
注意看好价格呀，它一般<b>首年会优惠</b>，之后回到正常价格，所以别看人家很便宜，然后直接买个好几年。支付的时候也注意一下，别搞错了。
</p>
</div>
</div>

<div id="outline-container-域名配置" class="outline-2">
<h2 id="域名配置"><a href="#域名配置">域名配置</a></h2>
<div class="outline-text-2" id="text-org383a65b">
<p>
配置也可以参照<a href="#域名购买">域名购买</a>那一章贴出的文章。
</p>

<p>
因为 NameSilo 它家的管理界面很老，有些不习惯，不小心就找不到按钮 —— 它按钮藏在很像广告的框框里，并不是我眼睛不好。
</p>

<p>
进入域名管理 <code>Manage My Domains</code> ，在右上角那里
</p>


<div id="orgdf14e4c" class="figure">
<p><a href="/../assets/c8c0d75715d376f91190068dde89cab8.png" target="_blank">
<img src="/../assets/c8c0d75715d376f91190068dde89cab8.png" alt="c8c0d75715d376f91190068dde89cab8.png" /></a>
</p>
</div>

<p>
点对应的域名右边那个蓝色小球球。
</p>


<div id="org034c608" class="figure">
<p><a href="/../assets/cdeeea8d0f5ca16cab1c908c6f641cd0.png" target="_blank">
<img src="/../assets/cdeeea8d0f5ca16cab1c908c6f641cd0.png" alt="cdeeea8d0f5ca16cab1c908c6f641cd0.png" /></a>
</p>
</div>

<p>
进去之后先把默认的配置删了，然后自己手动配置。
</p>

<p>
找到自己的域名要指向的 IP 。比如我是为了用在 GitHub Page 上的，所以先 ping 站点的 GitHub 的 IP ，目前结合网上的资料，现在 GitHub 这 4 个 IP 没变过：
</p>


<div id="orgdf9b77c" class="figure">
<p><a href="/../assets/9aa17c8f8c41011ec245843f6a6cb32c.png" target="_blank">
<img src="/../assets/9aa17c8f8c41011ec245843f6a6cb32c.png" alt="9aa17c8f8c41011ec245843f6a6cb32c.png" /></a>
</p>
</div>


<p>
选其中一个建一条 <code>A</code> 记录。
</p>


<div id="org74e38d1" class="figure">
<p><a href="/../assets/4abebe736284c38dc258bcfb83a3bcb7.png" target="_blank">
<img src="/../assets/4abebe736284c38dc258bcfb83a3bcb7.png" alt="4abebe736284c38dc258bcfb83a3bcb7.png" /></a>
</p>
</div>


<div id="orgdd8ae19" class="figure">
<p><a href="/../assets/13a51a1ddf38e2a82eb64cf90b4630a4.png" target="_blank">
<img src="/../assets/13a51a1ddf38e2a82eb64cf90b4630a4.png" alt="13a51a1ddf38e2a82eb64cf90b4630a4.png" /></a>
</p>
</div>

<p>
我可以再建一条 <code>CNAME</code> 用来指向 <code>example.com</code> 或者 <code>&lt;name&gt;.github.io</code> 。也可以配置两条 <code>A</code> 记录，参考：<a target="_blank" href="https://zhuanlan.zhihu.com/p/86961133">Namesilo DNS 域名解析教程和常见问题解决方法汇总 - 知乎</a>
</p>

<p>
至此，域名就配好了。
</p>
</div>
</div>

<div id="outline-container-Cloudflare 接管" class="outline-2">
<h2 id="Cloudflare 接管"><a href="#Cloudflare 接管">Cloudflare 接管</a></h2>
<div class="outline-text-2" id="text-org2883148">
<p>
虽然是在 NameSilo 注册的域名，但是我想把它托管到 <a target="_blank" href="https://www.cloudflare.com/">Cloudflare</a> 上 <sup class="fsup"><a id="fnr.1.1" class="footref" href="#fn.1" role="doc-backlink">[1]</a></sup>。
</p>
</div>

<div id="outline-container-注册站点" class="outline-3">
<h3 id="注册站点"><a href="#注册站点">注册站点</a></h3>
<div class="outline-text-3" id="text-orgaff37b0">
<p>
新添加一个站点，把域名填进去，
</p>


<div id="org54c7a6a" class="figure">
<p><a href="/../assets/3f0aa95577cc3c7c4d08029b5cc33c98.png" target="_blank">
<img src="/../assets/3f0aa95577cc3c7c4d08029b5cc33c98.png" alt="3f0aa95577cc3c7c4d08029b5cc33c98.png" /></a>
</p>
</div>

<p>
一系列操作后拿到两条 <code>Name Server</code> (NS) 的记录：
</p>
<ul class="org-ul">
<li><code>chance.ns.cloudflare</code></li>
<li><code>gloria.ns.cloudflare.com</code></li>
</ul>
</div>
</div>

<div id="outline-container-托管域名服务器" class="outline-3">
<h3 id="托管域名服务器"><a href="#托管域名服务器">托管域名服务器</a></h3>
<div class="outline-text-3" id="text-org6231090">
<p>
回到 NameSilo ，勾域名前面的勾，然点上面的 <code>Change NameServer</code> （我真的觉得整个页面充斥着一股广告味儿）<sup class="fsup"><a id="fnr.2.1" class="footref" href="#fn.2" role="doc-backlink">[2]</a></sup>。
</p>


<div id="orgbd16610" class="figure">
<p><a href="/../assets/6c54da8b7631e8a1d6a6f385547fe2ca.png" target="_blank">
<img src="/../assets/6c54da8b7631e8a1d6a6f385547fe2ca.png" alt="6c54da8b7631e8a1d6a6f385547fe2ca.png" /></a>
</p>
</div>

<p>
把里面默认的三条记录删掉，然后把 Cloudflare 的两条域名服务器添加。
</p>


<div id="orga849cfc" class="figure">
<p><a href="/../assets/88bf55525984d3808aeaee570ec04a16.png" target="_blank">
<img src="/../assets/88bf55525984d3808aeaee570ec04a16.png" alt="88bf55525984d3808aeaee570ec04a16.png" /></a>
</p>
</div>

<p>
一旦 Cloudflare 接管之后，原来在 NameSilo的那些记录就用不了了，需要的 CLoudflare 去管理。
</p>
</div>
</div>

<div id="outline-container-Cloudflare 域名解析" class="outline-3">
<h3 id="Cloudflare 域名解析"><a href="#Cloudflare 域名解析">Cloudflare 域名解析</a></h3>
<div class="outline-text-3" id="text-org50dcfdd">
<p>
在 Cloudflare 的 DNS 配置中添加如下记录：
</p>
<ul class="org-ul">
<li>A 记录，名字 <code>你的域名</code> ，地址 <code>185.199.108.153</code></li>
<li>A 记录，名字 <code>你的域名</code> ，地址 <code>185.199.109.153</code></li>
<li>A 记录，名字 <code>你的域名</code> ，地址 <code>185.199.110.153</code></li>
<li>A 记录，名字 <code>你的域名</code> ，地址 <code>185.199.111.153</code></li>
<li>CNAME 记录，名字 <code>WWW</code> ，目标 <code>&lt;name&gt;.github.io</code>, <code>&lt;name&gt;</code> 是你 GiHub 的名字</li>
</ul>
</div>
</div>

<div id="outline-container-配置 HTTPS" class="outline-3">
<h3 id="配置 HTTPS"><a href="#配置 HTTPS">配置 HTTPS</a></h3>
<div class="outline-text-3" id="text-org536b0c3">
<p>
在 SSl/TLS 里的 Edge Certification 里选上 <code>Always Use HTTPS</code>.
</p>
</div>
</div>


<div id="outline-container-Github Page 自定义域名" class="outline-3">
<h3 id="Github Page 自定义域名"><a href="#Github Page 自定义域名">Github Page 自定义域名</a></h3>
<div class="outline-text-3" id="text-orgfebf323">
<p>
最后在 Github Page 设置自定义域名即可。
</p>
</div>
</div>

<div id="outline-container-问题记录" class="outline-3">
<h3 id="问题记录"><a href="#问题记录">问题记录</a></h3>
<div class="outline-text-3" id="text-orgcb6525f">
</div>
<div id="outline-container-301 无限循环" class="outline-4">
<h4 id="301 无限循环"><a href="#301 无限循环">301 无限循环</a></h4>
<div class="outline-text-4" id="text-orge9a238a">
<p>
我刚配好 Cloudflare 的时候出现了这个问题，那就是请求域名的时候，放回的全是 HTTP 状态码 301 ，然后跳转的 location 还是当前的链接，最终导致无限重定向。
</p>

<p>
这个问题有前辈之前遇到过并记录了，感谢<sup class="fsup"><a id="fnr.3.1" class="footref" href="#fn.3" role="doc-backlink">[3]</a></sup>！
</p>

<p>
简单说，就是更改一下 Cloudflare 的 HTTPS 的策略。
</p>


<div id="orgcbb0e11" class="figure">
<p><a href="/../assets/2a437aee52b1deb6c80331da2fcea284.png" target="_blank">
<img src="/../assets/2a437aee52b1deb6c80331da2fcea284.png" alt="2a437aee52b1deb6c80331da2fcea284.png" /></a>
</p>
</div>
</div>
</div>

<div id="outline-container-无效 TSL ，状态码返回 526" class="outline-4">
<h4 id="无效 TSL ，状态码返回 526"><a href="#无效 TSL ，状态码返回 526">无效 TSL ，状态码返回 526</a></h4>
<div class="outline-text-4" id="text-org00e1f84">
<p>
问题情景我忘记截图了，去网上借了一张 <sup class="fsup"><a id="fnr.4.1" class="footref" href="#fn.4" role="doc-backlink">[4]</a></sup>
</p>


<div id="org038c495" class="figure">
<p><a href="/../assets/09152539f0fecb54777a5aa9d2a3a1be.png" target="_blank">
<img src="/../assets/09152539f0fecb54777a5aa9d2a3a1be.png" alt="09152539f0fecb54777a5aa9d2a3a1be.png" /></a>
</p>
</div>

<p>
折腾了一波，最后找到了答案，感谢前辈们 <sup class="fsup"><a id="fnr.5.1" class="footref" href="#fn.5" role="doc-backlink">[5]</a></sup> <sup>, </sup><sup class="fsup"><a id="fnr.6.1" class="footref" href="#fn.6" role="doc-backlink">[6]</a></sup> ！
</p>

<p>
首先检查 GitHub Page 的设置，在输入了自定义域名之后，下面有个 <code>Enforce HTTPS</code> ，但是我勾不了，旁边有一行解释：
</p>
<blockquote>
<p>
Unavailable for your site because your domain is not properly configured to support HTTPS
</p>
</blockquote>

<p>
但具体没说为什么，给了一个 FAQ 的链接也没说清楚。我去 ping 了我的域名的地址，发现返回的是 Cloudflare 的地址。根据文章的建议，修改 Cloudflare 的域名解析的代理模式，在添加新条目时，它默认是 <code>Proxied</code>, 我把所有的都关了，变成 <code>DNS Only</code>. 等一会儿之后再 ping 就能解析到 Github 的地址上面。
</p>


<div id="org1c3bf98" class="figure">
<p><a href="/../assets/67fcc343bb0b1975a8208b5364c4a9f3.png" target="_blank">
<img src="/../assets/67fcc343bb0b1975a8208b5364c4a9f3.png" alt="67fcc343bb0b1975a8208b5364c4a9f3.png" /></a>
</p>
</div>

<p>
最后，先把 Github Page 之前填写的自定义域名删掉，等 <code>&lt;name&gt;.github.io</code> 能够正常访问之后再重新配一次。然后它提示说正在处理，等个 15 分钟（still 忘记截图），过了一会儿之后再回来就可以勾选 <code>Enforce HTTPS</code> 了。
</p>

<p>
这时候再次访问域名就没有 526 错误了。
</p>

<p>
（但是我这几个月都没设置，它也好好的，这几天才发现访问不到）
</p>
</div>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div id="fn.1" class="footdef"><span class="footnum"> (1) </span><a class="foot2ref" href="#fnr.1.1" role="doc-backlink"> ⇑ </a>
 <div class="footpara" role="doc-footnote"><p class="footpara">
<a target="_blank" href="https://monkeywie.cn/2020/08/20/fast-github-page-with-cloudflare/">使用cloudflare免费加速github page | MonkeyWie's Blog</a>
</p></div></div>

<div id="fn.2" class="footdef"><span class="footnum"> (2) </span><a class="foot2ref" href="#fnr.2.1" role="doc-backlink"> ⇑ </a>
 <div class="footpara" role="doc-footnote"><p class="footpara">
<a target="_blank" href="https://hostdash.com/kb/article/change-namesilo-nameservers/">How To Change Your Nameservers At NameSilo | HostDash</a>
</p></div></div>

<div id="fn.3" class="footdef"><span class="footnum"> (3) </span><a class="foot2ref" href="#fnr.3.1" role="doc-backlink"> ⇑ </a>
 <div class="footpara" role="doc-footnote"><p class="footpara">
<a target="_blank" href="https://vircloud.net/operations/enable-cloudflare-ssl.html#selection-21.17-21.22">如何正确启用 CloudFlare SSL - VirCloud's Blog - Learning&amp;Sharing</a>
</p></div></div>

<div id="fn.4" class="footdef"><span class="footnum"> (4) </span><a class="foot2ref" href="#fnr.4.1" role="doc-backlink"> ⇑ </a>
 <div class="footpara" role="doc-footnote"><p class="footpara">
<a target="_blank" href="https://bobcares.com/blog/how-to-fix-cloudflare-error-526-invalid-ssl-certificate/">How to fix Cloudflare error 526 – Invalid SSL certificate</a>
</p></div></div>

<div id="fn.5" class="footdef"><span class="footnum"> (5) </span><a class="foot2ref" href="#fnr.5.1" role="doc-backlink"> ⇑ </a>
 <div class="footpara" role="doc-footnote"><p class="footpara">
<a target="_blank" href="https://zhuanlan.zhihu.com/p/494971703">cloudflare解析域名 - 知乎</a>
</p></div></div>

<div id="fn.6" class="footdef"><span class="footnum"> (6) </span><a class="foot2ref" href="#fnr.6.1" role="doc-backlink"> ⇑ </a>
 <div class="footpara" role="doc-footnote"><p class="footpara">
<a target="_blank" href="https://cloud.tencent.com/developer/news/381127">自定义域名Github Page 博客Hugo配置 https - 腾讯云开发者社区-腾讯云</a>
</p></div></div>


</div>
</div></div>
</div>
<div id="postamble" class="status">
<center>
Powered by <a href="https://orgmode.org">Org Mode</a>.
</center>
</div>
<script src="/static/script.js"></script>
</body>
</html>
