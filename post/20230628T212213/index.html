<!DOCTYPE html>
<html>
<head>
<title>Bspwm 桌面 - 手指骑士的病房</title>
<link rel="icon" href="/static/favicon.ico"><link href= "/static/style/style.css" rel="stylesheet" type="text/css" /></head>
<body>
<div id="header">
<div class="home-page">
<a href="/">手指骑士的病房</a></div><div class="nav">
<div class="nav item">
<a href="/tags">标签</a>
</div>
<div class="nav item">
<a href="/archive">归档</a>
</div>
<div class="nav item">
<a href="/about">关于</a>
</div>
<div class="nav item">
<a href="/emacs">Emacs</a>
</div>
</div>
</div>
<div id="main">
<div id="toc">
<h2 class="toc-title"> TOC </h2>
<nav id="TableOfContents">

<ul>
<li>
<a href="#org0831eda"> 前言 </a></li>
<li>
<a href="#orgb119c3c"> 配置 bspwm </a>
<ul>
<li>
<a href="#org82e5fa4"> bspwm 的几个概念 </a></li>
<li>
<a href="#org9254ff0"> bspc config </a></li>
<li>
<a href="#orgc515edd"> bspc rule </a>
<ul>
<li>
<a href="#orgfa4ad26"> bspc rule: cmd </a></li>
<li>
<a href="#orgdf2bf13"> bspc rule: obj </a></li>
<li>
<a href="#org2e349be"> bspc rule: arg </a></li>
<li>
<a href="#org72a8726"> bspc 例子 </a></li>
</ul>
</li>
<li>
<a href="#org55766b7"> 程序启动 </a></li>
</ul>
</li>
<li>
<a href="#org95ee48f"> bspc 的查询与控制 </a>
<ul>
<li>
<a href="#org7c0bec9"> bspc query </a></li>
<li>
<a href="#org389d801"> bspc 的控制 </a>
<ul>
<li>
<a href="#orgfae46e8"> bspc node [node-selector] </a></li>
<li>
<a href="#org8749c4e"> bspc desktop [node-selector] </a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#orgd255cc6"> sxhkd 配置 </a></li>
<li>
<a href="#org1e6a496"> 基础功能 </a>
<ul>
<li>
<a href="#org0accdb8"> 登录界面 </a></li>
<li>
<a href="#orge8b8366"> 锁屏界面 </a></li>
<li>
<a href="#org821c28b"> picom 混成器 </a></li>
<li>
<a href="#org32d2084"> 通知 </a></li>
<li>
<a href="#org083cbad"> 程序启动器 </a></li>
<li>
<a href="#org83bf940"> GUI 认证 </a></li>
<li>
<a href="#org27b4b7a"> 状态栏 </a></li>
<li>
<a href="#orge45845e"> 壁纸 </a></li>
</ul>
</li>
<li>
<a href="#org2d10aeb"> 后记 </a></li>
</ul>
</nav>
</div>
<div id="page">
<div id="preamble" class="status"><link rel="stylesheet" href="/static/pygments/dracula.css"><h1 class="post-title"> Bspwm 桌面 </h1>
<div class="post-date">2023-07-02</div>
<div class="taglist"><a href="/tag/archlinux"> #archlinux </a>
<a href="/tag/bspwm"> #bspwm </a>
<a href="/tag/wm"> #wm </a>
</div>
</div>
<div id="content">

<div id="outline-container-org0831eda" class="outline-2">
<h2 id="org0831eda">前言</h2>
<div class="outline-text-2" id="text-org0831eda">
<p>
五月中旬的时候处处看到 <a href="https://hyprland.org" target="_blank">Hyprland</a> 的消息，看到人家的桌面各种动画各种丝滑，于是自己整了个来玩玩。折腾了一段时间，最后选择放弃，最主要的原因是 Wayland 在我的电脑上并不稳定，体现在各种软件经常莫名其妙的崩溃，报一些 protocol 的错；且目前比较多的软件对 Wayland 不友好，甚至不支持。我用的浏览器是 Vivaldi, Chromium 系，在 Wayland 下用不了 fcitx5 打字。再者就是分辨率的问题不太好调。目前再观望一段时间（一两年？），等 Wayland 再成熟和普及一些，让子弹飞一会儿。
</p>

<p>
既然入了 tiling wm （平铺桌面）的坑，手中的 KDE 和 Gnome 就不香了，于是先后尝试了 <a href="https://i3wm.org" target="_blank">i3</a> 和 <a href="https://github.com/baskerville/bspwm" target="_blank">bspwm</a>. i3 生态比较成熟，插件较为丰富，然最后没有选择 i3 而是 bspwm 的原因有三：一是混成器下圆角窗口的边框显示有问题，二是我在折腾 Hyprland 时的状态栏 EWW 在 i3 下会有问题，三是 i3 本身不自带我想要的那种对半对半的分割窗口，需要插件，而 bspwm 自带。最终转到了 bspwm. 说转就转还得基于二者的都是开箱即用，没有什么依赖（我确实在暗示全家桶的行为）。
</p>
</div>
</div>

<div id="outline-container-org9039582" class="outline-2">
<h2 id="org9039582">安装 <sup>[<a id="fnr:1.1" class="footref" href="#fn:1">1</a>]</sup></h2>
<div class="outline-text-2" id="text-org9039582">
<p>
x11 桌面协议是必须的。bspwm 就是一个桌面，简单得不能再简单，因此需要额外两个工具：
</p>
<ol class="org-ol">
<li>sxhkd, 系统快捷键绑定</li>
<li>picom, 混成器，窗口各种样式设定</li>
</ol>

<div class="org-src-container">
<pre class="shell"> pacmcan<span class="w"> </span>-S<span class="w"> </span>xorg<span class="w"> </span>bspwm<span class="w"> </span>xshbd<span class="w"> </span>picom </pre>
</div>
</div>
</div>

<div id="outline-container-orgb119c3c" class="outline-2">
<h2 id="orgb119c3c">配置 bspwm</h2>
<div class="outline-text-2" id="text-orgb119c3c">
<p>
配置文件在 <code>~/.config/bspwm/bspwmrc</code>. 样板配置在 <code>/usr/share/doc/bspwm/examples/bspwmrc</code>, 复制过来即可。它给了几个函数的使用方法。
</p>

<p>
首先第一行 <code>pgrep -x sxhkd &gt; /dev/null || sxhkd &amp;</code> 就是检查 sxhkd 是否存在，否，则启动。
</p>

<p>
第二行（命令）重命名了各个桌面，它默认把它命名为罗马数字，我直接用阿拉伯数字，方便一些。
</p>

<p>
BSPWM 通过 <a href="https://en.wikipedia.org/wiki/Inter-process_communication" target="_blank">IPC</a>(inter-process communication) 了控制，即桌面启动了一个服务器，我们用一个客户端通过 socket 去控制它。可以看到配置其实就是一个 shell 脚本，而出现的 bpsc 就是那个 bspwm client.
</p>

<p>
bspc 的 manual 给出了比较详细的说明，通过 <code>man bspc</code> 阅读。
</p>

<p>
这里先贴一下我的 bspwmrc. 随后再对几个主要用的功能进行阐述。
</p>

<div class="org-src-container">
<pre class="shell"> <span class="ch">#! /bin/sh</span>

<span class="c1">## Monitor setting</span>
bspc<span class="w"> </span>monitor<span class="w"> </span>-d<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="m">10</span>

<span class="c1">## Bspwm Config</span>
<span class="c1"># 边框宽度</span>
bspc<span class="w"> </span>config<span class="w"> </span>border_width<span class="w"> </span><span class="m">3</span>
<span class="c1"># 窗口到屏幕顶部的填充，给状态栏腾出位置</span>
bspc<span class="w"> </span>config<span class="w"> </span>top_padding<span class="w"> </span><span class="m">45</span>
<span class="c1"># 窗口之间的间距</span>
bspc<span class="w"> </span>config<span class="w"> </span>window_gap<span class="w"> </span><span class="m">15</span>
<span class="c1"># 屏幕分割比例</span>
bspc<span class="w"> </span>config<span class="w"> </span>split_ratio<span class="w"> </span><span class="m">0</span>.5
<span class="c1"># 焦距跟随鼠标</span>
bspc<span class="w"> </span>config<span class="w"> </span>focus_follows_pointer<span class="w"> </span><span class="nb">true</span>
<span class="c1"># 焦距窗口的边框颜色</span>
bspc<span class="w"> </span>config<span class="w"> </span>focused_border_color<span class="w"> </span><span class="s2">&quot;#bd93f9&quot;</span>

<span class="c1">## Bspwm Rules</span>
bspc<span class="w"> </span>rule<span class="w"> </span>-a<span class="w"> </span>Emacs<span class="w"> </span><span class="nv">state</span><span class="o">=</span>tiled
bspc<span class="w"> </span>rule<span class="w"> </span>-a<span class="w"> </span>Vivaldi-stable<span class="w"> </span><span class="nv">desktop</span><span class="o">=</span><span class="m">1</span>
bspc<span class="w"> </span>rule<span class="w"> </span>-a<span class="w"> </span><span class="s2">&quot;Image Lounge&quot;</span><span class="w"> </span><span class="nv">state</span><span class="o">=</span>floating
bspc<span class="w"> </span>rule<span class="w"> </span>-a<span class="w"> </span><span class="s2">&quot;gui.py&quot;</span><span class="w"> </span><span class="nv">state</span><span class="o">=</span>floating
bspc<span class="w"> </span>rule<span class="w"> </span>-a<span class="w"> </span><span class="s2">&quot;Emacs:SIMPLEMPC&quot;</span><span class="w"> </span><span class="nv">state</span><span class="o">=</span>floating<span class="w"> </span><span class="nv">center</span><span class="o">=</span>on<span class="w"> </span><span class="nv">rectangle</span><span class="o">=</span><span class="s2">&quot;1080x720+0+0&quot;</span>
bspc<span class="w"> </span>rule<span class="w"> </span>-a<span class="w"> </span><span class="s2">&quot;Emacs:IDMANAGER&quot;</span><span class="w"> </span><span class="nv">state</span><span class="o">=</span>floating<span class="w"> </span><span class="nv">center</span><span class="o">=</span>on<span class="w"> </span><span class="nv">rectangle</span><span class="o">=</span><span class="s2">&quot;1080x720+0+0&quot;</span>
bspc<span class="w"> </span>rule<span class="w"> </span>-a<span class="w"> </span>GoldenDict<span class="w"> </span><span class="nv">state</span><span class="o">=</span>floating<span class="w"> </span><span class="nv">center</span><span class="o">=</span>on<span class="w"> </span><span class="nv">rectangle</span><span class="o">=</span><span class="s2">&quot;600x500+0+0&quot;</span>

<span class="c1">## Exec Once</span>
eww<span class="w"> </span>daemon

light-locker<span class="w"> </span>--no-late-locking<span class="w"> </span>--lock-on-suspend<span class="w"> </span>--lock-on-lid<span class="w"> </span><span class="p">&amp;</span>

pgrep<span class="w"> </span>-x<span class="w"> </span>sxhkd<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="o">||</span><span class="w"> </span>sxhkd<span class="w"> </span><span class="p">&amp;</span>

pgrep<span class="w"> </span>-x<span class="w"> </span>mpd<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="o">||</span><span class="w"> </span>mpd<span class="w"> </span><span class="p">&amp;</span>

/usr/bin/lxqt-policykit-agent<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="p">&amp;</span>

dunst<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="p">&amp;</span>

fcitx5<span class="w"> </span>--replace<span class="w"> </span>-d<span class="w"> </span>&gt;<span class="w"> </span>/dev/null

picom<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="p">&amp;</span>

<span class="c1"># python ~/DustDict/server.py &amp;</span>
goldendict<span class="w"> </span><span class="p">&amp;</span>

eww<span class="w"> </span>open<span class="w"> </span>bar </pre>
</div>
</div>

<div id="outline-container-org82e5fa4" class="outline-3">
<h3 id="org82e5fa4">bspwm 的几个概念</h3>
<div class="outline-text-3" id="text-org82e5fa4">
<ul class="org-ul">
<li>wm 桌面，指的整个 bspwm 桌面对象</li>
<li>monitor 显示器，索引从 0 开始</li>
<li>desktop 桌面，或者说工作区</li>
<li>node 窗口</li>
</ul>

<p>
依然层级依次展开， wm 下是 monitor, 然后是 desktop, 最后是 node. bspwm 的 node 可以是依附于 node 之下的，以树的形式存在。
</p>
</div>
</div>

<div id="outline-container-org9254ff0" class="outline-3">
<h3 id="org9254ff0">bspc config</h3>
<div class="outline-text-3" id="text-org9254ff0">
<p>
bspc config 用于设置一些变量，所有配置看 man 的 SETTINGS 章节，我只用到了一些基本的，在配置中给了注释。
</p>
</div>
</div>

<div id="outline-container-orgc515edd" class="outline-3">
<h3 id="orgc515edd">bspc rule</h3>
<div class="outline-text-3" id="text-orgc515edd">
<p>
用来设置窗口规则，主要是特例，比如字典我希望它是浮动在其他窗口之上，不参与平铺。
</p>

<p>
命令格式： <code>bspc rule [cmd] [obj] [arg]</code>
</p>
</div>

<div id="outline-container-orgfa4ad26" class="outline-4">
<h4 id="orgfa4ad26">bspc rule: cmd</h4>
<div class="outline-text-4" id="text-orgfa4ad26">
<p>
cmd 主要有三个:
</p>
<ul class="org-ul">
<li><code>-a</code> 添加规则</li>
<li><code>-r</code> 删除规则</li>
<li><code>-l</code> 列出所有规则</li>
</ul>
</div>
</div>

<div id="outline-container-orgdf2bf13" class="outline-4">
<h4 id="orgdf2bf13">bspc rule: obj</h4>
<div class="outline-text-4" id="text-orgdf2bf13">
<p>
规则作用的对象，一个字符串，格式是 <code>class:instance:name</code>. 如果没有冒号则是类。它就是对应到应用的窗口。比如我配置里面的。
</p>

<p>
如何知道应用的类和名字呢？打开应用之后，再打开一个终端，使用 <code>xprop</code> 命令，然后点击目标窗口。会得到应用的图形信息。
</p>

<p>
其中：
</p>
<ul class="org-ul">
<li><code>WM_CLASS</code> 应该是两个值，<b>后者</b>就是它的类。</li>
<li><code>WM_NAME</code> 就是 instance_name. 具体的 <code>WM_NAME</code> 和 <code>WM_ICON_NAME</code> ，以及 instance_name 和 name 之间的区别，这个是桌面前端开发的知识，我一窍不通。</li>
</ul>
</div>
</div>

<div id="outline-container-org2e349be" class="outline-4">
<h4 id="org2e349be">bspc rule: arg</h4>
<div class="outline-text-4" id="text-org2e349be">
<p>
对象的参数。主要用到的参数：
</p>
<ul class="org-ul">
<li><code>state</code> 窗口的呈现方式， <code>tiled</code> 是平铺式， <code>floating</code> 是浮动窗口</li>
<li><code>desktop</code> 表示窗口打开后所在的桌面。</li>
</ul>
</div>
</div>

<div id="outline-container-org72a8726" class="outline-4">
<h4 id="org72a8726">bspc 例子</h4>
<div class="outline-text-4" id="text-org72a8726">
<p>
首先是 Emacs, 它居然默认不是平铺的，所以需要给它弄一下。
</p>

<div class="org-src-container">
<pre class="shell"> bspc<span class="w"> </span>rule<span class="w"> </span>-a<span class="w"> </span>Emacs<span class="w"> </span><span class="nv">state</span><span class="o">=</span>tiled </pre>
</div>

<p>
然后是浏览器 vivaldi, 无论在哪个工作区，打开后它都会移动到工具区 1，用 <code>Win + 1</code> 跳转。这是一个老习惯，之前的 Windows, KDE, Gnome 都会把浏览器 pin 在任务栏的 1 号位置。
</p>

<div class="org-src-container">
<pre class="shell"> bspc<span class="w"> </span>rule<span class="w"> </span>-a<span class="w"> </span>Vivaldi-stable<span class="w"> </span><span class="nv">desktop</span><span class="o">=</span><span class="m">1</span> </pre>
</div>

<p>
接着是密码管理器。我用 Emacs 的插件 id-manager 来管理密码，它不能是平铺式的打乱其他窗口的布局，因为用了很快就会把它关掉。如果只设置 <code>Emacs</code> 类肯定不行，这样其他所有 Emacs 窗口都会浮动。因此特定为它设置了一个 name 叫 <code>IDMANAGER</code> （通过 Emacs 的输入参数 &#x2013;name ），这样就可以通 class + instance_name 来控制它。同时给它设置了 <code>center</code> 让它保持在屏幕中央。 <code>rectangle</code> 用来控制它的几何参数，设置它的大小以及偏移。没有偏移就设置成 0 。
</p>

<div class="org-src-container">
<pre class="shell"> bspc<span class="w"> </span>rule<span class="w"> </span>-a<span class="w"> </span><span class="s2">&quot;Emacs:IDMANAGER&quot;</span><span class="w"> </span><span class="nv">state</span><span class="o">=</span>floating<span class="w"> </span><span class="nv">center</span><span class="o">=</span>on<span class="w"> </span><span class="nv">rectangle</span><span class="o">=</span><span class="s2">&quot;1080x720+0+0&quot;</span> </pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org55766b7" class="outline-3">
<h3 id="org55766b7">程序启动</h3>
<div class="outline-text-3" id="text-org55766b7">
<p>
因为 bspwmrc 本身就是一个 shell 脚本，需要启动什么程序直接往里面加就行了。
</p>
</div>
</div>
</div>

<div id="outline-container-org95ee48f" class="outline-2">
<h2 id="org95ee48f">bspc 的查询与控制</h2>
<div class="outline-text-2" id="text-org95ee48f">
</div>
<div id="outline-container-org7c0bec9" class="outline-3">
<h3 id="org7c0bec9">bspc query</h3>
<div class="outline-text-3" id="text-org7c0bec9">
<p>
查询命令可以看 <a href="https://github.com/baskerville/bspwm/wiki/Command-Syntax-Rewrite#query-command" target="_blank">官网文档</a>，给的非常详细。事实上， <code>query</code> 并非如我所想能够查到比如窗口当前的 GUI 信息，它是用于查询<b>存在</b>状态，比如当前桌面有哪些窗口，列出 ID; 或者当前显示器有多少桌面等等。
</p>

<p>
我在写 EWW 状态栏的时候，要更加精细的查询是用 <code>bspc wm --dump-state</code>, 它会以 JSON 格式输出详细的桌面信息，配合命令行 JSON 工具 <a href="https://jqlang.github.io/jq/" target="_blank">jq</a> 来完成解析。我觉得这算是一个缺点吧。
</p>
</div>
</div>

<div id="outline-container-org389d801" class="outline-3">
<h3 id="org389d801">bspc 的控制</h3>
<div class="outline-text-3" id="text-org389d801">
<p>
控制很好理解，比如窗口移动、调整大小、设置参数等。
</p>

<p>
使用方式： <code>bspc &lt;obj&gt; [obj-selector] [arg]</code>
</p>

<p>
可控制对象 obj 是 monitor, desktop 以及 node （窗口）。接着指明具体对象，也就是 obj-selector ——它是一个选择器。如果指定对象，那么默认就是当前选择的对象。最后传入 <code>arg</code> 来完成对对象的操作和控制。
</p>

<p>
selector 除非特殊需求，不然一般用 name 或 ID 即可。
</p>
</div>

<div id="outline-container-orgfae46e8" class="outline-4">
<h4 id="orgfae46e8">bspc node [node-selector]</h4>
<div class="outline-text-4" id="text-orgfae46e8">
<ul class="org-ul">
<li><code>-f</code> 焦距到窗口</li>
<li><code>-d desktop</code> 移动窗口到指定桌面</li>
<li><code>-m monirotr</code> 移动窗口到指定显示器</li>
<li><code>-n node</code> 使窗口依附于指定窗口，用于某些特殊窗口布局</li>
<li><code>-s node</code> 与指定窗口交换位置</li>
<li><code>-t</code> 设置窗口状态，详见 <code>man bspc</code></li>
<li><code>-g</code> 设置窗口标志，详见 <code>man bspc</code></li>
<li><code>-c</code> 关闭窗口，允许应用询问，比如是否保存</li>
<li><code>-k</code> 结束窗口，不询问直接关闭</li>
</ul>
</div>
</div>

<div id="outline-container-org8749c4e" class="outline-4">
<h4 id="org8749c4e">bspc desktop [node-selector]</h4>
<div class="outline-text-4" id="text-org8749c4e">
<ul class="org-ul">
<li><code>-f</code> 焦距到桌面</li>
<li><code>-m monirotr</code> 移动窗口到指定显示器</li>
<li><code>-s node</code> 与指定桌面交换位置</li>
</ul>

<p>
bspc monitor 我没用到。
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd255cc6" class="outline-2">
<h2 id="orgd255cc6">sxhkd 配置</h2>
<div class="outline-text-2" id="text-orgd255cc6">
<p>
sxhkd 的配置文件是 <code>~/.config/sxhkd/sxhkdrc</code>, 样板在 <code>/usr/share/doc/bspwm/examples/sxkdrc</code>. 它配置的方式比较灵活，一行表示按键序列，下一行表示执行的操作。同样也是 shell 脚本，需要启动什么直接输入就行。
</p>

<p>
<a href="https://github.com/baskerville/sxhkd#example-bindings" target="_blank">官方文档</a>给出了几个例子，去看一下大致就知道了。更具体的可以 <code>man sxhkd</code>.
</p>

<p>
以下是我的配置。
</p>

<div class="org-src-container">
<pre class="shell"> <span class="c1"># make sxhkd reload its configuration files:</span>
super<span class="w"> </span>+<span class="w"> </span>Escape
<span class="w"> </span>pkill<span class="w"> </span>-USR1<span class="w"> </span>-x<span class="w"> </span>sxhkd

<span class="c1"># quit/restart bspwm</span>
super<span class="w"> </span>+<span class="w"> </span>alt<span class="w"> </span>+<span class="w"> </span><span class="o">{</span>q,r<span class="o">}</span>
<span class="w"> </span>bspc<span class="w"> </span><span class="o">{</span>quit,wm<span class="w"> </span>-r<span class="o">}</span>

<span class="c1"># focus the last desktop</span>
super<span class="w"> </span>+<span class="w"> </span>Tab
<span class="w"> </span>bspc<span class="w"> </span>desktop<span class="w"> </span>-f<span class="w"> </span>last

<span class="c1"># send to the given desktop</span>
super<span class="w"> </span>+<span class="w"> </span><span class="nb">shift</span><span class="w"> </span>+<span class="w"> </span><span class="o">{</span><span class="m">1</span>-9,0<span class="o">}</span>
<span class="w"> </span>bspc<span class="w"> </span>node<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;^{1-9,10}&#39;</span><span class="w"> </span>-f

<span class="c1"># focus to given desktop</span>
super<span class="w"> </span>+<span class="w"> </span><span class="m">1</span>
<span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="m">805615</span>
<span class="m">805628</span>
<span class="m">805629</span>
<span class="m">805635</span>
<span class="m">805657</span>
<span class="m">805658</span>
<span class="m">805667</span>
<span class="m">805693</span>
<span class="m">805718</span>
<span class="m">805738</span>
<span class="m">805747</span>
<span class="m">805757</span>
<span class="m">805765</span>
<span class="m">805837</span>
<span class="m">810560</span>
<span class="m">815480</span>
<span class="m">816742</span>
<span class="m">823381</span>
<span class="m">841439</span>
<span class="m">841705</span>
<span class="m">842785</span>
<span class="m">842927</span>
<span class="m">855002</span>
<span class="m">862639</span>
<span class="m">871438</span>
<span class="m">871587</span>
<span class="m">871588</span>
<span class="m">873122</span>
<span class="m">873220</span>
<span class="m">873359</span>
<span class="m">873373</span><span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>bspc<span class="w"> </span>desktop<span class="w"> </span>-f<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>vivaldi-stable
super<span class="w"> </span>+<span class="w"> </span><span class="o">{</span><span class="m">1</span>-9,0<span class="o">}</span>
<span class="w"> </span>bspc<span class="w"> </span>desktop<span class="w"> </span>-f<span class="w"> </span><span class="s1">&#39;^{1-9,10}&#39;</span>

<span class="c1"># expand a window by moving one of its side outward</span>
super<span class="w"> </span>+<span class="w"> </span>alt<span class="w"> </span>+<span class="w"> </span><span class="o">{</span>h,j,k,l<span class="o">}</span>
<span class="w"> </span>bspc<span class="w"> </span>node<span class="w"> </span>-z<span class="w"> </span><span class="o">{</span>left<span class="w"> </span>-20<span class="w"> </span><span class="m">0</span>,bottom<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">20</span>,top<span class="w"> </span><span class="m">0</span><span class="w"> </span>-20,right<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">0</span><span class="o">}</span>

<span class="c1"># contract a window by moving one of its side inward</span>
super<span class="w"> </span>+<span class="w"> </span>alt<span class="w"> </span>+<span class="w"> </span><span class="nb">shift</span><span class="w"> </span>+<span class="w"> </span><span class="o">{</span>h,j,k,l<span class="o">}</span>
<span class="w"> </span>bspc<span class="w"> </span>node<span class="w"> </span>-z<span class="w"> </span><span class="o">{</span>right<span class="w"> </span>-20<span class="w"> </span><span class="m">0</span>,top<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">20</span>,bottom<span class="w"> </span><span class="m">0</span><span class="w"> </span>-20,left<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">0</span><span class="o">}</span>

<span class="c1"># move a floating window</span>
super<span class="w"> </span>+<span class="w"> </span><span class="o">{</span>Left,Down,Up,Right<span class="o">}</span>
<span class="w"> </span>bspc<span class="w"> </span>node<span class="w"> </span>-v<span class="w"> </span><span class="o">{</span>-20<span class="w"> </span><span class="m">0</span>,0<span class="w"> </span><span class="m">20</span>,0<span class="w"> </span>-20,20<span class="w"> </span><span class="m">0</span><span class="o">}</span>

<span class="c1"># kill</span>
super<span class="w"> </span>+<span class="w"> </span>q
<span class="w"> </span>bspc<span class="w"> </span>node<span class="w"> </span>-c

<span class="c1"># focus the node in the given direction</span>
super<span class="w"> </span>+<span class="w"> </span><span class="o">{</span>h,j,k,l<span class="o">}</span>
<span class="w"> </span>bspc<span class="w"> </span>node<span class="w"> </span>-f<span class="w"> </span><span class="o">{</span>west,south,north,east<span class="o">}</span>

<span class="c1"># move the node in the given direction</span>
super<span class="w"> </span>+<span class="w"> </span><span class="nb">shift</span><span class="w"> </span>+<span class="w"> </span><span class="o">{</span>h,j,k,l<span class="o">}</span>
<span class="w"> </span>bspc<span class="w"> </span>node<span class="w"> </span>-s<span class="w"> </span><span class="o">{</span>west,south,north,east<span class="o">}</span>

<span class="c1">## APPLICATIONS</span>

<span class="c1"># super + t</span>
<span class="c1">#  kitty</span>
super<span class="w"> </span>+<span class="w"> </span>t
<span class="w"> </span>emacs<span class="w"> </span>-f<span class="w"> </span>eshell

super<span class="w"> </span>+<span class="w"> </span>e
<span class="w"> </span>emacs

super<span class="w"> </span>+<span class="w"> </span>w
<span class="w"> </span>bspc-open<span class="w"> </span>instance<span class="w"> </span><span class="s2">&quot;SIMPLEMPC&quot;</span><span class="w"> </span>emacs<span class="w"> </span>-f<span class="w"> </span>simple-mpc<span class="w"> </span>--name<span class="w"> </span>SIMPLEMPC

super<span class="w"> </span>+<span class="w"> </span>a
<span class="w"> </span>rofi<span class="w"> </span>-show<span class="w"> </span>drun

super<span class="w"> </span>+<span class="w"> </span>p
<span class="w"> </span>flameshot<span class="w"> </span>gui

super<span class="w"> </span>+<span class="w"> </span>z
<span class="w"> </span>light-locker-command<span class="w"> </span>-l

super<span class="w"> </span>+<span class="w"> </span>x
<span class="w"> </span>bspc-open<span class="w"> </span>instance<span class="w"> </span><span class="s2">&quot;IDMANAGER&quot;</span><span class="w"> </span>emacs<span class="w"> </span>-f<span class="w"> </span>id-manager-startup<span class="w"> </span>--name<span class="w"> </span>IDMANAGER<span class="w"> </span>

super<span class="w"> </span>+<span class="w"> </span>d
<span class="w"> </span>bspc-open<span class="w"> </span>class<span class="w"> </span><span class="s2">&quot;GoldenDict&quot;</span><span class="w"> </span>goldendict

super<span class="w"> </span>+<span class="w"> </span>f
<span class="w"> </span>bspc<span class="w"> </span>desktop<span class="w"> </span>-f<span class="w"> </span><span class="m">8</span><span class="p">;</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span>0x02C000B0<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>emacs<span class="w"> </span>-f<span class="w"> </span>setup-lazy-dirvish<span class="w"> </span>--name<span class="w"> </span>DIRVISH

super<span class="w"> </span>+<span class="w"> </span>r
<span class="w"> </span>bspc<span class="w"> </span>desktop<span class="w"> </span>-f<span class="w"> </span><span class="m">9</span><span class="p">;</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span>0x058000B0<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>emacs<span class="w"> </span>-f<span class="w"> </span>mu4e

super<span class="w"> </span>+<span class="w"> </span>o
<span class="w"> </span>bspc<span class="w"> </span>desktop<span class="w"> </span>-f<span class="w"> </span><span class="m">10</span><span class="p">;</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w">  </span><span class="o">]]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>emacs<span class="w"> </span>-f<span class="w"> </span><span class="s1">&#39;dust/org-journal-new-journal&#39;</span>

<span class="c1"># sound</span>
XF86Audio<span class="o">{</span>Lower,Raise<span class="o">}</span>Volume
<span class="w"> </span>pactl<span class="w"> </span>set-sink-volume<span class="w"> </span>@DEFAULT_SINK@<span class="w"> </span><span class="o">{</span>-,+<span class="o">}</span><span class="m">5</span>%

super<span class="w"> </span>+<span class="w"> </span><span class="o">{</span>comma,<span class="w"> </span>period<span class="o">}</span>
<span class="w"> </span>pactl<span class="w"> </span>set-sink-volume<span class="w"> </span>@DEFAULT_SINK@<span class="w"> </span><span class="o">{</span>-,<span class="w"> </span>+<span class="o">}</span><span class="m">5</span>%

XF86AudioMute
<span class="w"> </span>pactl<span class="w"> </span>set-sink-mute<span class="w"> </span>@DEFAULT_SINK@<span class="w"> </span>toggle

super<span class="w"> </span>+<span class="w"> </span>slash
<span class="w"> </span>pactl<span class="w"> </span>set-sink-mute<span class="w"> </span>@DEFAULT_SINK@<span class="w"> </span>toggle

<span class="c1"># microphone</span>
XF86AudioMicMute
<span class="w"> </span>pactl<span class="w"> </span>set-source-mute<span class="w"> </span>@DEFAULT_SOURCE@<span class="w"> </span>toggle

super<span class="w"> </span>+<span class="w"> </span><span class="o">{</span>bracketleft,bracketright<span class="o">}</span>
<span class="w"> </span>brightnessctl<span class="w"> </span>s<span class="w"> </span><span class="m">5</span>%<span class="o">{</span>-,+<span class="o">}</span>

<span class="c1"># backlight</span>
XF86MonBrightness<span class="o">{</span>Down,Up<span class="o">}</span>
<span class="w"> </span>brightnessctl<span class="w"> </span>s<span class="w"> </span><span class="m">5</span>%<span class="o">{</span>-,+<span class="o">}</span> </pre>
</div>

<p>
注意到，里面有系统音量和系统背光的设置 <sup>[<a id="fnr:1.2" class="footref" href="#fn:1">1</a>]</sup> 。具体还有那些按键，可以用命令 <code>xev -event keyboard</code>. 然后弹出一个 GUI, 在里面输入按键，会得到所示输出：
</p>


<figure id="org737b461">
<a href="/assets/4cfb1549b5c0b84bd890ea394d7e8a8e.png" target="_blank" target="_blank"><img src="/assets/4cfb1549b5c0b84bd890ea394d7e8a8e.png" alt="4cfb1549b5c0b84bd890ea394d7e8a8e.png"></a>

</figure>

<p>
画线的部分就是对应的按键（我按的是 <code>]</code>, 下面也表示了对应的字符。
</p>

<p>
And, <code>{}</code> 中的逗号后一定不要加空格（我在设背光灯的时候没注意，把笔记本屏幕调到全黑差点回不去）。
</p>
</div>
</div>

<div id="outline-container-org1e6a496" class="outline-2">
<h2 id="org1e6a496">基础功能</h2>
<div class="outline-text-2" id="text-org1e6a496">
</div>
<div id="outline-container-org0accdb8" class="outline-3">
<h3 id="org0accdb8">登录界面</h3>
<div class="outline-text-3" id="text-org0accdb8">
<p>
登录界面用的 lightdm. lightdm 是一个桌面管理器，它在 tty 后启动，显示登录的 GUI. 认证后再启动 bspwm. 所以单单中一个 lightdm 是不行的，还要装一个 greeter. 我用的是 lightdm-gtk-greeter.
</p>

<div class="org-src-container">
<pre class="shell"> pacman<span class="w"> </span>-S<span class="w"> </span>lightdm<span class="w"> </span>lightdm-slick-greeter </pre>
</div>

<p>
lightdm 默认的 greeter 是 gtk-gretter, 修改配置 <code>/etc/lightdm/lightdm.conf</code> <sup>[<a id="fnr:2.1" class="footref" href="#fn:2">2</a>]</sup>:
</p>

<div class="org-src-container">
<pre class="conf"> [Seat:*]
# ...
greeter-session=lightdm-slick-greeter
# ... </pre>
</div>

<p>
slick-greeter 的配置文件是 <code>/etc/lightdm/slick-greeter.conf</code>. 我的配置如下：
</p>

<div class="org-src-container">
<pre class="conf"> [Greeter]
show-hostname=false
show-a11y=false
show-power=true
show-keyboard=false
clock-format=%Y-%m-%d,%a %H:%M
# 路径要写绝对路径，因为登录界面的用户是 root
background=/home/mrdust/Pictures/arch1920.png
theme-name=Dracula
icon-theme-name=Dracula
cursor-theme-name=Dracula-cursors </pre>
</div>

<p>
可以使用 GUI 工具 <a href="https://github.com/linuxmint/lightdm-settings" target="_blank">lightdm-settings</a> 来设置。虽然但是，我的背景一直不生效，懒得弄了。
</p>

<p>
最后要添加自启动：
</p>

<div class="org-src-container">
<pre class="shell"> systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>--now<span class="w"> </span>lightdm </pre>
</div>
</div>
</div>

<div id="outline-container-orge8b8366" class="outline-3">
<h3 id="orge8b8366">锁屏界面</h3>
<div class="outline-text-3" id="text-orge8b8366">
<p>
使用 lightdm, 就可以很自然地使用 light-locker 作为锁屏。无需额外配置，直接把它开机自启动即可。 light-locker 的启动在写 bspwm 的配置中。
</p>

<div class="org-src-container">
<pre class="shell"> light-locker<span class="w"> </span>--no-late-locking<span class="w"> </span>--lock-on-suspend<span class="w"> </span>--lock-on-lid<span class="w"> </span><span class="p">&amp;</span> </pre>
</div>
</div>
</div>

<div id="outline-container-org821c28b" class="outline-3">
<h3 id="org821c28b">picom 混成器</h3>
<div class="outline-text-3" id="text-org821c28b">
<div class="org-src-container">
<pre class="shell"> pacman<span class="w"> </span>-S<span class="w"> </span>picom </pre>
</div>

<p>
配置 <code>~/.config/picom/picom.conf</code>, 样板在 <code>/etc/xdg/picom.conf</code>. 配置的注释足够详细，自己参阅着改就行。目前主要用到的功能只有窗口圆角。
</p>

<p>
在 bspwmrc 中添加启动：
</p>
<div class="org-src-container">
<pre class="shell"> picom<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="p">&amp;</span> </pre>
</div>
</div>
</div>

<div id="outline-container-org32d2084" class="outline-3">
<h3 id="org32d2084">通知</h3>
<div class="outline-text-3" id="text-org32d2084">
<p>
通知用的 dunst.
</p>

<div class="org-src-container">
<pre class="shell"> pacman<span class="w"> </span>-S<span class="w"> </span>dunst </pre>
</div>

<p>
配置文件是 <code>~/.config/dunst/dunstrc</code>, 样板在 <code>/etc/dunst/dunstrc</code>. 配置详细，自行修改。
</p>

<p>
在 bspwmrc 中添加启动：
</p>
<div class="org-src-container">
<pre class="shell"> dunst<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="p">&amp;</span> </pre>
</div>
</div>
</div>

<div id="outline-container-org083cbad" class="outline-3">
<h3 id="org083cbad">程序启动器</h3>
<div class="outline-text-3" id="text-org083cbad">
<p>
程序启动器用的 rofi, 开箱即用，无需配置。
</p>

<div class="org-src-container">
<pre class="shell"> pacman<span class="w"> </span>-S<span class="w"> </span>rofi </pre>
</div>

<p>
在 sxhkdrc 中绑定快捷键：
</p>
<div class="org-src-container">
<pre class="shell"> super<span class="w"> </span>+<span class="w"> </span>a
<span class="w"> </span>rofi<span class="w"> </span>-show<span class="w"> </span>drun </pre>
</div>
</div>
</div>

<div id="outline-container-org83bf940" class="outline-3">
<h3 id="org83bf940">GUI 认证</h3>
<div class="outline-text-3" id="text-org83bf940">
<p>
在图形应用中，有些操作需要提权，这是就需要 GUI 认证，叫 polkit. 安装一个轻量级的 lxqt-policykit-agent.
</p>

<div class="org-src-container">
<pre class="shell"> pacman<span class="w"> </span>-S<span class="w"> </span>lxqt-policykit-agent </pre>
</div>

<p>
在 bspwmrc 中添加启动：
</p>
<div class="org-src-container">
<pre class="shell"> /usr/bin/lxqt-policykit-agent<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="p">&amp;</span> </pre>
</div>
</div>
</div>
<div id="outline-container-org27b4b7a" class="outline-3">
<h3 id="org27b4b7a">状态栏</h3>
<div class="outline-text-3" id="text-org27b4b7a">
<p>
状态栏用的 <a href="https://elkowar.github.io/eww/" target="_blank">EWW</a>, 后面再写一篇文章介绍一下。
</p>
</div>
</div>

<div id="outline-container-orge45845e" class="outline-3">
<h3 id="orge45845e">壁纸</h3>
<div class="outline-text-3" id="text-orge45845e">
<p>
壁纸用 feh.
</p>

<div class="org-src-container">
<pre class="shell"> pacman<span class="w"> </span>-S<span class="w"> </span>feh </pre>
</div>

<p>
,这次直接添加到 crontab 每天换一张壁纸。（需要至少 366 张壁纸，但我现在 100 张都不到，所以现在壁纸都是黑的）
</p>

<div class="org-src-container">
<pre class="shell"> crontab<span class="w"> </span>-e

*<span class="w"> </span><span class="m">0</span><span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span><span class="nv">DISPLAY</span><span class="o">=</span>:0<span class="w"> </span>feh<span class="w"> </span>--bg-fill<span class="w"> </span>--no-fehbg<span class="w"> </span><span class="s2">&quot;/home/mrdust/Pictures/wallpaper/183&quot;</span> </pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org2d10aeb" class="outline-2">
<h2 id="org2d10aeb">后记</h2>
<div class="outline-text-2" id="text-org2d10aeb">
<p>
至此，bspwm 桌面就搭建好了。没有冗余的东西，清清爽爽。目前状态栏的功能主要就是看时间，或许以后纯键盘习惯之后直接就丢掉了，想看时间按一个按键弹出一个 widget （或者 Emacs ？), 过几秒自动消失，届时算是走火入魔了罢。
</p>

<p>
以上。
</p>
</div>
</div>
<div id="footnotes">
<hr>
<div class="text-footnotes" role="doc-endnotes">
<ol>
<li id="fn:1">
<p class="footpara">
<a href="https://zhuanlan.zhihu.com/p/568211941" target="_blank">从零开始的Bspwm安装与配置教程 - 知乎</a>
<a href="#fnr:1.1" class="footnote-backref" role="doc-backlink">↩︎</a>
<a href="#fnr:1.2" class="footnote-backref" role="doc-backlink">↩︎</a>
</p>
</li>
<li id="fn:2">
<p class="footpara">
<a href="https://wiki.archlinux.org/title/LightDM#Greeter" target="_blank">LightDM - ArchWiki</a>
<a href="#fnr:2.1" class="footnote-backref" role="doc-backlink">↩︎</a>
</p>
</li>
</ol>
</div>
</div>
</div>
<div id="postamble" class="status">
</div>
</div>
</div>
<div id="footer">
<center> The End </center></div>
</body>
</html>
