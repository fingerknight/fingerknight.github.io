<!DOCTYPE html>
<html>
<head>
<title>Emacs 配置 - 手指骑士的病房</title>
<link rel="icon" href="/static/favicon.ico"><link href= "/static/style/style.css" rel="stylesheet" type="text/css" /></head>
<body>
<div class="header">
<div class="home-page">
<a href="/">手指骑士的病房</a></div><div class="nav">
<div class="nav item">
<a href="/tags">标签</a>
</div>
<div class="nav item">
<a href="/archive">归档</a>
</div>
<div class="nav item">
<a href="/about">关于</a>
</div>
<div class="nav item">
<a href="/emacs">Emacs</a>
</div>
</div>
</div>
<div class="main">
<div id="preamble" class="status"><link rel="stylesheet" href="/static/pygments/dracula.css"><h1 class="post-title"> Emacs 配置 </h1>
</div>
<div id="content">

<div id="outline-container-org0dffa42" class="outline-2">
<h2 id="org0dffa42">前言</h2>
<div class="outline-text-2" id="text-org0dffa42">
<p>
Emacs 配置分享，下载路径在 GitHub 上：<a href="https://github.com/fingerknight/.emacs.d" target="_blank">https://github.com/fingerknight/.emacs.d</a>.
</p>
</div>
</div>

<div id="outline-container-orga63999b" class="outline-2">
<h2 id="orga63999b">前配置 early-init</h2>
<div class="outline-text-2" id="text-orga63999b">
</div>
<div id="outline-container-org74b5e3d" class="outline-3">
<h3 id="org74b5e3d">定义基本变量</h3>
<div class="outline-text-3" id="text-org74b5e3d">
<p>
定义家目录以及四个目录分类：
</p>
<ul class="org-ul">
<li><code>opt</code> 插件的存放路径</li>
<li><code>etc</code> 插件的配置的路径</li>
<li><code>var</code> 插件的数据的路径</li>
<li><code>usr</code> 子应用</li>
</ul>

<div class="org-src-container">
<pre> <span class="c1">;;; -*- lexical-binding: t; -*-</span>
<span class="p">(</span><span class="k">defconst</span><span class="w"> </span><span class="nv">user-home-directory</span>
<span class="w">  </span><span class="p">(</span><span class="nb">pcase</span><span class="w"> </span><span class="nv">system-type</span>
<span class="w">    </span><span class="p">(</span><span class="ss">&#39;windows-nt</span><span class="w"> </span><span class="s">&quot;%userprofile%/&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">otherwise</span><span class="w"> </span><span class="s">&quot;~/&quot;</span><span class="p">))</span>
<span class="w">  </span><span class="s">&quot;User Home directory&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="k">defconst</span><span class="w"> </span><span class="nv">user-data-directory</span>
<span class="w">  </span><span class="p">(</span><span class="nf">expand-file-name</span><span class="w"> </span><span class="s">&quot;var&quot;</span><span class="w"> </span><span class="nv">user-emacs-directory</span><span class="p">)</span>
<span class="w">  </span><span class="s">&quot;Where to save the emacs data&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="k">defconst</span><span class="w"> </span><span class="nv">user-config-directory</span>
<span class="w">  </span><span class="p">(</span><span class="nf">expand-file-name</span><span class="w"> </span><span class="s">&quot;etc&quot;</span><span class="w"> </span><span class="nv">user-emacs-directory</span><span class="p">)</span>
<span class="w">  </span><span class="s">&quot;Where to save the configurations&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="k">defconst</span><span class="w"> </span><span class="nv">user-module-directory</span>
<span class="w">  </span><span class="p">(</span><span class="nf">expand-file-name</span><span class="w"> </span><span class="s">&quot;opt&quot;</span><span class="w"> </span><span class="nv">user-emacs-directory</span><span class="p">)</span>
<span class="w">  </span><span class="s">&quot;Where to save the modules&quot;</span><span class="p">)</span>
<span class="c1">;; Create directories if necessary</span>
<span class="p">(</span><span class="nb">dolist</span><span class="w"> </span><span class="p">(</span><span class="nv">type</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;data&quot;</span><span class="w"> </span><span class="s">&quot;config&quot;</span><span class="w"> </span><span class="s">&quot;module&quot;</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="k">let*</span><span class="w"> </span><span class="p">((</span><span class="nv">var-name</span><span class="w"> </span><span class="p">(</span><span class="nf">intern</span><span class="w"> </span><span class="p">(</span><span class="nf">concat</span><span class="w"> </span><span class="s">&quot;user-&quot;</span>
<span class="w">                                   </span><span class="nv">type</span>
<span class="w">                                   </span><span class="s">&quot;-directory&quot;</span><span class="p">)))</span>
<span class="w">         </span><span class="p">(</span><span class="nv">dir</span><span class="w"> </span><span class="p">(</span><span class="nf">symbol-value</span><span class="w"> </span><span class="nv">var-name</span><span class="p">)))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">unless</span><span class="w"> </span><span class="p">(</span><span class="nf">file-directory-p</span><span class="w"> </span><span class="nv">dir</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="nv">make-directory</span><span class="w"> </span><span class="nv">dir</span><span class="p">))))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-orge418378" class="outline-3">
<h3 id="orge418378">启动加速 <sup>[<a id="fnr:1.1" class="footref" href="#fn:1">1</a>]</sup> <sup>, </sup><sup>[<a id="fnr:2.1" class="footref" href="#fn:2">2</a>]</sup></h3>
<div class="outline-text-3" id="text-orge418378">
<div class="org-src-container">
<pre> <span class="c1">;;; Basic settings</span>
<span class="c1">;; Speed up starting</span>
<span class="p">(</span><span class="k">setq</span><span class="w"> </span><span class="nv">gc-cons-percentage</span><span class="w"> </span><span class="nv">1.0</span>
<span class="w">      </span><span class="nv">gc-cons-threshold</span><span class="w"> </span><span class="nv">most-positive-fixnum</span>
<span class="w">      </span><span class="nv">package-enable-at-startup</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">      </span><span class="nv">inhibit-compacting-font-caches</span><span class="w"> </span><span class="no">t</span><span class="p">)</span>
<span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nv">old-file-name-handler-alist</span><span class="w"> </span><span class="nv">file-name-handler-alist</span><span class="p">))</span>
<span class="w">  </span><span class="c1">;; https://emacs.nasy.moe/#%E5%88%9D--early-init-</span>
<span class="w">  </span><span class="p">(</span><span class="k">setq-default</span><span class="w"> </span><span class="nv">file-name-handler-alist</span><span class="w"> </span><span class="no">nil</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">restore--default</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="s">&quot;Restore gc setting to default.&quot;</span>
<span class="w">    </span><span class="p">(</span><span class="k">setq</span><span class="w"> </span><span class="nv">file-name-handler-alist</span>
<span class="w">          </span><span class="p">(</span><span class="nv">delete-dups</span><span class="w"> </span><span class="p">(</span><span class="nf">append</span><span class="w"> </span><span class="nv">file-name-handler-alist</span>
<span class="w">                               </span><span class="nv">old-file-name-handler-alist</span><span class="p">))</span>
<span class="w">          </span><span class="nv">inhibit-trace</span><span class="w"> </span><span class="no">nil</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nv">add-hook</span><span class="w"> </span><span class="ss">&#39;emacs-startup-hook</span><span class="w"> </span><span class="nf">#&#39;</span><span class="nv">restore--default</span><span class="p">))</span>
<span class="p">(</span><span class="k">setq-default</span><span class="w"> </span><span class="nv">bidi-display-reordering</span><span class="w"> </span><span class="ss">&#39;left-to-right</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq-default</span><span class="w"> </span><span class="nv">bidi-paragraph-direction</span><span class="w"> </span><span class="ss">&#39;left-to-right</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span><span class="w"> </span><span class="nv">bidi-inhibit-bpa</span><span class="w"> </span><span class="no">t</span><span class="p">)</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-orgfb34cd5" class="outline-3">
<h3 id="orgfb34cd5">编码设置 <sup>[<a id="fnr:3.1" class="footref" href="#fn:3">3</a>]</sup></h3>
<div class="outline-text-3" id="text-orgfb34cd5">
<div class="org-src-container">
<pre> <span class="c1">;; Coding System</span>
<span class="p">(</span><span class="k">setq</span><span class="w"> </span><span class="nv">locale-coding-system</span><span class="w"> </span><span class="ss">&#39;utf-8</span><span class="p">)</span>
<span class="p">(</span><span class="nv">set-language-environment</span><span class="w"> </span><span class="s">&quot;UTF-8&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="nv">set-default-coding-systems</span><span class="w"> </span><span class="ss">&#39;utf-8</span><span class="p">)</span>
<span class="p">(</span><span class="nv">set-buffer-file-coding-system</span><span class="w"> </span><span class="ss">&#39;utf-8-unix</span><span class="p">)</span>
<span class="p">(</span><span class="nv">set-clipboard-coding-system</span><span class="w"> </span><span class="ss">&#39;utf-8-unix</span><span class="p">)</span>
<span class="p">(</span><span class="nv">set-file-name-coding-system</span><span class="w"> </span><span class="ss">&#39;utf-8-unix</span><span class="p">)</span>
<span class="p">(</span><span class="nv">set-keyboard-coding-system</span><span class="w"> </span><span class="ss">&#39;utf-8-unix</span><span class="p">)</span>
<span class="p">(</span><span class="nv">set-next-selection-coding-system</span><span class="w"> </span><span class="ss">&#39;utf-8-unix</span><span class="p">)</span>
<span class="p">(</span><span class="nv">set-selection-coding-system</span><span class="w"> </span><span class="ss">&#39;utf-8-unix</span><span class="p">)</span>
<span class="p">(</span><span class="nv">set-terminal-coding-system</span><span class="w"> </span><span class="ss">&#39;utf-8-unix</span><span class="p">)</span>
<span class="p">(</span><span class="nv">prefer-coding-system</span><span class="w"> </span><span class="ss">&#39;utf-8</span><span class="p">)</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-orgfad8752" class="outline-3">
<h3 id="orgfad8752">GUI 设置</h3>
<div class="outline-text-3" id="text-orgfad8752">
<p>
窗口最大化，关闭各种栏栏框框。
</p>

<div class="org-src-container">
<pre> <span class="c1">;; GUI</span>
<span class="p">(</span><span class="nv">add-to-list</span><span class="w"> </span><span class="ss">&#39;default-frame-alist</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="nv">fullscreen</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">maximized</span><span class="p">))</span>
<span class="p">(</span><span class="nv">add-to-list</span><span class="w"> </span><span class="ss">&#39;default-frame-alist</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="nv">vertical-scroll-bars</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="no">nil</span><span class="p">))</span>
<span class="p">(</span><span class="nv">add-to-list</span><span class="w"> </span><span class="ss">&#39;default-frame-alist</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="nv">horizontal-scroll-bars</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="no">nil</span><span class="p">))</span>
<span class="p">(</span><span class="nv">add-to-list</span><span class="w"> </span><span class="ss">&#39;default-frame-alist</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="nv">tool-bar-lines</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span>
<span class="p">(</span><span class="nv">add-to-list</span><span class="w"> </span><span class="ss">&#39;default-frame-alist</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="nv">menu-bar-lines</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org8541bb5" class="outline-3">
<h3 id="org8541bb5">杂七杂八的设置</h3>
<div class="outline-text-3" id="text-org8541bb5">
<div class="org-src-container">
<pre> <span class="c1">;; Misc</span>
<span class="p">(</span><span class="k">setq</span><span class="w"> </span><span class="nv">url-proxy-services</span><span class="w"> </span><span class="o">&#39;</span><span class="p">((</span><span class="s">&quot;http&quot;</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">&quot;127.0.0.1:7890&quot;</span><span class="p">)</span>
<span class="w">                           </span><span class="p">(</span><span class="s">&quot;https&quot;</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">&quot;127.0.0.1:7890&quot;</span><span class="p">))</span>
<span class="w">      </span><span class="nv">ring-bell-function</span><span class="w"> </span><span class="ss">&#39;ignore</span>
<span class="w">      </span><span class="nv">make-backup-files</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">      </span><span class="nv">mouse-wheel-scroll-amount</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="p">((</span><span class="nv">shift</span><span class="p">)</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">((</span><span class="nv">control</span><span class="p">)</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="no">nil</span><span class="p">))</span>
<span class="w">      </span><span class="nv">mouse-wheel-progressive-speed</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">      </span><span class="nv">next-line-add-newlines</span><span class="w"> </span><span class="nv">t</span>
<span class="w">      </span><span class="nv">confirm-kill-processes</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">      </span><span class="nv">enable-recursive-minibuffers</span><span class="w"> </span><span class="nv">t</span>
<span class="w">      </span><span class="nv">frame-inhibit-implied-resize</span><span class="w"> </span><span class="nv">t</span>
<span class="w">      </span><span class="nv">ad-redefinition-action</span><span class="w"> </span><span class="ss">&#39;accept</span>
<span class="w">      </span><span class="nv">inhibit-startup-message</span><span class="w"> </span><span class="nv">t</span>
<span class="w">      </span><span class="nv">inhibit-startup-echo-area-message</span><span class="w"> </span><span class="nv">t</span>
<span class="w">      </span><span class="nv">initial-major-mode</span><span class="w"> </span><span class="ss">&#39;fundamental-mode</span>
<span class="w">      </span><span class="nv">initial-scratch-message</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">      </span><span class="nv">initial-scratch-message</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">      </span><span class="nv">echo-keystrokes</span><span class="w"> </span><span class="mf">0.25</span><span class="p">)</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-orgeef567e" class="outline-3">
<h3 id="orgeef567e">结束 early-init</h3>
<div class="outline-text-3" id="text-orgeef567e">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nb">provide</span><span class="w"> </span><span class="ss">&#39;early-init</span><span class="p">)</span>
 </pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org54bb2a6" class="outline-2">
<h2 id="org54bb2a6">插件安装</h2>
<div class="outline-text-2" id="text-org54bb2a6">
<p>
我的插件安装基于 git, 简单说就是把插件仓库 git 到本地，然后调用，甚至懒得编译。写个安装函数，通过命令行执行 git 来 clone. 然后把插件目录下的插件路径都加入环境变量。
</p>

<div class="org-src-container">
<pre> <span class="c1">;;; -*- lexical-binding: t; -*-</span>
<span class="c1">;;; Packages</span>
<span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/package-installed-p</span><span class="w"> </span><span class="p">(</span><span class="nv">pkg</span><span class="p">)</span>
<span class="w">  </span><span class="s">&quot;If packages is installed&quot;</span>
<span class="w">  </span><span class="p">(</span><span class="nf">file-exists-p</span><span class="w"> </span><span class="p">(</span><span class="nf">expand-file-name</span>
<span class="w">                  </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nf">stringp</span><span class="w"> </span><span class="nv">pkg</span><span class="p">)</span>
<span class="w">                      </span><span class="nv">pkg</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">format</span><span class="w"> </span><span class="s">&quot;%s&quot;</span><span class="w"> </span><span class="nv">pkg</span><span class="p">))</span>
<span class="w">                  </span><span class="nv">user-module-directory</span><span class="p">)))</span>
<span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/package-install</span><span class="w"> </span><span class="p">(</span><span class="nv">pkg</span><span class="w"> </span><span class="nv">url</span><span class="p">)</span>
<span class="w">  </span><span class="s">&quot;Install pacakges by Git&quot;</span>
<span class="w">  </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nv">dir</span><span class="w"> </span><span class="p">(</span><span class="nf">expand-file-name</span><span class="w"> </span><span class="p">(</span><span class="nf">format</span><span class="w"> </span><span class="s">&quot;%s&quot;</span><span class="w"> </span><span class="nv">pkg</span><span class="p">)</span><span class="w"> </span><span class="nv">user-module-directory</span><span class="p">)))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">message</span><span class="w"> </span><span class="s">&quot;Fetching %s...&quot;</span><span class="w"> </span><span class="nv">pkg</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">message</span><span class="w"> </span><span class="s">&quot;%s&quot;</span>
<span class="w">             </span><span class="p">(</span><span class="nv">shell-command-to-string</span>
<span class="w">              </span><span class="p">(</span><span class="nf">format</span><span class="w"> </span><span class="s">&quot;git --no-pager clone \&quot;%s\&quot; \&quot;%s\&quot;&quot;</span>
<span class="w">                      </span><span class="nv">url</span>
<span class="w">                      </span><span class="nv">dir</span><span class="p">)))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">message</span><span class="w"> </span><span class="s">&quot;Fetched %s.&quot;</span><span class="w"> </span><span class="nv">pkg</span><span class="p">)))</span>
<span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/package-update</span><span class="w"> </span><span class="p">(</span><span class="nv">pkg</span><span class="w"> </span><span class="nv">&amp;amp</span><span class="c1">;optional string)</span>
<span class="w">  </span><span class="s">&quot;Update single package.</span>
<span class="nv">If</span><span class="w"> </span><span class="nv">STRING</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">non-nil,</span><span class="w"> </span><span class="nb">return</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">update</span><span class="w"> </span><span class="nv">COMMAND</span><span class="w"> </span><span class="nf">string</span>
<span class="nv">especially</span><span class="w"> </span><span class="nv">for</span><span class="w"> </span><span class="o">`</span><span class="nv">dust/package-update-all</span><span class="ss">&#39;.</span><span class="s">&quot;</span>
<span class="w">  </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nv">dust/package-installed-p</span><span class="w"> </span><span class="nv">pkg</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nv">cmd</span><span class="w"> </span><span class="p">(</span><span class="nf">format</span><span class="w"> </span><span class="s">&quot;echo \&quot;Updating: %s...\&quot;\ncd \&quot;%s\&quot;\ngit pull\n&quot;</span>
<span class="w">                         </span><span class="nv">pkg</span>
<span class="w">                         </span><span class="p">(</span><span class="nf">expand-file-name</span><span class="w"> </span><span class="p">(</span><span class="nf">format</span><span class="w"> </span><span class="s">&quot;%s&quot;</span><span class="w"> </span><span class="nv">pkg</span><span class="p">)</span>
<span class="w">                                           </span><span class="nv">user-module-directory</span><span class="p">))))</span>
<span class="w">        </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="nf">string</span>
<span class="w">            </span><span class="nv">cmd</span>
<span class="w">          </span><span class="p">(</span><span class="nv">shell-command-to-string</span><span class="w"> </span><span class="nv">cmd</span><span class="p">)))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">message</span><span class="w"> </span><span class="s">&quot;No such package: %s&quot;</span><span class="w"> </span><span class="nv">pkg</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/package-update-all</span><span class="w"> </span><span class="p">(</span><span class="nv">&amp;amp</span><span class="c1">;optional script)</span>
<span class="w">  </span><span class="s">&quot;Update all packages.</span>
<span class="nv">SCRIPT</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">temporary</span><span class="w"> </span><span class="nv">location</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">shell</span><span class="w"> </span><span class="nv">script.</span><span class="s">&quot;</span>
<span class="w">  </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nv">tmp-script</span><span class="w"> </span><span class="p">(</span><span class="k">or</span><span class="w"> </span><span class="nv">script</span><span class="w"> </span><span class="s">&quot;/tmp/emasc.update.modules&quot;</span><span class="p">)))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">with-temp-file</span><span class="w"> </span><span class="nv">tmp-script</span>
<span class="w">      </span><span class="p">(</span><span class="nf">insert</span><span class="w"> </span><span class="s">&quot;#! /bin/bash\n&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="nb">dolist</span><span class="w"> </span><span class="p">(</span><span class="nv">pkg</span><span class="w"> </span><span class="p">(</span><span class="nf">directory-files</span><span class="w"> </span><span class="nv">user-module-directory</span><span class="w"> </span><span class="no">nil</span><span class="w"> </span><span class="s">&quot;[^.]&quot;</span><span class="p">))</span>
<span class="w">        </span><span class="p">(</span><span class="nf">insert</span><span class="w"> </span><span class="p">(</span><span class="nv">dust/package-update</span><span class="w"> </span><span class="nv">pkg</span><span class="w"> </span><span class="no">t</span><span class="p">)))</span>
<span class="w">      </span><span class="p">(</span><span class="nf">insert</span><span class="w"> </span><span class="s">&quot;echo \&quot;DONE.\&quot;&quot;</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nv">async-shell-command</span><span class="w"> </span><span class="p">(</span><span class="nf">format</span><span class="w"> </span><span class="s">&quot;bash %s&quot;</span><span class="w"> </span><span class="nv">tmp-script</span><span class="p">))))</span>
<span class="c1">;; Put directory of all Modules in to environment.</span>
<span class="c1">;; `:package&#39; do this only when the package is installed.</span>
<span class="p">(</span><span class="nb">dolist</span><span class="w"> </span><span class="p">(</span><span class="nv">path</span><span class="w"> </span><span class="p">(</span><span class="nf">directory-files</span><span class="w"> </span><span class="nv">user-module-directory</span>
<span class="w">                               </span><span class="no">t</span><span class="w"> </span><span class="s">&quot;[^.]&quot;</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nv">add-to-list</span><span class="w"> </span><span class="ss">&#39;load-path</span><span class="w"> </span><span class="nv">path</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org1460d09" class="outline-2">
<h2 id="org1460d09">SetupEl</h2>
<div class="outline-text-2" id="text-org1460d09">
</div>
<div id="outline-container-org49ea254" class="outline-3">
<h3 id="org49ea254">简介</h3>
<div class="outline-text-3" id="text-org49ea254">
<p>
<a href="https://git.sr.ht/~pkal/setup" target="_blank">setup.el</a> 是一套宏，可以用于做包和模块的管理。与各种包管理器类似，在 <code>(setup feature ...)</code> 中通过各种关键字来实现各种各样的功能。它提供了一套基础的关键字，很基础。但是自定义关键字非常简单。
</p>

<p>
setup.el 内置关键字有：
</p>
<ul class="org-ul">
<li>上下文 <code>:with-feature</code>, <code>:with-mode</code>, <code>:with-map</code>, <code>:with-hook</code>, <code>:with-function</code></li>
<li>绑定 <code>:global</code> <code>:bind</code>, <code>:unbind</code>, <code>:rebind</code>, <code>:bind-into</code></li>
<li>包调用 <code>:package</code>, <code>:requrie</code>, <code>:as-load</code></li>
<li>赋值 <code>:option</code>, <code>:local-set</code></li>
<li>钩子 <code>:hook</code>, <code>:hook-into</code>, <code>local-hook</code></li>
<li>条件 <code>:only-if</code>, <code>:file-match</code>, <code>:when-loaded</code>, <code>:and</code>, <code>:if-package</code>, <code>:if-feature</code></li>
</ul>
<p>
看一个简单的例子：
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">rainbow-delimiters</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:package</span><span class="w"> </span><span class="nv">rainbow-delimiters</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:require</span><span class="w"> </span><span class="nv">rainbow-delimiters-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">prog-mode</span><span class="p">)</span>
<span class="w">  </span><span class="c1">;; more body</span>
<span class="w">  </span><span class="p">)</span>
 </pre>
</div>

<p>
定义了一个 <code>rainbow-delimiters</code> 的子系统； <code>:package</code> 是说如果给定的包不存在，则会通过 <code>packge-install</code> 去安装它； <code>:require</code> 就是 require 这个包； <code>:hook-into</code> 就是把 <code>rainbow-delimiters-mode</code> 添加到 <code>prog-mode-hook</code> 中。之后还可以写上各种各样的函数。
</p>

<p>
<a href="https://www.emacswiki.org/emacs/SetupEl" target="_blank">Emacs Wiki</a> 上给出了许多详细完好的例子。
</p>
</div>
</div>

<div id="outline-container-orgcd1ed53" class="outline-3">
<h3 id="orgcd1ed53">安装</h3>
<div class="outline-text-3" id="text-orgcd1ed53">
<p>
用我自己的函数去 bootstrap, 添加路径到环境变量，再调用即可。它没有任何的外部依赖，其源码就一个文件，无任何 <code>require</code>.
</p>

<div class="org-src-container">
<pre> <span class="c1">;;; SetupEl</span>
<span class="p">(</span><span class="nb">unless</span><span class="w"> </span><span class="p">(</span><span class="nv">dust/package-installed-p</span><span class="w"> </span><span class="ss">&#39;setup</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nv">dust/package-install</span><span class="w"> </span><span class="ss">&#39;setup</span><span class="w"> </span><span class="s">&quot;https://git.sr.ht/~pkal/setup&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nv">add-to-list</span><span class="w"> </span><span class="ss">&#39;load-path</span><span class="w"> </span><span class="p">(</span><span class="nf">expand-file-name</span><span class="w"> </span><span class="s">&quot;setup&quot;</span><span class="w"> </span><span class="nv">user-module-directory</span><span class="p">))</span>
<span class="p">(</span><span class="nb">require</span><span class="w"> </span><span class="ss">&#39;setup</span><span class="p">)</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org8820cac" class="outline-3">
<h3 id="org8820cac">子系统与上下文</h3>
<div class="outline-text-3" id="text-org8820cac">
<p>
<code>(setup feature)</code> 表明配置一个名为 <code>feature</code> 的子系统。这个名字可以任意，可以是已存在的包名。如果是后者，后续可以方便的传入一些参数。
</p>

<p>
setup 子系统的过程中，会保持几个变量： <code>feature</code>, <code>mode</code>, <code>map</code>, <code>hook</code>, <code>function</code>, 这几个变量都应与子系统相关联，使得子系统配置过程中变量的调用更加可靠。
</p>

<p>
<code>feature</code> 就是一个子系统，在逻辑上是一堆变量和函数的集合，不太合适也可以把它理解为 package 。feature 会延伸出其他变量的定义。
</p>

<p>
比如给定 feature 为 <code>rainbow-delimiters</code>, 在不做改动的情况下：
</p>
<ul class="org-ul">
<li>mode 是 feature 的延拓，为 <code>rainbow-delimiters-mode</code></li>
<li>function 同 mode</li>
<li>hook 是 mode 的延拓，为 <code>rainbow-delimiters-mode-hook</code></li>
<li>map 是 mode 的延拓，为 <code>rainbow-delimiters-mode-map</code></li>
</ul>

<p>
这些延拓都是为了后续使用的方便。如前面例子，要加一个 hook, 本来的写法应该是
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">add-hook</span><span class="w"> </span><span class="ss">&#39;prog-mode-hook</span><span class="w"> </span><span class="nf">#&#39;</span><span class="nv">rainbow-delimiters-mode</span><span class="p">)</span>
 </pre>
</div>

<p>
在 setup 下是
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">prog-mode</span><span class="p">)</span>
 </pre>
</div>

<p>
<code>prog-mode</code> 会延拓成 <code>prog-mode-hook</code>; <code>:hook-into</code> 会把当前系统的 function 也就是 <code>rainbow-delimiters-mode</code> （默认情况下同 mode）加入到钩子中。如此做一番抽象，配置就显得明晰而简练。
</p>

<p>
那几个 with 相关的关键字是为了改变当前系统下的默认延拓。比较典型的例子，minad 大神开发的插件如 vertico, corfu. <code>(setup cofu)</code> 系统下的 map 默认为 <code>corfu-mode-map</code>, 因为 feature 延拓为 mode, 再延拓为 map. 但是人家实际上的 map 是 <code>corfu-map</code>, 这时就需要用 with 来改变上下文：
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">corfu</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:with-map</span><span class="w"> </span><span class="nv">corfu-map</span>
<span class="w">    </span><span class="c1">;; 系统d  map 切换到 `corfu-map&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
 </pre>
</div>

<p>
注意， <code>:with-feature</code> 和 <code>:with-mode</code> 依然会改变 function, map 和 hook, 因为它们是前二者的延拓. 只有 with 后三者不会影响其他的变量。
</p>

<p>
至此，你应该大致理解了子系统内部的几个变量的关系，以及窥探了后续绑定和使用过程的抽象所带来的便利。接下来便是对各个关键词进行介绍。
</p>
</div>
</div>

<div id="outline-container-orgb843cd2" class="outline-3">
<h3 id="orgb843cd2">绑定</h3>
<div class="outline-text-3" id="text-orgb843cd2">
<p>
<code>:global</code> 用于全局绑定，无关 feature. 如 <code>(:global "RET" newline-and-indent)</code>
</p>

<p>
<code>:bind</code> 绑定到当前系统的 map. 如 <code>(:with-feature org (:bind "C-c s" org-schedule))</code>  就会在 <code>org-mode-map</code> 下绑定按键。它是 <code>after-loaded</code> 的（详见<a href="#orgf48c7fd">自定义关键字</a>），也就是它会等当前系统加载之后才绑定（防止对应的变量还没有定义），所以展开之后其实是：
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nb">with-eval-after-load</span><span class="w"> </span><span class="ss">&#39;org</span>
<span class="w">  </span><span class="p">(</span><span class="nf">define-key</span><span class="w"> </span><span class="ss">&#39;org-mode-map</span><span class="w"> </span><span class="s">&quot;C-c s&quot;</span><span class="w"> </span><span class="nf">#&#39;</span><span class="nv">org-schedule</span><span class="p">))</span>
 </pre>
</div>

<p>
此外，它还是 <code>repeatable</code> 的，也就是可以连续绑定，如：
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nb">:bind</span><span class="w"> </span><span class="s">&quot;C-c s&quot;</span><span class="w"> </span><span class="nv">org-schedule</span>
<span class="w">       </span><span class="s">&quot;C-s d&quot;</span><span class="w"> </span><span class="nv">org-deadlin</span><span class="p">)</span>
 </pre>
</div>

<p>
,所有五个绑定关键字都是 <code>repeatable</code>, 也就是可以连续输入。
</p>

<p>
<code>:unbind</code> 清空按键绑定， <code>:rebind</code> 重新绑定按键。
</p>

<p>
<code>:bind-into</code> 绑定特定的 map. 比如说前面的 corfu 的例子，可以不用 <code>:with-map</code> 切换上下文，直接 <code>(:bind-into corfu-map ...)</code> 即可。
</p>

<p>
除了 <code>:global</code> 的绑定都是 <code>after-loaded</code> 的，只要 feature 设置正确了，就不会出现 map 还没定义的情况。
</p>
</div>
</div>

<div id="outline-container-org67b4e43" class="outline-3">
<h3 id="org67b4e43">包调用</h3>
<div class="outline-text-3" id="text-org67b4e43">
<p>
前面提到过 <code>:package</code> 是用来安装包的，它指定了 shorthand （详见<a href="#orgf48c7fd">自定义关键字</a>），所以可以用来做 feature. 如下面这个系统的 feature 是 <code>simple</code>.
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:package</span><span class="w"> </span><span class="nv">simple</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
 </pre>
</div>

<p>
<code>:package</code> 是 repeatable 所以可以一次安装多个包。但是只有第一个包会作为系统的 feature. 因为我并不是用的自带 <code>package.el</code> 的安装插件，所以后续我会写一个自定义的安装插件的关键字。
</p>

<p>
<code>:require</code> 调用包，repeatable, 且有 shorthand, 所以同样可以作为系统的 feature.
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:require</span><span class="w"> </span><span class="nv">cl-lib</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
 </pre>
</div>

<p>
<code>:also-load</code> 用来 require 后续包。它是 after-loaded, 因此只要在 feature 加载之后才会调用，强调调用顺序。
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">cofu</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:also-load</span><span class="w"> </span><span class="nv">corfu-popinfo</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:audoload</span><span class="w"> </span><span class="nv">corfu-mode</span><span class="p">))</span>
 </pre>
</div>
<p>
只要在使用了 <code>corfu-mode</code> 这个 autoload 后，corfu 这个 feature 加载，然后才会 requrie <code>corfu-popinfo</code>.
</p>
</div>
</div>

<div id="outline-container-org977683f" class="outline-3">
<h3 id="org977683f">赋值</h3>
<div class="outline-text-3" id="text-org977683f">
<p>
<code>:option</code> 是一个集大成的赋值方法，它是 repeatable, 因此使用方法和 <code>setq</code> 类似。如
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">savehist-autosave-interval</span><span class="w"> </span><span class="nv">300</span>
<span class="w">         </span><span class="nv">history-length</span><span class="w"> </span><span class="nv">1000</span>
<span class="w">         </span><span class="nv">kill-ring-max</span><span class="w"> </span><span class="nv">300</span>
<span class="w">         </span><span class="nv">history-delete-duplicates</span><span class="w"> </span><span class="no">t</span><span class="p">)</span>
 </pre>
</div>

<p>
说它集大成的之一是它集成了 <code>set-default</code> 和 <code>custom</code>, 也就是它可以用来设置 custom 的变量，且无视赋值位置，这一来便无需知晓某个变量的赋值应该是在 require 之前还是之后。
</p>

<p>
其二是因为它还能对列表进行赋值。以环境变量为例，设置都是 <code>(add-to-list 'load-path "path")</code>. 通过 <code>:option</code> 设置为 <code>(:option (prepend load-path) "path")</code>.
</p>

<p>
<code>prepend</code> 意思是把输入插入到列表前端，如果以存在则跳过。对应的是 <code>append</code>, 把输入放置到列表末尾。还有一个 <code>remove</code>, 就是把输入从列表中移除。
</p>

<p>
输入可以是一个列表，然后声名方式改变：
</p>
<ul class="org-ul">
<li><code>prepend*</code> 把输入列表中的每个元素按顺序插入到列表变量（也就是上面例子中的 <code>load-path</code> ）的开头，如果以存在则跳过</li>
<li><code>append*</code> 把输入列表中的每个元素按顺序接入到列表变量的末尾，如果以存在则跳过</li>
<li><code>remove*</code> 移除列表变量中所有在输入列表中的元素</li>
</ul>

<p>
还有一个局部赋值的关键字 <code>:local-set</code>, 使用方法与 <code>:option</code> 相同，只是它用的是 <code>setq-local</code> 来在当前 buffer 中进行局部赋值。
</p>
</div>
</div>

<div id="outline-container-orgb9ff5e2" class="outline-3">
<h3 id="orgb9ff5e2">钩子</h3>
<div class="outline-text-3" id="text-orgb9ff5e2">
<p>
<code>:hook</code>, repeatable, 输入的是函数，把这些函数都钩到当前系统的 hook 中。如：
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">prog-mode</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:hook</span><span class="w"> </span><span class="nv">hl-mode</span><span class="p">))</span>
 </pre>
</div>

<p>
用的更多的是 <code>:hook-into</code>, 同样 repeatable, 输入的是钩子，把当前系统的函数添加到这些钩子中。如把 <code>elisp-def-mode</code> 添加到钩子 <code>emacs-lisp-mode-hook</code> 和 <code>ielm-mode-hook</code> 中：
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">elisp-def</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:require</span><span class="w"> </span><span class="nv">elisp-def</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">emacs-lisp-mode</span><span class="w"> </span><span class="nv">ielm-mode</span><span class="p">))</span>
 </pre>
</div>

<p>
<code>local-hook</code> 同 <code>:hook</code>, 只是局部添加钩子。
</p>

<p>
以上的钩子操作都不是 after-loaded, 也就是需要钩子触发前 require 或 autoload 对应的函数。
</p>
</div>
</div>

<div id="outline-container-org295c2e8" class="outline-3">
<h3 id="org295c2e8">条件</h3>
<div class="outline-text-3" id="text-org295c2e8">
<p>
<code>:only-if</code> 判断条件，条件为假时整个 setup 退出。
</p>

<p>
<code>:file-match</code> 这个就是常用的 mode 匹配文件名的配置。比如要把 yaml-mode 匹配到 <code>.yml</code> 或 <code>.yaml</code> 为后缀的文件，则配置：
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:require</span><span class="w"> </span><span class="nv">yaml-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:file-match</span><span class="w"> </span><span class="s">&quot;\\.\\(yml\\|yaml\\)\\&#39;&quot;</span><span class="p">))</span>
 </pre>
</div>

<p>
<code>:when-loaded</code> 当系统 feature 加载之后执行的操作， <code>(:when-loaded ...)</code> 等价于 <code>(with-eval-after-load 'feature ...)</code>. 当时文档中不建议使用这个关键字，因为它潜在的使用的系统 feature, 应该明确指定等待哪个 feature 加载。后续使用改良后的 <code>:after</code> 。
</p>

<p>
<code>:if-package</code> 如果包未安装则退出， <code>:if-feature</code> 如果不是 feature (feature 未加载则退出)。简单理解，前者是看包有没有安装到本地，后者是看包有没有加载到 Emacs. 
</p>

<p>
<code>:and</code> 多个判断条件，使用同 <code>cond</code>, 当有一个为假时，setup 退出。最后一个判断 <b>*条件</b>用来修改 feature. 我自己没用过这个关键字，具体行为不太清楚。
</p>
</div>
</div>

<div id="outline-container-orgf48c7fd" class="outline-3">
<h3 id="orgf48c7fd">自定义关键字</h3>
<div class="outline-text-3" id="text-orgf48c7fd">
<p>
<a href="https://www.emacswiki.org/emacs/SetupEl" target="_blank">Emacs Wiki</a> 上给出了许多有用的自定义关键字，我使用了其中一些。自定义关键字的框架是：
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup-define</span><span class="w"> </span><span class="nb">:keywords</span>
<span class="w">  </span><span class="nv">macro</span>
<span class="w">  </span><span class="nv">args...</span><span class="p">)</span>
 </pre>
</div>

<p>
其中，macro 返回一段宏，args 指定关键字的属性。
</p>

<p>
setup 的执行过程就是把 body 当作宏来执行，因此关键字函数返回的便是一段宏，或者可执行的代码。
</p>
</div>

<div id="outline-container-org5aab0b6" class="outline-4">
<h4 id="org5aab0b6">:doc</h4>
<div class="outline-text-4" id="text-org5aab0b6">
<p>
先定义一个简单的 <code>:doc</code>, 用来记录当前系统的文档信息 <sup>[<a id="fnr:1.2" class="footref" href="#fn:1">1</a>]</sup>。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup-define</span><span class="w"> </span><span class="nb">:doc</span>
<span class="w">  </span><span class="p">(</span><span class="nb">lambda</span><span class="w"> </span><span class="p">(</span><span class="nv">_</span><span class="p">)</span>
<span class="w">    </span><span class="no">nil</span><span class="p">)</span>
<span class="w">  </span><span class="nb">:documentation</span><span class="w"> </span><span class="s">&quot;Document for the setup package.&quot;</span>
<span class="w">  </span><span class="nb">:repeatable</span><span class="w"> </span><span class="no">t</span><span class="p">)</span>
 </pre>
</div>

<p>
macro 返回的是 nil, 也就是这个关键词并不会真正参与到 setup 中，它的作用只是在代码中作为 document 的存在，让人看见。这里有两个参数： <code>:documentation</code> 当前关键字的文档， <code>:repeatable</code> 前面提到过的，是否可重复，如以下：
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">dash</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;A modern list API for Emacs.&quot;</span>
<span class="w">        </span><span class="s">&quot;https://github.com/magnars/dash.el&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:require</span><span class="w"> </span><span class="nv">dash</span><span class="p">))</span>
 </pre>
</div>

<p>
看起来输入的是两个参数，但因为是 repeatable, 实际上是两个参数返回了两个宏，并不是两个参数同时传到一个宏。
</p>
</div>
</div>

<div id="outline-container-org2846f88" class="outline-4">
<h4 id="org2846f88">:git</h4>
<div class="outline-text-4" id="text-org2846f88">
<p>
写一个 <code>:git</code> 作为 <code>:package</code> 的替代：
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup-define</span><span class="w"> </span><span class="nb">:git</span>
<span class="w">  </span><span class="p">(</span><span class="nb">lambda</span><span class="w"> </span><span class="p">(</span><span class="nv">package</span><span class="w"> </span><span class="nv">url</span><span class="p">)</span>
<span class="w">    </span><span class="o">`</span><span class="p">(</span><span class="nb">unless</span><span class="w"> </span><span class="p">(</span><span class="nv">dust/package-installed-p</span><span class="w"> </span><span class="ss">&#39;,package</span><span class="p">)</span>
<span class="w">       </span><span class="p">(</span><span class="nv">dust/package-install</span><span class="w"> </span><span class="ss">&#39;,package</span><span class="w"> </span><span class="o">,</span><span class="nv">url</span><span class="p">)</span>
<span class="w">       </span><span class="p">(</span><span class="nv">add-to-list</span><span class="w"> </span><span class="ss">&#39;load-path</span><span class="w"> </span><span class="p">(</span><span class="nf">expand-file-name</span><span class="w"> </span><span class="p">(</span><span class="nf">format</span><span class="w"> </span><span class="s">&quot;%s&quot;</span><span class="w"> </span><span class="ss">&#39;,package</span><span class="p">)</span>
<span class="w">                                                 </span><span class="nv">user-module-directory</span><span class="p">))))</span>
<span class="w">  </span><span class="nb">:documentation</span><span class="w"> </span><span class="s">&quot;Install package by Git if it hasn&#39;t been installed yet.</span>
<span class="nv">CON</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">list,</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">package-name</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="nv">first</span><span class="w"> </span><span class="nv">element,</span>
<span class="k">and</span><span class="w"> </span><span class="nv">Git</span><span class="w"> </span><span class="nv">repository</span><span class="w"> </span><span class="nv">URL</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="nv">second</span><span class="w"> </span><span class="nv">element.</span>
<span class="nv">The</span><span class="w"> </span><span class="nv">first</span><span class="w"> </span><span class="nv">PACKAGE</span><span class="w"> </span><span class="nv">can</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">used</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">deduce</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">feature</span><span class="w"> </span><span class="nv">context.</span><span class="s">&quot;</span>
<span class="w">  </span><span class="nb">:repeatable</span><span class="w"> </span><span class="nv">t</span>
<span class="w">  </span><span class="nb">:shorthand</span><span class="w"> </span><span class="nf">#&#39;</span><span class="nv">cadr</span><span class="p">)</span>
 </pre>
</div>

<p>
使用如下：
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">no-littering</span><span class="w"> </span><span class="s">&quot;https://github.com/emacscollective/no-littering&quot;</span>
<span class="w">             </span><span class="nv">compat</span><span class="w"> </span><span class="s">&quot;https://github.com/emacsmirror/compat&quot;</span><span class="p">))</span>
 </pre>
</div>

<p>
<code>:git</code> 的定义输入的是两个参数，同时又是 repeatable, 因此输入参数一定是偶数，两两一组传入，返回一半数量的宏。
</p>

<p>
这里定义了 <code>:shorthand</code>, 它是一个函数，传入整个关键字函数，如上面的例子就是传入整个 <code>(:git no-littering "https://github.com/emacscollective/no-littering" compat "https://github.com/emacsmirror/compat")</code> 作为一个列表。定义使用的是 <code>#'cadr</code>, 对应就是 <code>no-littering</code>, 所以 <code>no-littering</code> 就可以作为系统的 feature. 如此便可以自定义一个函数，来返回任意所需的值作为 feature.
</p>
</div>
</div>

<div id="outline-container-org5c00d42" class="outline-4">
<h4 id="org5c00d42">:load-path</h4>
<div class="outline-text-4" id="text-org5c00d42">
<p>
定义环境变量关键字，它可以传入一个 sexp, 把它的返回值加入环境变量，也可以是绝对路径，还可以是相对路径，相对于当前 feature 所在的路径（就是 <code>guess-path</code> ），最后返回一个 <code>add-to-list</code> 的宏。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup-define</span><span class="w"> </span><span class="nb">:load-path</span>
<span class="w">  </span><span class="p">(</span><span class="nb">lambda</span><span class="w"> </span><span class="p">(</span><span class="nv">path</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">when</span><span class="w"> </span><span class="p">(</span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="nf">stringp</span><span class="w"> </span><span class="nv">path</span><span class="p">)</span>
<span class="w">               </span><span class="p">(</span><span class="nv">not</span><span class="w"> </span><span class="p">(</span><span class="nf">file-name-absolute-p</span><span class="w"> </span><span class="nv">path</span><span class="p">)))</span>
<span class="w">      </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nv">guess-path</span><span class="w"> </span><span class="p">(</span><span class="nf">expand-file-name</span>
<span class="w">                         </span><span class="nv">path</span>
<span class="w">                         </span><span class="p">(</span><span class="nf">expand-file-name</span><span class="w"> </span><span class="p">(</span><span class="nf">format</span><span class="w"> </span><span class="s">&quot;%s&quot;</span><span class="w"> </span><span class="p">(</span><span class="nv">setup-get</span><span class="w"> </span><span class="ss">&#39;feature</span><span class="p">))</span>
<span class="w">                                           </span><span class="nv">user-module-directory</span><span class="p">))))</span>
<span class="w">        </span><span class="p">(</span><span class="nb">when</span><span class="w"> </span><span class="p">(</span><span class="nf">file-exists-p</span><span class="w"> </span><span class="nv">guess-path</span><span class="p">)</span>
<span class="w">          </span><span class="p">(</span><span class="k">setq</span><span class="w"> </span><span class="nv">path</span><span class="w"> </span><span class="nv">guess-path</span><span class="p">))))</span>
<span class="w">    </span><span class="o">`</span><span class="p">(</span><span class="nv">add-to-list</span><span class="w"> </span><span class="ss">&#39;load-path</span><span class="w"> </span><span class="o">,</span><span class="nv">path</span><span class="p">))</span>
<span class="w">  </span><span class="nb">:documentation</span><span class="w"> </span><span class="s">&quot;Update load-path.&quot;</span>
<span class="w">  </span><span class="nb">:repeatable</span><span class="w"> </span><span class="no">t</span><span class="p">)</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org23131ab" class="outline-4">
<h4 id="org23131ab">:autoload</h4>
<div class="outline-text-4" id="text-org23131ab">
<p>
<code>:autoload</code> 是基于当前系统的 feature 去查找，必要时用 <code>:with-feature</code> 切换上下文 <sup>[<a id="fnr:4.1" class="footref" href="#fn:4">4</a>]</sup>。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup-define</span><span class="w"> </span><span class="nb">:autoload</span>
<span class="w">  </span><span class="p">(</span><span class="nb">lambda</span><span class="w"> </span><span class="p">(</span><span class="nv">func</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nv">fn</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nf">memq</span><span class="w"> </span><span class="p">(</span><span class="nf">car-safe</span><span class="w"> </span><span class="nv">func</span><span class="p">)</span>
<span class="w">                        </span><span class="o">&#39;</span><span class="p">(</span><span class="k">quote</span><span class="w"> </span><span class="k">function</span><span class="p">))</span>
<span class="w">                  </span><span class="p">(</span><span class="nv">cadr</span><span class="w"> </span><span class="nv">func</span><span class="p">)</span>
<span class="w">                </span><span class="nv">func</span><span class="p">)))</span>
<span class="w">      </span><span class="o">`</span><span class="p">(</span><span class="nb">unless</span><span class="w"> </span><span class="p">(</span><span class="nf">fboundp</span><span class="w"> </span><span class="p">(</span><span class="k">quote</span><span class="w"> </span><span class="o">,</span><span class="nv">fn</span><span class="p">))</span>
<span class="w">         </span><span class="p">(</span><span class="nf">autoload</span><span class="w"> </span><span class="p">(</span><span class="k">function</span><span class="w"> </span><span class="o">,</span><span class="nv">fn</span><span class="p">)</span><span class="w"> </span><span class="o">,</span><span class="p">(</span><span class="nf">symbol-name</span><span class="w"> </span><span class="p">(</span><span class="nv">setup-get</span><span class="w"> </span><span class="ss">&#39;feature</span><span class="p">))</span><span class="w"> </span><span class="no">nil</span><span class="w"> </span><span class="no">t</span><span class="p">))))</span>
<span class="w">  </span><span class="nb">:documentation</span><span class="w"> </span><span class="s">&quot;Autoload COMMAND if it is not already bound.&quot;</span>
<span class="w">  </span><span class="nb">:repeatable</span><span class="w"> </span><span class="nv">t</span>
<span class="w">  </span><span class="nb">:signature</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="nv">FUNC</span><span class="w"> </span><span class="o">...</span><span class="p">))</span>
 </pre>
</div>
<p>
这里有一个新的参数 <code>:signature</code> ，它是嵌入文档中的信息，用于解释输入的参数。上面给的意思就是在文档中说明输入可以是一串函数。
</p>
</div>
</div>

<div id="outline-container-org22b3cd5" class="outline-4">
<h4 id="org22b3cd5">:after</h4>
<div class="outline-text-4" id="text-org22b3cd5">
<p>
改良版的 <code>:when-loaded</code>, 它明确指定一个 feature 来使用 <code>with-eval-after-load</code>.
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup-define</span><span class="w"> </span><span class="nb">:after</span>
<span class="w">  </span><span class="p">(</span><span class="nb">lambda</span><span class="w"> </span><span class="p">(</span><span class="nv">features</span><span class="w"> </span><span class="nv">&amp;amp</span><span class="c1">;rest body)</span>
<span class="w">    </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="nv">bodies</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="nb">dolist</span><span class="w"> </span><span class="p">(</span><span class="nv">feature</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nf">listp</span><span class="w"> </span><span class="nv">features</span><span class="p">)</span><span class="w"> </span><span class="nv">features</span><span class="w"> </span><span class="p">(</span><span class="nf">list</span><span class="w"> </span><span class="nv">features</span><span class="p">)))</span>
<span class="w">        </span><span class="p">(</span><span class="nb">push</span><span class="w"> </span><span class="o">`</span><span class="p">(</span><span class="nb">with-eval-after-load</span><span class="w"> </span><span class="ss">&#39;,feature</span>
<span class="w">                 </span><span class="p">(</span><span class="nb">:with-feature</span><span class="w"> </span><span class="o">,</span><span class="nv">feature</span>
<span class="w">                   </span><span class="o">,@</span><span class="nv">body</span><span class="p">))</span>
<span class="w">              </span><span class="nv">bodies</span><span class="p">))</span>
<span class="w">      </span><span class="p">(</span><span class="nv">macroexp-progn</span><span class="w"> </span><span class="p">(</span><span class="nf">nreverse</span><span class="w"> </span><span class="nv">bodies</span><span class="p">))))</span>
<span class="w">  </span><span class="nb">:documentation</span><span class="w"> </span><span class="s">&quot;Eval BODY after FEATURES.</span>
<span class="nv">If</span><span class="w"> </span><span class="nv">FEATURES</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">list,</span><span class="w"> </span><span class="nf">apply</span><span class="w"> </span><span class="nv">BODY</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">elements</span><span class="w"> </span><span class="nv">inside.</span><span class="s">&quot;</span>
<span class="w">  </span><span class="nb">:indent</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
 </pre>
</div>

<p>
这里有一个新的参数 <code>:indent</code> ，它用来控制 emacs 显示这段关键词相关代码时的缩进。类型是整数，表示第几个参数换行时缩进。以内置的 <code>:bind-into</code> 为例。如果不设置（即为 0），那么它就会是这样的缩进：
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nb">:bind-into</span><span class="w"> </span><span class="nv">map</span>
<span class="w">            </span><span class="s">&quot;C-c&quot;</span><span class="w"> </span><span class="nv">cmd</span><span class="p">)</span>
 </pre>
</div>

<p>
丑的过于离谱。设置 <code>:indent 1</code> 之后就会是：
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nb">:bind-into</span><span class="w"> </span><span class="nv">map</span>
<span class="w">  </span><span class="s">&quot;C-c&quot;</span><span class="w"> </span><span class="nv">cmd</span><span class="p">)</span>
 </pre>
</div>

<p>
这样看上去就舒服多了。这样应当可以理解它的作用了。
</p>
</div>
</div>

<div id="outline-container-org064e951" class="outline-4">
<h4 id="org064e951">:modalka</h4>
<div class="outline-text-4" id="text-org064e951">
<p>
用来绑定 modalka-mode 下的按键。关于 modalka, 详见<a href="#org989ac68">全局按键绑定</a>.
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup-define</span><span class="w"> </span><span class="nb">:modalka</span>
<span class="w">  </span><span class="p">(</span><span class="nb">lambda</span><span class="w"> </span><span class="p">(</span><span class="nv">key</span><span class="w"> </span><span class="nv">command</span><span class="p">)</span>
<span class="w">    </span><span class="o">`</span><span class="p">(</span><span class="nf">define-key</span><span class="w"> </span><span class="nv">modalka-mode-map</span><span class="w"> </span><span class="o">,</span><span class="nv">key</span><span class="w"> </span><span class="o">,</span><span class="nv">command</span><span class="p">))</span>
<span class="w">  </span><span class="nb">:documentation</span><span class="w"> </span><span class="s">&quot;Bind KEY to COMMAND on Modalka Map.&quot;</span>
<span class="w">  </span><span class="nb">:repeatable</span><span class="w"> </span><span class="nv">t</span>
<span class="w">  </span><span class="nb">:ensure</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="nv">kbd</span><span class="w"> </span><span class="nv">func</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org8e476a8" class="outline-4">
<h4 id="org8e476a8">:diminish</h4>
<div class="outline-text-4" id="text-org8e476a8">
<p>
名字取自 <a href="https://github.com/myrjola/diminish.el" target="_blank">diminish.el</a> 包，用来移除当前 minor-mode 在 mode-line 上的显示 <sup>[<a id="fnr:4.2" class="footref" href="#fn:4">4</a>]</sup>。
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup-define</span><span class="w"> </span><span class="nb">:diminish</span>
<span class="w">  </span><span class="p">(</span><span class="nb">lambda</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nv">mode</span><span class="w"> </span><span class="p">(</span><span class="nv">setup-get</span><span class="w"> </span><span class="ss">&#39;mode</span><span class="p">)))</span>
<span class="w">      </span><span class="o">`</span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">minor-mode-alist</span>
<span class="w">                </span><span class="p">(</span><span class="nf">delq</span><span class="w"> </span><span class="p">(</span><span class="nf">assq</span><span class="w"> </span><span class="ss">&#39;,mode</span><span class="w"> </span><span class="nv">minor-mode-alist</span><span class="p">)</span>
<span class="w">                      </span><span class="nv">minor-mode-alist</span><span class="p">))))</span>
<span class="w">  </span><span class="nb">:documentation</span><span class="w"> </span><span class="s">&quot;Hide the mode-line lighter of the current mode.&quot;</span>
<span class="w">  </span><span class="nb">:after-loaded</span><span class="w"> </span><span class="no">t</span><span class="p">)</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org2ae30e4" class="outline-4">
<h4 id="org2ae30e4">:advice</h4>
<div class="outline-text-4" id="text-org2ae30e4">
<p>
添加 advice, 采用的是类似 <code>define-advice</code> 的形式 <sup>[<a id="fnr:4.3" class="footref" href="#fn:4">4</a>]</sup>。
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup-define</span><span class="w"> </span><span class="nb">:advice</span>
<span class="w">  </span><span class="p">(</span><span class="nb">lambda</span><span class="w"> </span><span class="p">(</span><span class="nv">symbol</span><span class="w"> </span><span class="nv">where</span><span class="w"> </span><span class="nv">arglist</span><span class="w"> </span><span class="nv">&amp;amp</span><span class="c1">;rest body)</span>
<span class="w">    </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nv">name</span><span class="w"> </span><span class="p">(</span><span class="nv">gensym</span><span class="w"> </span><span class="s">&quot;setup-advice-&quot;</span><span class="p">)))</span>
<span class="w">      </span><span class="o">`</span><span class="p">(</span><span class="k">progn</span>
<span class="w">         </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="o">,</span><span class="nv">name</span><span class="w"> </span><span class="o">,</span><span class="nv">arglist</span><span class="w"> </span><span class="o">,@</span><span class="nv">body</span><span class="p">)</span>
<span class="w">         </span><span class="p">(</span><span class="nv">advice-add</span><span class="w"> </span><span class="ss">&#39;,symbol</span><span class="w"> </span><span class="o">,</span><span class="nv">where</span><span class="w"> </span><span class="nf">#&#39;</span><span class="o">,</span><span class="nv">name</span><span class="p">))))</span>
<span class="w">  </span><span class="nb">:documentation</span><span class="w"> </span><span class="s">&quot;Add a piece of advice on a function.</span>
<span class="nv">See</span><span class="w"> </span><span class="o">`</span><span class="nv">advice-add</span><span class="o">&#39;</span><span class="w"> </span><span class="nv">for</span><span class="w"> </span><span class="nv">more</span><span class="w"> </span><span class="nv">details.</span><span class="s">&quot;</span>
<span class="w">  </span><span class="nb">:after-loaded</span><span class="w"> </span><span class="nv">t</span>
<span class="w">  </span><span class="nb">:debug</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="nv">sexp</span><span class="w"> </span><span class="nv">sexp</span><span class="w"> </span><span class="nv">function-form</span><span class="p">)</span>
<span class="w">  </span><span class="nb">:indent</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
 </pre>
</div>

<p>
使用方法：
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nb">:advice</span><span class="w"> </span><span class="nv">old-func</span><span class="w"> </span><span class="nb">:before</span><span class="w"> </span><span class="p">(</span><span class="nv">a</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="nv">c</span><span class="p">)</span>
<span class="w">  </span><span class="nv">body</span><span class="p">)</span>
<span class="c1">;; 等价于</span>
<span class="p">(</span><span class="nb">define-advice</span><span class="w"> </span><span class="nv">old-func</span><span class="w"> </span><span class="p">(</span><span class="nb">:before</span><span class="w"> </span><span class="p">(</span><span class="nv">a</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="nv">c</span><span class="p">))</span>
<span class="w">  </span><span class="nv">body</span><span class="p">)</span>
<span class="c1">;; 等价于</span>
<span class="p">(</span><span class="nv">advice-add</span><span class="w"> </span><span class="nv">old-func</span>
<span class="w">  </span><span class="nb">:before</span>
<span class="w">  </span><span class="p">(</span><span class="nb">lambda</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="nv">body</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-orgd1b6c50" class="outline-4">
<h4 id="orgd1b6c50">:face</h4>
<div class="outline-text-4" id="text-orgd1b6c50">
<p>
这个关键字和 <code>:advice</code> 一样有点无聊，但是还是把它包装起来了。通过调用 <code>set-face-attribute</code> 方法来设置字体样式。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup-define</span><span class="w"> </span><span class="nb">:face</span>
<span class="w">  </span><span class="p">(</span><span class="nb">lambda</span><span class="w"> </span><span class="p">(</span><span class="nv">face</span><span class="w"> </span><span class="nv">prop</span><span class="w"> </span><span class="nv">spec</span><span class="p">)</span>
<span class="w">    </span><span class="o">`</span><span class="p">(</span><span class="nv">set-face-attribute</span><span class="w"> </span><span class="ss">&#39;,face</span><span class="w"> </span><span class="no">nil</span><span class="w"> </span><span class="o">,</span><span class="nv">prop</span><span class="w"> </span><span class="o">,</span><span class="nv">spec</span><span class="p">))</span>
<span class="w">  </span><span class="nb">:documentation</span><span class="w"> </span><span class="s">&quot;Set FACE&#39;s attributes.&quot;</span>
<span class="w">  </span><span class="nb">:repeatable</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="no">t</span><span class="p">)</span>
<span class="w">  </span><span class="nb">:after-loaded</span><span class="w"> </span><span class="nv">t</span>
<span class="w">  </span><span class="nb">:indent</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
 </pre>
</div>

<p>
这里 repeatable 出现了一种新的赋值方式，一个关联列表。前者表示公共参数的数量，后者表示各自的剩余参数的数量，t 表示全部。
</p>

<p>
以这个 <code>:face</code> 为例：
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nb">:face</span><span class="w"> </span><span class="nv">common</span>
<span class="w">  </span><span class="nv">a</span><span class="w"> </span><span class="nv">b</span>
<span class="w">  </span><span class="nv">c</span><span class="w"> </span><span class="nv">d</span><span class="p">)</span>
 </pre>
</div>

<p>
此时会返回两个宏，分别是 <code>(:face common a b)</code>, <code>(:face common c d)</code>. 前一个 repeatable 表示公共参数的数量，如果为 1，那么第一个参数就会都传入不同的宏中，如果为 2 就会作为前两个参数都传入不同的宏中，以此类推。
</p>

<p>
t 表示补满剩下的参数。公共参数为 1，还需传入 2 个参数，所以最终得到 2 个宏。假设公共参数为 2，还需传入 1 个参数，所以最终得到 3 个宏（总共 5 个参数）。
</p>

<p>
希望你能理解。
</p>

<p>
所以 <code>:face</code> 使用方法：
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nb">:face</span><span class="w"> </span><span class="nv">line-number-current-line</span>
<span class="w">  </span><span class="nb">:foreground</span><span class="w"> </span><span class="p">(</span><span class="nv">face-attribute</span><span class="w"> </span><span class="ss">&#39;error</span><span class="w"> </span><span class="nb">:foreground</span><span class="p">)</span>
<span class="w">  </span><span class="nb">:background</span><span class="w"> </span><span class="p">(</span><span class="nv">face-attribute</span><span class="w"> </span><span class="ss">&#39;highlight</span><span class="w"> </span><span class="nb">:background</span><span class="p">)</span>
<span class="w">  </span><span class="nb">:weight</span><span class="w"> </span><span class="ss">&#39;bold</span>
<span class="w">  </span><span class="nb">:slant</span><span class="w"> </span><span class="ss">&#39;normal</span><span class="p">)</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org10c6b81" class="outline-4">
<h4 id="org10c6b81">:lazy</h4>
<div class="outline-text-4" id="text-org10c6b81">
<p>
懒加载，把要执行的 body 封装到一个函数里面，执行这个函数才会释放里面的内容。比如有一些比较大的插件就可以用 lazy 封装，把封装得到的函数绑定到快捷键上，当快捷键触发时才 requrie 。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup-define</span><span class="w"> </span><span class="nb">:lazy</span>
<span class="w">  </span><span class="p">(</span><span class="nb">lambda</span><span class="w"> </span><span class="p">(</span><span class="nv">name</span><span class="w"> </span><span class="nv">commands</span><span class="w"> </span><span class="nv">&amp;amp</span><span class="c1">;rest body)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">unless</span><span class="w"> </span><span class="p">(</span><span class="nf">boundp</span><span class="w"> </span><span class="ss">&#39;setup-lazy--list</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="k">defvar</span><span class="w"> </span><span class="nv">setup-lazy--list</span><span class="w"> </span><span class="no">nil</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="k">setq</span><span class="w"> </span><span class="nv">name</span><span class="w"> </span><span class="p">(</span><span class="nf">intern</span><span class="w"> </span><span class="p">(</span><span class="nf">format</span><span class="w"> </span><span class="s">&quot;setup-lazy-%s&quot;</span><span class="w"> </span><span class="nv">name</span><span class="p">))</span>
<span class="w">          </span><span class="nv">body</span><span class="w"> </span><span class="p">(</span><span class="nv">setup-expand</span><span class="w"> </span><span class="nv">body</span><span class="p">))</span>
<span class="w">    </span><span class="o">`</span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="o">,</span><span class="nv">name</span><span class="w"> </span><span class="p">()</span>
<span class="w">       </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
<span class="w">       </span><span class="p">(</span><span class="nb">unless</span><span class="w"> </span><span class="p">(</span><span class="nf">member</span><span class="w"> </span><span class="ss">&#39;,name</span><span class="w"> </span><span class="nv">setup-lazy--list</span><span class="p">)</span>
<span class="w">         </span><span class="o">,</span><span class="nv">body</span>
<span class="w">         </span><span class="p">(</span><span class="nv">add-to-list</span><span class="w"> </span><span class="ss">&#39;setup-lazy--list</span><span class="w"> </span><span class="ss">&#39;,name</span><span class="p">))</span>
<span class="w">       </span><span class="o">,</span><span class="nv">commands</span><span class="p">))</span>
<span class="w">  </span><span class="nb">:documentation</span><span class="w"> </span><span class="s">&quot;Lazy load. Generate a function, named </span><span class="ss">`setup-lazy-NAME&#39;</span><span class="s">,</span>
<span class="w"> </span><span class="nv">wrapping</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">BODY</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">it.</span><span class="w"> </span><span class="nv">COMMANDS</span><span class="w"> </span><span class="nv">will</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">executed</span><span class="w"> </span><span class="nv">after</span><span class="w"> </span><span class="nv">BODY.</span><span class="w"> </span><span class="nv">From</span><span class="w"> </span><span class="nv">that</span><span class="w"> </span><span class="nv">on,</span>
<span class="o">`</span><span class="nv">setup-lazy-NAME</span><span class="o">&#39;</span><span class="w"> </span><span class="nv">can</span><span class="w"> </span><span class="nv">always</span><span class="w"> </span><span class="nv">replace</span><span class="w"> </span><span class="nv">COMMANDS</span><span class="s">&quot;</span>
<span class="w">  </span><span class="nb">:indent</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
 </pre>
</div>

<p>
例子：
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nb">:lazy</span><span class="w"> </span><span class="nv">dirvish</span><span class="w"> </span><span class="p">(</span><span class="nv">dirvish</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:require</span><span class="w"> </span><span class="nv">dirvish</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">dirvish-override-dired-mode</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
 </pre>
</div>

<p>
这段代码会生成一个函数 <code>setup-lazy-dirvish</code>, 执行之后它会先 require <code>dirivsh</code>, 设置覆盖 dired mode, 最后执行 <code>(dirvish)</code>. 如果不调用这个函数，里面的 require 什么的都不会加载。一旦加载之后，再次调用 <code>setup-lazy-dirvish</code>, body 也不再会去执行，只会执行 command 也就是 <code>(dirvish)</code>. 此时 <code>(setup-lazy-dirvish)</code> 和  <code>(dirvish)</code> 已经等价了，所以快捷键绑定前者即可。
</p>
</div>
</div>

<div id="outline-container-orgddce9c1" class="outline-4">
<h4 id="orgddce9c1">:disabled</h4>
<div class="outline-text-4" id="text-orgddce9c1">
<p>
停止后续setup, 用来调试或者弃用某个 feature.
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup-define</span><span class="w"> </span><span class="nb">:disabled</span>
<span class="w">  </span><span class="nf">#&#39;</span><span class="nv">setup-quit</span>
<span class="w">  </span><span class="nb">:documentation</span><span class="w"> </span><span class="s">&quot;Unconditionally abort the evaluation of the current body.&quot;</span><span class="p">)</span>
 </pre>
</div>

<p>
无参数，直接在最开始 <code>(:disabled)</code> 即可。
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orga2b8f30" class="outline-2">
<h2 id="orga2b8f30">基础设置</h2>
<div class="outline-text-2" id="text-orga2b8f30">
</div>
<div id="outline-container-org916a8fe" class="outline-3">
<h3 id="org916a8fe">Emacs 函数库</h3>
<div class="outline-text-3" id="text-org916a8fe">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">dash</span><span class="w"> </span><span class="s">&quot;https://github.com/magnars/dash.el&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;A modern list API for Emacs.&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="s">&quot;https://github.com/magnars/s.el&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;String manipulation library&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">f</span><span class="w"> </span><span class="s">&quot;https://github.com/rejeep/f.el&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Modern APIs for working with files and directories&quot;</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org89835b5" class="outline-3">
<h3 id="org89835b5">清理配置目录</h3>
<div class="outline-text-3" id="text-org89835b5">
<p>
正常使用的话，配置目录下面会有一大堆乱七八糟的东西，看着很求不爽。幸好有 no-littering, 它内置了各种规则，把奇奇怪怪的东西分类好，这就是 <code>etc</code> 和 <code>var</code> 目录的由来。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">no-littering</span><span class="w"> </span><span class="s">&quot;https://github.com/emacscollective/no-littering&quot;</span>
<span class="w">             </span><span class="nv">compat</span><span class="w"> </span><span class="s">&quot;https://github.com/emacsmirror/compat&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Help keeping </span><span class="ss">`~/.config/emacs&#39;</span><span class="s"> clean.&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:require</span><span class="w"> </span><span class="nv">no-littering</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">no-littering-etc-directory</span><span class="w"> </span><span class="nv">user-config-directory</span>
<span class="w">           </span><span class="nv">no-littering-var-directory</span><span class="w"> </span><span class="nv">user-data-directory</span>
<span class="w">           </span><span class="nv">auto-save-file-name-transforms</span><span class="w"> </span><span class="o">`</span><span class="p">((</span><span class="s">&quot;.*&quot;</span><span class="w"> </span><span class="o">,</span><span class="p">(</span><span class="nv">no-littering-expand-var-file-name</span><span class="w"> </span><span class="s">&quot;auto-save/&quot;</span><span class="p">)</span><span class="w"> </span><span class="no">t</span><span class="p">))</span>
<span class="w">           </span><span class="nv">custom-file</span><span class="w"> </span><span class="p">(</span><span class="nv">no-littering-expand-etc-file-name</span><span class="w"> </span><span class="s">&quot;custom.el&quot;</span><span class="p">)</span>
<span class="w">           </span><span class="nv">ac-comphist-file</span><span class="w"> </span><span class="p">(</span><span class="nv">no-littering-expand-var-file-name</span><span class="w"> </span><span class="s">&quot;ac-comphist.dat&quot;</span><span class="p">)</span>
<span class="w">           </span><span class="nv">recentf-save-file</span><span class="w"> </span><span class="p">(</span><span class="nv">no-littering-expand-var-file-name</span><span class="w"> </span><span class="s">&quot;recentf&quot;</span><span class="p">)))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org989ac68" class="outline-3">
<h3 id="org989ac68">全局按键绑定</h3>
<div class="outline-text-3" id="text-org989ac68">
<p>
如果使用 <code>:global</code> 或者 <code>global-set-key</code> 用这个来绑定全局键的话，它的优先级比较低，会被其他的 minor mode 覆盖。这里使用 modalka 来做全局按键绑定。它本质上想做的是模态编辑，它只有两种状态，就是开启和关闭的状态。因为它是一个 minor mode, 只要开了全局就几乎不会被覆盖。此外再给 minibuffer 加个 hook, 就可以实现 minibuffer 也享用这份键盘映射。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">modalka</span><span class="w"> </span><span class="s">&quot;https://github.com/mrkkrp/modalka&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;A building kit to help switch to modal editing in Emacs.&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:require</span><span class="w"> </span><span class="nv">modalka</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:diminish</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">minibuffer-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">modalka-global-mode</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:global</span><span class="w"> </span><span class="s">&quot;RET&quot;</span><span class="w"> </span><span class="nv">newline-and-indent</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:bind-into</span><span class="w"> </span><span class="nv">messages-buffer-mode-map</span><span class="w"> </span><span class="s">&quot;q&quot;</span><span class="w"> </span><span class="nv">quit-window</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org21342cb" class="outline-3">
<h3 id="org21342cb">帮助按键绑定</h3>
<div class="outline-text-3" id="text-org21342cb">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">help-fns</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Help commands.&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">describe-function</span>
<span class="w">             </span><span class="nv">describe-variable</span>
<span class="w">             </span><span class="nv">describe-key</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:modalka</span><span class="w"> </span><span class="s">&quot;C-p f&quot;</span><span class="w"> </span><span class="nv">describe-function</span>
<span class="w">            </span><span class="s">&quot;C-p v&quot;</span><span class="w"> </span><span class="nv">describe-variable</span>
<span class="w">            </span><span class="s">&quot;C-p k&quot;</span><span class="w"> </span><span class="nv">describe-key</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org009b958" class="outline-2">
<h2 id="org009b958">外观设置</h2>
<div class="outline-text-2" id="text-org009b958">
</div>
<div id="outline-container-org46c6a6a" class="outline-3">
<h3 id="org46c6a6a">字体设置</h3>
<div class="outline-text-3" id="text-org46c6a6a">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">faces</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Faces setting&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="c1">;; default fonts</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:face</span><span class="w"> </span><span class="nv">default</span>
<span class="w">    </span><span class="nb">:font</span><span class="w"> </span><span class="p">(</span><span class="nf">font-spec</span><span class="w"> </span><span class="nb">:family</span><span class="w"> </span><span class="s">&quot;FantasqueSansM Nerd Font&quot;</span><span class="w"> </span><span class="nb">:size</span><span class="w"> </span><span class="mi">20</span><span class="p">))</span>
<span class="w">  </span><span class="c1">;; unicode</span>
<span class="w">  </span><span class="p">(</span><span class="nf">set-fontset-font</span><span class="w"> </span><span class="no">t</span><span class="w"> </span><span class="ss">&#39;unicode</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">font-spec</span><span class="w"> </span><span class="nb">:family</span><span class="w"> </span><span class="s">&quot;WenQuanYi Zen Hei Mono&quot;</span><span class="p">))</span>
<span class="w">  </span><span class="c1">;; cn</span>
<span class="w">  </span><span class="p">(</span><span class="nf">set-fontset-font</span><span class="w"> </span><span class="no">t</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mh">#x4e00</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mh">#x9fff</span><span class="p">)</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">font-spec</span><span class="w"> </span><span class="nb">:family</span><span class="w"> </span><span class="s">&quot;Source Han Serif CN&quot;</span><span class="p">)))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org9057581" class="outline-3">
<h3 id="org9057581">主题设置</h3>
<div class="outline-text-3" id="text-org9057581">
<p>
<a href="https://draculatheme.com/" target="_blank">Dracule Theme</a> 的忠实粉丝就是我了，恨不得整个操作系统都用上。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">theme</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;theme settings&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">dracula-theme</span><span class="w"> </span><span class="s">&quot;https://github.com/dracula/emacs&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:require</span><span class="w"> </span><span class="nv">dracula-theme</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nv">load-theme</span><span class="w"> </span><span class="ss">&#39;dracula</span><span class="w"> </span><span class="no">t</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org94578fb" class="outline-3">
<h3 id="org94578fb">图标</h3>
<div class="outline-text-3" id="text-org94578fb">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">all-the-icons</span><span class="w"> </span><span class="s">&quot;https://github.com/domtronn/all-the-icons.el&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;A collection of various Icon Fonts within Emacs&quot;</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb846130" class="outline-2">
<h2 id="orgb846130">编辑设置</h2>
<div class="outline-text-2" id="text-orgb846130">
</div>
<div id="outline-container-orga7b373d" class="outline-3">
<h3 id="orga7b373d">基本编辑操作</h3>
<div class="outline-text-3" id="text-orga7b373d">
<p>
定义了包括光标移动、复制粘贴、选择删除等一系列相关操作，以及快捷键定义。
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">simple</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Basic editing commands for Emacs&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">indent-tabs-mode</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">           </span><span class="nv">tab-width</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">fset</span><span class="w"> </span><span class="ss">&#39;yes-or-no-p</span><span class="w"> </span><span class="ss">&#39;y-or-n-p</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/newline-and-indent-1</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">end-of-line</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">newline-and-indent</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/newline-and-indent-2</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">beginning-of-line</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">newline-and-indent</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">previous-line</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:modalka</span><span class="w"> </span><span class="s">&quot;C-o&quot;</span><span class="w"> </span><span class="nv">dust/newline-and-indent-1</span>
<span class="w">            </span><span class="s">&quot;M-o&quot;</span><span class="w"> </span><span class="nv">dust/newline-and-indent-2</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/forward-word</span><span class="w"> </span><span class="p">(</span><span class="nv">&amp;amp</span><span class="c1">;optional N)</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="w"> </span><span class="s">&quot;P&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">forward-word</span><span class="w"> </span><span class="nv">N</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/backward-word</span><span class="w"> </span><span class="p">(</span><span class="nv">&amp;amp</span><span class="c1">;optional N)</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="w"> </span><span class="s">&quot;P&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">backward-word</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/beginning-of-line</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">beginning-of-line</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/end-of-line</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">end-of-line</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/select-next-word</span><span class="w"> </span><span class="p">(</span><span class="nv">&amp;amp</span><span class="c1">;optional N)</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="w"> </span><span class="s">&quot;p&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">when</span><span class="w"> </span><span class="p">(</span><span class="nv">use-region-p</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="nv">keyboard-escape-quit</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nv">set-mark-command</span><span class="w"> </span><span class="no">nil</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">dust/forward-word</span><span class="w"> </span><span class="nv">N</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/select-previous-word</span><span class="w"> </span><span class="p">(</span><span class="nv">&amp;amp</span><span class="c1">;optional N)</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="w"> </span><span class="s">&quot;p&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">dust/select-next-word</span><span class="w"> </span><span class="p">(</span><span class="nf">-</span><span class="w"> </span><span class="p">(</span><span class="k">or</span><span class="w"> </span><span class="nv">N</span><span class="w"> </span><span class="mi">1</span><span class="p">))))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/select-word-at-point</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">dust/forward-word</span><span class="p">)</span><span class="w"> </span><span class="c1">; in case at the beginning of word</span>
<span class="w">    </span><span class="p">(</span><span class="nv">dust/backward-word</span><span class="p">)</span><span class="w"> </span><span class="c1">; </span>
<span class="w">    </span><span class="p">(</span><span class="nv">dust/select-next-word</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/select-line</span><span class="w"> </span><span class="p">(</span><span class="nv">&amp;amp</span><span class="c1">;optional N)</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">when</span><span class="w"> </span><span class="p">(</span><span class="nv">use-region-p</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="nv">keyboard-escape-quit</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nv">dust/beginning-of-line</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">set-mark-command</span><span class="w"> </span><span class="no">nil</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">move-end-of-line</span><span class="w"> </span><span class="nv">N</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/select-to-beginning-of-line</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">when</span><span class="w"> </span><span class="p">(</span><span class="nv">use-region-p</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="nv">keyboard-escape-quit</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nv">set-mark-command</span><span class="w"> </span><span class="no">nil</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">dust/beginning-of-line</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/select-to-end-of-line</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">when</span><span class="w"> </span><span class="p">(</span><span class="nv">use-region-p</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="nv">keyboard-escape-quit</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nv">set-mark-command</span><span class="w"> </span><span class="no">nil</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">dust/end-of-line</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/delete-previous-word</span><span class="w"> </span><span class="p">(</span><span class="nv">&amp;amp</span><span class="c1">;optional N)</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="w"> </span><span class="s">&quot;P&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">dust/select-previous-word</span><span class="w"> </span><span class="nv">N</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">delete-active-region</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/delete-next-word</span><span class="w"> </span><span class="p">(</span><span class="nv">&amp;amp</span><span class="c1">;optional N)</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="w"> </span><span class="s">&quot;P&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">dust/select-next-word</span><span class="w"> </span><span class="nv">N</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">delete-active-region</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/delete-word-at-point</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">dust/select-word-at-point</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">delete-active-region</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/delete-line</span><span class="w"> </span><span class="p">(</span><span class="nv">&amp;amp</span><span class="c1">;optional N)</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="w"> </span><span class="s">&quot;p&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">dust/select-line</span><span class="w"> </span><span class="nv">N</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">delete-active-region</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/delete-to-beginning-of-line</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">dust/select-to-beginning-of-line</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">delete-active-region</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/delete-to-end-of-line</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">dust/select-to-end-of-line</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">delete-active-region</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:modalka</span><span class="w"> </span><span class="s">&quot;C-h&quot;</span><span class="w"> </span><span class="nf">backward-char</span>
<span class="w">            </span><span class="s">&quot;C-j&quot;</span><span class="w"> </span><span class="nv">next-line</span>
<span class="w">            </span><span class="s">&quot;C-k&quot;</span><span class="w"> </span><span class="nv">previous-line</span>
<span class="w">            </span><span class="s">&quot;C-l&quot;</span><span class="w"> </span><span class="nf">forward-char</span>
<span class="w">            </span><span class="s">&quot;C-e&quot;</span><span class="w"> </span><span class="nv">backward-word</span>
<span class="w">            </span><span class="s">&quot;C-r&quot;</span><span class="w"> </span><span class="nf">forward-word</span>
<span class="w">            </span><span class="s">&quot;C-a&quot;</span><span class="w"> </span><span class="nv">dust/beginning-of-line</span>
<span class="w">            </span><span class="s">&quot;C-b&quot;</span><span class="w"> </span><span class="nv">dust/end-of-line</span>
<span class="w">            </span><span class="s">&quot;C-w&quot;</span><span class="w"> </span><span class="nv">kill-ring-save</span>
<span class="w">            </span><span class="s">&quot;M-w&quot;</span><span class="w"> </span><span class="nv">kill-region</span>
<span class="w">            </span><span class="s">&quot;C-v C-v&quot;</span><span class="w"> </span><span class="nv">set-mark-command</span>
<span class="w">            </span><span class="s">&quot;C-v C-h&quot;</span><span class="w"> </span><span class="nv">mark-whole-buffer</span>
<span class="w">            </span><span class="s">&quot;M-r&quot;</span><span class="w"> </span><span class="nv">scroll-up-command</span>
<span class="w">            </span><span class="s">&quot;M-e&quot;</span><span class="w"> </span><span class="nv">scroll-down-command</span><span class="w">            </span>
<span class="w">            </span><span class="s">&quot;C-z&quot;</span><span class="w"> </span><span class="nv">undo</span>
<span class="w">            </span><span class="s">&quot;M-z&quot;</span><span class="w"> </span><span class="nv">undo-redo</span><span class="w">            </span>
<span class="w">            </span><span class="s">&quot;C-t&quot;</span><span class="w"> </span><span class="nv">recenter-top-bottom</span>
<span class="w">            </span><span class="s">&quot;M-t&quot;</span><span class="w"> </span><span class="nv">move-to-window-line-top-bottom</span>
<span class="w">            </span><span class="s">&quot;C-q&quot;</span><span class="w"> </span><span class="nv">comment-line</span>
<span class="w">            </span><span class="s">&quot;C-s&quot;</span><span class="w"> </span><span class="nv">save-buffer</span><span class="w">            </span>
<span class="w">            </span><span class="s">&quot;C-r&quot;</span><span class="w"> </span><span class="nv">dust/forward-word</span>
<span class="w">            </span><span class="s">&quot;C-e&quot;</span><span class="w"> </span><span class="nv">dust/backward-word</span>
<span class="w">            </span><span class="s">&quot;C-v C-d&quot;</span><span class="w"> </span><span class="nv">dust/select-word-at-point</span>
<span class="w">            </span><span class="s">&quot;C-v C-r&quot;</span><span class="w"> </span><span class="nv">dust/select-next-word</span>
<span class="w">            </span><span class="s">&quot;C-v C-e&quot;</span><span class="w"> </span><span class="nv">dust/select-previous-word</span>
<span class="w">            </span><span class="s">&quot;C-v C-l&quot;</span><span class="w"> </span><span class="nv">dust/select-line</span>
<span class="w">            </span><span class="s">&quot;C-v C-a&quot;</span><span class="w"> </span><span class="nv">dust/select-to-beginning-of-line</span>
<span class="w">            </span><span class="s">&quot;C-v C-b&quot;</span><span class="w"> </span><span class="nv">dust/select-to-end-of-line</span>
<span class="w">            </span><span class="s">&quot;C-d C-d&quot;</span><span class="w"> </span><span class="nv">dust/delete-word-at-point</span>
<span class="w">            </span><span class="s">&quot;C-d C-r&quot;</span><span class="w"> </span><span class="nv">dust/delete-next-word</span>
<span class="w">            </span><span class="s">&quot;C-d C-e&quot;</span><span class="w"> </span><span class="nv">dust/delete-previous-word</span>
<span class="w">            </span><span class="s">&quot;C-d C-l&quot;</span><span class="w"> </span><span class="nv">dust/delete-line</span>
<span class="w">            </span><span class="s">&quot;C-d C-a&quot;</span><span class="w"> </span><span class="nv">dust/delete-to-beginning-of-line</span>
<span class="w">            </span><span class="s">&quot;C-d C-b&quot;</span><span class="w"> </span><span class="nv">dust/delete-to-end-of-line</span>
<span class="w">            </span><span class="s">&quot;C-&amp;lt;backspace&amp;gt;&quot;</span><span class="w"> </span><span class="nv">dust/delete-previous-word</span>
<span class="w">            </span><span class="s">&quot;C-&amp;lt;delete&amp;gt;&quot;</span><span class="w"> </span><span class="nv">dust/delete-next-word</span><span class="p">))</span>
 </pre>
</div>

<p>
选中区域后粘贴会删除选中文本（符合日常习惯）
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">delsel</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Delete selection if you insert&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">delete-selection-mode</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org795099e" class="outline-3">
<h3 id="org795099e">文件自动刷新</h3>
<div class="outline-text-3" id="text-org795099e">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">autorevert</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Revert buffers when files on disk change&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:with-hook</span><span class="w"> </span><span class="nv">find-file-hook</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:hook</span><span class="w"> </span><span class="nv">global-auto-revert-mode</span><span class="p">)))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org519e477" class="outline-3">
<h3 id="org519e477">保存历史记录和光标位置</h3>
<div class="outline-text-3" id="text-org519e477">
<p>
我确实没想到还能在这种地方 hook, 看了前辈的配置直接震惊一整晚 <sup>[<a id="fnr:2.2" class="footref" href="#fn:2">2</a>]</sup>。
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">savehist</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Save minibuffer history&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">savehist-additional-variables</span>
<span class="w">           </span><span class="o">&#39;</span><span class="p">(</span><span class="nv">mark-ring</span>
<span class="w">             </span><span class="nv">global-mark-ring</span>
<span class="w">             </span><span class="nv">search-ring</span>
<span class="w">             </span><span class="nv">regexp-search-ring</span>
<span class="w">             </span><span class="nv">extended-command-history</span><span class="p">)</span>
<span class="w">           </span><span class="nv">savehist-autosave-interval</span><span class="w"> </span><span class="nv">300</span>
<span class="w">           </span><span class="nv">history-length</span><span class="w"> </span><span class="nv">1000</span>
<span class="w">           </span><span class="nv">kill-ring-max</span><span class="w"> </span><span class="nv">300</span>
<span class="w">           </span><span class="nv">history-delete-duplicates</span><span class="w"> </span><span class="no">t</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">minibuffer-setup</span><span class="p">))</span>
<span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">saveplace</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;automatically save place in files&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:with-hook</span><span class="w"> </span><span class="nv">find-file-hook</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:hook</span><span class="w"> </span><span class="nv">save-place-mode</span><span class="p">)))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-orgc010bed" class="outline-3">
<h3 id="orgc010bed">窗口设置</h3>
<div class="outline-text-3" id="text-orgc010bed">
</div>
<div id="outline-container-org955cee0" class="outline-4">
<h4 id="org955cee0">窗口分割</h4>
<div class="outline-text-4" id="text-org955cee0">
<p>
选择 buffer, 水平或垂直分隔。
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">window</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Operations about windows&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/split-window-right</span><span class="w"> </span><span class="p">(</span><span class="nv">buffer</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="w"> </span><span class="s">&quot;bChoose buffer: \n&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">select-window</span><span class="w"> </span><span class="p">(</span><span class="nv">split-window-right</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nv">switch-to-buffer</span><span class="w"> </span><span class="nv">buffer</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/split-window-below</span><span class="w"> </span><span class="p">(</span><span class="nv">buffer</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="w"> </span><span class="s">&quot;bChoose buffer: \n&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">select-window</span><span class="w"> </span><span class="p">(</span><span class="nv">split-window-below</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nv">switch-to-buffer</span><span class="w"> </span><span class="nv">buffer</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:modalka</span><span class="w"> </span><span class="s">&quot;C-x 2&quot;</span><span class="w"> </span><span class="nv">dust/split-window-below</span>
<span class="w">            </span><span class="s">&quot;C-x 3&quot;</span><span class="w"> </span><span class="nv">dust/split-window-right</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org42314b0" class="outline-4">
<h4 id="org42314b0">窗口间移动</h4>
<div class="outline-text-4" id="text-org42314b0">
<p>
使用数字编号在窗口间快速移动，但这个包已经不维护了，用的是老的 API, 导致一直报 warning. 等后续考虑换一个插件或者改一下。
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">winum</span><span class="w"> </span><span class="s">&quot;https://github.com/deb0ch/emacs-winum&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Navigate Emacs windows and frames using numbers &quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:require</span><span class="w"> </span><span class="nv">winum</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:modalka</span><span class="w"> </span><span class="s">&quot;M-0&quot;</span><span class="w"> </span><span class="nv">winum-select-window-0</span>
<span class="w">            </span><span class="s">&quot;M-1&quot;</span><span class="w"> </span><span class="nv">winum-select-window-1</span>
<span class="w">            </span><span class="s">&quot;M-2&quot;</span><span class="w"> </span><span class="nv">winum-select-window-2</span>
<span class="w">            </span><span class="s">&quot;M-3&quot;</span><span class="w"> </span><span class="nv">winum-select-window-3</span>
<span class="w">            </span><span class="s">&quot;M-4&quot;</span><span class="w"> </span><span class="nv">winum-select-window-4</span>
<span class="w">            </span><span class="s">&quot;M-5&quot;</span><span class="w"> </span><span class="nv">winum-select-window-5</span>
<span class="w">            </span><span class="s">&quot;M-6&quot;</span><span class="w"> </span><span class="nv">winum-select-window-6</span>
<span class="w">            </span><span class="s">&quot;M-7&quot;</span><span class="w"> </span><span class="nv">winum-select-window-7</span>
<span class="w">            </span><span class="s">&quot;M-8&quot;</span><span class="w"> </span><span class="nv">winum-select-window-8</span>
<span class="w">            </span><span class="s">&quot;M-9&quot;</span><span class="w"> </span><span class="nv">winum-select-window-9</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">winum-auto-assign-0-to-minibuffer</span><span class="w"> </span><span class="nv">t</span>
<span class="w">           </span><span class="nv">winum-auto-setup-mode-line</span><span class="w"> </span><span class="no">t</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">winum-mode</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb657858" class="outline-3">
<h3 id="orgb657858">括号增强</h3>
<div class="outline-text-3" id="text-orgb657858">
</div>
<div id="outline-container-orge448991" class="outline-4">
<h4 id="orge448991">高亮括号</h4>
<div class="outline-text-4" id="text-orge448991">
<p>
高亮包围当前光标位置的括号，并用方框标识。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">paren</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Highlight matching paren&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:with-mode</span><span class="w"> </span><span class="nv">show-paren-mode</span>
<span class="w">      </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">prog-mode</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">show-paren-delay</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:advice</span><span class="w"> </span><span class="nv">show-paren-function</span><span class="w"> </span><span class="nb">:around</span><span class="w"> </span><span class="p">(</span><span class="nv">fn</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="k">cond</span><span class="w"> </span><span class="p">((</span><span class="nv">looking-at-p</span><span class="w"> </span><span class="s">&quot;\\s(&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">funcall</span><span class="w"> </span><span class="nv">fn</span><span class="p">))</span>
<span class="w">            </span><span class="p">(</span><span class="no">t</span><span class="w"> </span><span class="p">(</span><span class="k">save-excursion</span>
<span class="w">                 </span><span class="p">(</span><span class="nb">ignore-errors</span><span class="w"> </span><span class="p">(</span><span class="nv">backward-up-list</span><span class="p">))</span>
<span class="w">                 </span><span class="p">(</span><span class="nf">funcall</span><span class="w"> </span><span class="nv">fn</span><span class="p">)))))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:face</span><span class="w"> </span><span class="nv">show-paren-match</span>
<span class="w">      </span><span class="nb">:box</span><span class="w"> </span><span class="o">`</span><span class="p">(</span><span class="nb">:line-width</span><span class="w"> </span><span class="nv">-1</span>
<span class="w">             </span><span class="nb">:color</span><span class="w"> </span><span class="o">,</span><span class="p">(</span><span class="nv">face-attribute</span><span class="w"> </span><span class="ss">&#39;default</span>
<span class="w">                                     </span><span class="nb">:foreground</span><span class="p">))))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org14e53dc" class="outline-4">
<h4 id="org14e53dc">Smart Parens</h4>
<div class="outline-text-4" id="text-org14e53dc">
<p>
增强版的 electric-pair-mode, 同时提供了一些基于括号的操作，参见<a href="https://ebzzry.com/en/emacs-pairs/" target="_blank">Emacs and Pairs</a>.
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">smartparens</span><span class="w"> </span><span class="s">&quot;https://github.com/Fuco1/smartparens&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;A minor mode for dealing with pairs in Emacs.&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:lazy</span><span class="w"> </span><span class="nv">sp</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:require</span><span class="w"> </span><span class="nv">smartparens-config</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:diminish</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:with-mode</span><span class="w"> </span><span class="nv">turn-on-smartparens-strict-mode</span>
<span class="w">      </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">prog-mode</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">smartparens-global-mode</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:bind-into</span><span class="w"> </span><span class="nv">smartparens-mode-map</span>
<span class="w">      </span><span class="s">&quot;M-a&quot;</span><span class="w"> </span><span class="nv">sp-beginning-of-sexp</span>
<span class="w">      </span><span class="s">&quot;M-b&quot;</span><span class="w"> </span><span class="nv">sp-end-of-sexp</span>
<span class="w">      </span><span class="s">&quot;M-s&quot;</span><span class="w"> </span><span class="nv">sp-backward-up-sexp</span>
<span class="w">      </span><span class="s">&quot;M-d&quot;</span><span class="w"> </span><span class="nv">sp-down-sexp</span>
<span class="w">      </span><span class="s">&quot;M-\\&quot;</span><span class="w"> </span><span class="nv">sp-unwrap-sexp</span>
<span class="w">      </span><span class="s">&quot;M-]&quot;</span><span class="w"> </span><span class="nv">sp-forward-slurp-sexp</span>
<span class="w">      </span><span class="s">&quot;M-[&quot;</span><span class="w"> </span><span class="nv">sp-backward-slurp-sexp</span>
<span class="w">      </span><span class="s">&quot;M-{&quot;</span><span class="w"> </span><span class="nv">sp-forward-barf-sexp</span>
<span class="w">      </span><span class="s">&quot;M-}&quot;</span><span class="w"> </span><span class="nv">sp-backward-barf-sexp</span>
<span class="w">      </span><span class="s">&quot;M-m&quot;</span><span class="w"> </span><span class="nv">sp-select-next-thing</span>
<span class="w">      </span><span class="s">&quot;C-d C-l&quot;</span><span class="w"> </span><span class="nv">sp-kill-whole-line</span>
<span class="w">      </span><span class="s">&quot;M-j&quot;</span><span class="w"> </span><span class="nv">sp-next-sexp</span>
<span class="w">      </span><span class="s">&quot;M-k&quot;</span><span class="w"> </span><span class="nv">sp-previous-sexp</span>
<span class="w">      </span><span class="s">&quot;M-l&quot;</span><span class="w"> </span><span class="nv">sp-forward-symbol</span>
<span class="w">      </span><span class="s">&quot;M-h&quot;</span><span class="w"> </span><span class="nv">sp-backward-symbol</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:with-function</span><span class="w"> </span><span class="nv">setup-lazy-sp</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">pre-command</span><span class="p">)))</span>
 </pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgdfd7730" class="outline-3">
<h3 id="orgdfd7730">补全增强</h3>
<div class="outline-text-3" id="text-orgdfd7730">
</div>
<div id="outline-container-org66e7197" class="outline-4">
<h4 id="org66e7197">补全前端</h4>
<div class="outline-text-4" id="text-org66e7197">
<p>
弹框不全，用的也是较新的 corfu. 图标用的是 kind-all-the-icons, 源自论坛大佬：<a href="https://emacs-china.org/t/corfu-all-the-icons-icon/20907" target="_blank">糊了一个 corfu 适用的 all-the-icons 的 icon 效果 - Emacs-general - Emacs China</a>。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">corfu</span><span class="w"> </span><span class="s">&quot;https://github.com/minad/corfu&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Corfu enhances in-buffer completion with a small completion popup.&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:load-path</span><span class="w"> </span><span class="s">&quot;extensions&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">corfu-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:also-load</span><span class="w"> </span><span class="nv">corfu-popupinfo</span><span class="w"> </span><span class="nv">corfu-history</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">tab-always-indent</span><span class="w"> </span><span class="ss">&#39;complete</span>
<span class="w">           </span><span class="nv">corfu-auto</span><span class="w"> </span><span class="nv">t</span>
<span class="w">           </span><span class="nv">corfu-auto-delay</span><span class="w"> </span><span class="nv">0</span>
<span class="w">           </span><span class="nv">corfu-auto-prefix</span><span class="w"> </span><span class="nv">1</span>
<span class="w">           </span><span class="nv">corfu-popupinfo-delay</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:bind-into</span><span class="w"> </span><span class="nv">corfu-map</span>
<span class="w">    </span><span class="s">&quot;C-r&quot;</span><span class="w"> </span><span class="nv">corfu-scroll-down</span>
<span class="w">    </span><span class="s">&quot;C-e&quot;</span><span class="w"> </span><span class="nv">corfu-scroll-up</span>
<span class="w">    </span><span class="s">&quot;C-j&quot;</span><span class="w"> </span><span class="nv">corfu-next</span>
<span class="w">    </span><span class="s">&quot;C-k&quot;</span><span class="w"> </span><span class="nv">corfu-previous</span>
<span class="w">    </span><span class="s">&quot;M-n&quot;</span><span class="w"> </span><span class="nv">corfu-popupinfo-scroll-up</span>
<span class="w">    </span><span class="s">&quot;M-p&quot;</span><span class="w"> </span><span class="nv">corfu-popupinfo-scroll-down</span><span class="p">)</span><span class="w">  </span>
<span class="w">  </span><span class="p">(</span><span class="nb">:hook</span><span class="w"> </span><span class="nv">corfu-popupinfo-mode</span><span class="w"> </span><span class="nv">corfu-history-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">prog-mode</span><span class="w"> </span><span class="nv">ielm-mode</span><span class="p">))</span>
<span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">kind-all-the-icons</span><span class="w"> </span><span class="s">&quot;https://github.com/Hirozy/kind-all-the-icons&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:after</span><span class="w"> </span><span class="nv">corfu</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:require</span><span class="w"> </span><span class="nv">kind-all-the-icons</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="p">(</span><span class="nf">append</span><span class="w"> </span><span class="nv">corfu-margin-formatters</span><span class="p">)</span><span class="w"> </span><span class="ss">&#39;kind-all-the-icons-margin-formatter</span><span class="p">)))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org426b21f" class="outline-4">
<h4 id="org426b21f">补全后端</h4>
<div class="outline-text-4" id="text-org426b21f">
<p>
cape 提供了多种补全后端，目前用得并不多。
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">cape</span><span class="w"> </span><span class="s">&quot;https://github.com/minad/cape&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Completion At Point Extensions&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">cape-dabbrev</span>
<span class="w">             </span><span class="nv">cape-file</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="p">(</span><span class="nf">append</span><span class="w"> </span><span class="nv">completion-at-point-functions</span><span class="p">)</span><span class="w"> </span><span class="ss">&#39;cape-dabbrev</span>
<span class="w">           </span><span class="p">(</span><span class="nf">append</span><span class="w"> </span><span class="nv">completion-at-point-functions</span><span class="p">)</span><span class="w"> </span><span class="ss">&#39;cape-file</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org9146c6d" class="outline-4">
<h4 id="org9146c6d">补全模版</h4>
<div class="outline-text-4" id="text-org9146c6d">
<p>
暂时用这个，目前还没开始填自己的模版。用着感觉没 Yasnippet 方便。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">tempel</span><span class="w"> </span><span class="s">&quot;https://github.com/minad/tempel&quot;</span>
<span class="w">             </span><span class="nv">tempel-collection</span><span class="w"> </span><span class="s">&quot;https://github.com/Crandel/tempel-collection&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;A tiny template package for Emacs&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">tempel-setup-capf</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="c1">;; Add the Tempel Capf to `completion-at-point-functions&#39;.</span>
<span class="w">    </span><span class="c1">;; `tempel-expand&#39; only triggers on exact matches. Alternatively use</span>
<span class="w">    </span><span class="c1">;; `tempel-complete&#39; if you want to see all matches, but then you</span>
<span class="w">    </span><span class="c1">;; should also configure `tempel-trigger-prefix&#39;, such that Tempel</span>
<span class="w">    </span><span class="c1">;; does not trigger too often when you don&#39;t expect it. NOTE: We add</span>
<span class="w">    </span><span class="c1">;; `tempel-expand&#39; *before* the main programming mode Capf, such</span>
<span class="w">    </span><span class="c1">;; that it will be tried first.</span>
<span class="w">    </span><span class="p">(</span><span class="nb">require</span><span class="w"> </span><span class="ss">&#39;tempel-collection</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">setq-local</span><span class="w"> </span><span class="nv">completion-at-point-functions</span>
<span class="w">                </span><span class="p">(</span><span class="nf">cons</span><span class="w"> </span><span class="nf">#&#39;</span><span class="nv">tempel-expand</span>
<span class="w">                      </span><span class="nv">completion-at-point-functions</span><span class="p">)))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:with-function</span><span class="w"> </span><span class="nv">tempel-setup-capf</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">conf-mode</span>
<span class="w">                </span><span class="nv">prog-mode</span><span class="p">)))</span>
 </pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgcd2e90d" class="outline-3">
<h3 id="orgcd2e90d">Minibuffer 增强</h3>
<div class="outline-text-3" id="text-orgcd2e90d">
<p>
新三件套 (vertico, orderless, consult)
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">vertico</span><span class="w"> </span><span class="s">&quot;https://github.com/minad/vertico&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;a performant and minimalistic vertical completion UI&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:load-path</span><span class="w"> </span><span class="s">&quot;extensions&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">vertico-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:also-load</span><span class="w"> </span><span class="nv">vertico-directory</span><span class="w"> </span><span class="nv">vertico-mouse</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">vertico-scroll-margin</span><span class="w"> </span><span class="nv">0</span>
<span class="w">           </span><span class="nv">vertico-cycle</span><span class="w"> </span><span class="nv">t</span>
<span class="w">           </span><span class="nv">vertico-resize</span><span class="w"> </span><span class="no">t</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">pre-command</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:hook</span><span class="w"> </span><span class="nv">vertico-mouse-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:bind-into</span><span class="w"> </span><span class="nv">vertico-map</span>
<span class="w">    </span><span class="s">&quot;RET&quot;</span><span class="w"> </span><span class="nv">vertico-directory-enter</span>
<span class="w">    </span><span class="s">&quot;DEL&quot;</span><span class="w"> </span><span class="nv">vertico-directory-delete-char</span>
<span class="w">    </span><span class="s">&quot;C-DEL&quot;</span><span class="w"> </span><span class="nv">vertico-directory-delete-word</span>
<span class="w">    </span><span class="s">&quot;M-DEL&quot;</span><span class="w"> </span><span class="nv">vertico-directory-up</span><span class="p">))</span>
<span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">orderless</span><span class="w">  </span><span class="s">&quot;https://github.com/oantolin/orderless&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;An orderless completion style.&quot;</span><span class="p">)</span><span class="w">  </span>
<span class="w">  </span><span class="p">(</span><span class="nb">:require</span><span class="w"> </span><span class="nv">orderless</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">completion-styles</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="nv">orderless</span>
<span class="w">                               </span><span class="nf">substring</span>
<span class="w">                               </span><span class="nv">partial-completion</span>
<span class="w">                               </span><span class="nv">basic</span><span class="p">)</span>
<span class="w">           </span><span class="nv">completion-category-defaults</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">           </span><span class="nv">completion-category-overrides</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">           </span><span class="nv">completion-category-defaults</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">           </span><span class="nv">completion-category-overrides</span><span class="w"> </span><span class="o">&#39;</span><span class="p">((</span><span class="nv">file</span><span class="w"> </span><span class="p">(</span><span class="nv">styles</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="p">(</span><span class="nv">partial-completion</span><span class="p">))))))</span>
<span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">marginalia</span><span class="w"> </span><span class="s">&quot;https://github.com/minad/marginalia&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Add marginalia to the minibuffer completions.&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">marginalia-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:hook</span><span class="w"> </span><span class="nv">all-the-icons-completion-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">vertico-mode</span><span class="p">))</span>
<span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">all-the-icons-completion</span><span class="w"> </span><span class="s">&quot;https://github.com/iyefrat/all-the-icons-completion&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Add icons to completion candidates&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">all-the-icons-completion-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">marginalia-mode</span><span class="p">))</span>
<span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">embark</span><span class="w"> </span><span class="s">&quot;https://github.com/oantolin/embark&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Make it easy to choose a command to run based on what is near point&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">embark-act</span><span class="w"> </span><span class="nv">embark-dwim</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">prefix-help-command</span><span class="w"> </span><span class="nf">#&#39;</span><span class="nv">embark-prefix-help-command</span>
<span class="w">           </span><span class="p">(</span><span class="nf">append</span><span class="w"> </span><span class="nv">display-buffer-alist</span><span class="p">)</span>
<span class="w">           </span><span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;\\`\\*Embark Collect \\(Live\\|Completions\\)\\*&quot;</span>
<span class="w">             </span><span class="nv">nil</span>
<span class="w">             </span><span class="p">(</span><span class="nf">window-parameters</span><span class="w"> </span><span class="p">(</span><span class="nv">mode-line-format</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">none</span><span class="p">))))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:modalka</span><span class="w">  </span><span class="s">&quot;C-/&quot;</span><span class="w"> </span><span class="nv">embark-act</span>
<span class="w">             </span><span class="s">&quot;C-?&quot;</span><span class="w"> </span><span class="nv">embark-dwim</span><span class="p">))</span>
<span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">consult</span><span class="w"> </span><span class="s">&quot;https://github.com/minad/consult&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Search and navigation commands based on the Emacs completion function&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:lazy</span><span class="w"> </span><span class="nv">consult</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:require</span><span class="w"> </span><span class="nv">consult</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:also-load</span><span class="w"> </span><span class="nv">consult-imenu</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:modalka</span><span class="w"> </span><span class="s">&quot;C-f C-f&quot;</span><span class="w"> </span><span class="nv">consult-line</span>
<span class="w">              </span><span class="s">&quot;C-f C-l&quot;</span><span class="w"> </span><span class="nv">consult-goto-line</span>
<span class="w">              </span><span class="s">&quot;C-f C-m&quot;</span><span class="w"> </span><span class="nv">consult-mark</span>
<span class="w">              </span><span class="s">&quot;C-f C-S-m&quot;</span><span class="w"> </span><span class="nv">consult-global-mark</span>
<span class="w">              </span><span class="s">&quot;C-f C-d&quot;</span><span class="w"> </span><span class="nv">consult-ripgrep</span>
<span class="w">              </span><span class="s">&quot;C-f C-s&quot;</span><span class="w"> </span><span class="nv">consult-imenu</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:with-function</span><span class="w"> </span><span class="nv">setup-lazy-consult</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">pre-command</span><span class="p">)))</span>
 </pre>
</div>

<p>
给 minibuffer 的 eval 加上 corfu 补全和 smart parens 括号增强。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">eval-expression-enhence</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Enhenc eval-expression in minibuffer.&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:with-hook</span><span class="w"> </span><span class="nv">minibuffer-setup-hook</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:hook</span><span class="w"> </span><span class="p">(</span><span class="nb">lambda</span><span class="w"> </span><span class="p">()</span>
<span class="w">             </span><span class="p">(</span><span class="nb">when</span><span class="w"> </span><span class="p">(</span><span class="nf">eq</span><span class="w"> </span><span class="nv">this-command</span><span class="w"> </span><span class="ss">&#39;eval-expression</span><span class="p">)</span>
<span class="w">               </span><span class="p">(</span><span class="nv">corfu-mode</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">               </span><span class="p">(</span><span class="nv">smartparens-mode</span><span class="w"> </span><span class="mi">1</span><span class="p">))))))</span>
 </pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org796e94c" class="outline-2">
<h2 id="org796e94c">编程</h2>
<div class="outline-text-2" id="text-org796e94c">
</div>
<div id="outline-container-orgb97719f" class="outline-3">
<h3 id="orgb97719f">显示</h3>
<div class="outline-text-3" id="text-orgb97719f">
</div>
<div id="outline-container-org6f2ca5e" class="outline-4">
<h4 id="org6f2ca5e">行号</h4>
<div class="outline-text-4" id="text-org6f2ca5e">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">display-line-numbers</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Interface for display-line-numbers&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">display-line-numbers-type</span><span class="w"> </span><span class="ss">&#39;relative</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">prog-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:face</span><span class="w"> </span><span class="nv">line-number</span>
<span class="w">    </span><span class="nb">:slant</span><span class="w"> </span><span class="ss">&#39;italic</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:face</span><span class="w"> </span><span class="nv">line-number-current-line</span>
<span class="w">    </span><span class="nb">:foreground</span><span class="w"> </span><span class="p">(</span><span class="nv">face-attribute</span><span class="w"> </span><span class="ss">&#39;error</span><span class="w"> </span><span class="nb">:foreground</span><span class="p">)</span>
<span class="w">    </span><span class="nb">:background</span><span class="w"> </span><span class="p">(</span><span class="nv">face-attribute</span><span class="w"> </span><span class="ss">&#39;highlight</span><span class="w"> </span><span class="nb">:background</span><span class="p">)</span>
<span class="w">    </span><span class="nb">:weight</span><span class="w"> </span><span class="ss">&#39;bold</span>
<span class="w">    </span><span class="nb">:slant</span><span class="w"> </span><span class="ss">&#39;normal</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-orgb187b23" class="outline-4">
<h4 id="orgb187b23">高亮当前行</h4>
<div class="outline-text-4" id="text-orgb187b23">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">hl-line</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Highlight the current line&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">prog-mode</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-orgaa72053" class="outline-4">
<h4 id="orgaa72053">彩色括号</h4>
<div class="outline-text-4" id="text-orgaa72053">
<p>
对不同层次的括号使用不同颜色，对 Lisp 这种多重括号尤其有效。
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">rainbow-delimiters</span><span class="w"> </span><span class="s">&quot;https://github.com/Fanael/rainbow-delimiters&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Highlight delimiters according to their depth.&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">rainbow-delimiters-mode</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">prog-mode</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org0e8b915" class="outline-4">
<h4 id="org0e8b915">不显示 eldoc</h4>
<div class="outline-text-4" id="text-org0e8b915">
<p>
还要单独为这个写一个 setup, 多捞哦。
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">eldoc</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Show function arglist or variable docstring in echo area&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:diminish</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>
<div id="outline-container-org0968fbf" class="outline-4">
<h4 id="org0968fbf">缩进提示</h4>
<div class="outline-text-4" id="text-org0968fbf">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">indent-guide</span><span class="w"> </span><span class="s">&quot;https://github.com/zk-phi/indent-guide&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Show vertical lines to guide indentation&quot;</span><span class="p">)</span><span class="w">  </span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">indent-guide-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:diminish</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">prog-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">indent-guide-recursive</span><span class="w"> </span><span class="no">t</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:after</span><span class="w"> </span><span class="nv">indent-guide</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:face</span><span class="w"> </span><span class="nv">indent-guide-face</span>
<span class="w">      </span><span class="nb">:foreground</span><span class="w"> </span><span class="p">(</span><span class="nv">face-attribute</span><span class="w"> </span><span class="ss">&#39;shadow</span><span class="w"> </span><span class="nb">:foreground</span><span class="p">))))</span>
 </pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgee26d6d" class="outline-3">
<h3 id="orgee26d6d">移动到缩进行首</h3>
<div class="outline-text-3" id="text-orgee26d6d">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">mwim</span><span class="w"> </span><span class="s">&quot;https://github.com/alezost/mwim.el&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Operations of Cursor moving&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">mwim-beginning-of-code-or-line</span>
<span class="w">             </span><span class="nv">mwim-end-of-code-or-line</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defalias</span><span class="w"> </span><span class="ss">&#39;dust/beginning-of-line</span><span class="w"> </span><span class="ss">&#39;mwim-beginning-of-code-or-line</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defalias</span><span class="w"> </span><span class="ss">&#39;dust/end-of-line</span><span class="w"> </span><span class="ss">&#39;mwim-end-of-code-or-line</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org619ec2d" class="outline-3">
<h3 id="org619ec2d">代码折叠</h3>
<div class="outline-text-3" id="text-org619ec2d">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">hideshow</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Minor mode cmds to selectively display code/comment blocks&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:with-mode</span><span class="w"> </span><span class="nv">hs-minor-mode</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:diminish</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">prog-mode</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:bind</span><span class="w"> </span><span class="s">&quot;C-c C-v C-c&quot;</span><span class="w"> </span><span class="nv">hs-toggle-hiding</span>
<span class="w">           </span><span class="s">&quot;C-c C-v C-h&quot;</span><span class="w"> </span><span class="nv">hs-hide-block</span>
<span class="w">           </span><span class="s">&quot;C-c C-v C-s&quot;</span><span class="w"> </span><span class="nv">hs-show-block</span>
<span class="w">           </span><span class="s">&quot;C-c C-v C-t&quot;</span><span class="w"> </span><span class="nv">hs-hide-all</span>
<span class="w">           </span><span class="s">&quot;C-c C-v C-a&quot;</span><span class="w"> </span><span class="nv">hs-show-all</span>
<span class="w">           </span><span class="s">&quot;C-c C-v C-l&quot;</span><span class="w"> </span><span class="nv">hs-hide-level</span><span class="p">)))</span>
 </pre>
</div>
</div>
</div>
<div id="outline-container-org7de6f57" class="outline-3">
<h3 id="org7de6f57">LSP</h3>
<div class="outline-text-3" id="text-org7de6f57">
<p>
不搞开发，能用就行。不 hook <code>prog-mode</code> 的原因是写比如 elisp 就没必要启动用它。
</p>

<p>
<code>:only-if</code> 不让它在 TUI 下使用。这样便可用 <code>emacs -nw</code> 来替代 vim 了。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">eglot</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;A emacs LSP client&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">eglot-ensure</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:only-if</span><span class="w"> </span><span class="nf">window-system</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:with-function</span><span class="w"> </span><span class="nv">eglot-ensure</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">python-mode</span>
<span class="w">                </span><span class="nv">yaml-mode</span>
<span class="w">                </span><span class="nv">js-mode</span>
<span class="w">                </span><span class="nv">mhtml-mode</span>
<span class="w">                </span><span class="nv">scss-mode</span>
<span class="w">                </span><span class="nv">latex-mode</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">eldoc-echo-area-use-multiline-p</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>
<div id="outline-container-org4edabf7" class="outline-3">
<h3 id="org4edabf7">YAML</h3>
<div class="outline-text-3" id="text-org4edabf7">
<p>
偶尔会用到。
</p>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">yaml-mode</span><span class="w"> </span><span class="s">&quot;https://github.com/yoshiki/yaml-mode&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Support for YAML Language&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">yaml-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:file-match</span><span class="w"> </span><span class="s">&quot;\\.\\(yml\\|yaml\\)\\&#39;&quot;</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-orgdc98ee5" class="outline-3">
<h3 id="orgdc98ee5">Emacs Lisp</h3>
<div class="outline-text-3" id="text-orgdc98ee5">
</div>
<div id="outline-container-org61065b6" class="outline-4">
<h4 id="org61065b6">elisp-def</h4>
<div class="outline-text-4" id="text-org61065b6">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">elisp-def</span><span class="w"> </span><span class="s">&quot;https://github.com/Wilfred/elisp-def&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Go to the definition of the symbol at point.&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">elisp-def-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">emacs-lisp-mode</span><span class="w"> </span><span class="nv">ielm-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:diminish</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org99c07cf" class="outline-3">
<h3 id="org99c07cf">Yuck</h3>
<div class="outline-text-3" id="text-org99c07cf">
<p>
Yuck 是窗口图形模块套件 <a href="https://elkowar.github.io/eww/" target="_blank">EWW</a> 的语言，基于 Lisp.
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">yuck-mode</span><span class="w"> </span><span class="s">&quot;https://github.com/mmcjimsey26/yuck-mode&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Emacs major mode for editing yuck configuration files&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">yuck-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:file-match</span><span class="w"> </span><span class="s">&quot;\\.\\(yuck\\)\\&#39;&quot;</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org32f0f51" class="outline-3">
<h3 id="org32f0f51">Sxhkd</h3>
<div class="outline-text-3" id="text-org32f0f51">
<p>
bspwm 下的键盘映射配置。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">sxhkd-mode</span><span class="w"> </span><span class="s">&quot;https://github.com/xFA25E/sxhkd-mode&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;A major mode for editing sxhkdrc&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">sxhkd-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:file-match</span><span class="w"> </span><span class="p">(</span><span class="nb">rx</span><span class="w"> </span><span class="s">&quot;sxhkdrc&quot;</span><span class="w"> </span><span class="nv">string-end</span><span class="p">)))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org1c5d018" class="outline-3">
<h3 id="org1c5d018">Jinja2</h3>
<div class="outline-text-3" id="text-org1c5d018">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">jinja2-mode</span><span class="w"> </span><span class="s">&quot;https://github.com/paradoxxxzero/jinja2-mode&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Jinja2 mode for emacs&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">jinja2-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:file-match</span><span class="w"> </span><span class="s">&quot;\\.\\(jinja2\\)\\&#39;&quot;</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-orgdfe3aaf" class="outline-3">
<h3 id="orgdfe3aaf">Markdown</h3>
<div class="outline-text-3" id="text-orgdfe3aaf">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">markdown-mode</span><span class="w"> </span><span class="s">&quot;https://github.com/jrblevin/markdown-mode&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Support for Markdown&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">markdown-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">markdown-command</span><span class="w"> </span><span class="s">&quot;multimarkdown&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:file-match</span><span class="w"> </span><span class="s">&quot;\\.md\\&#39;&quot;</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org98486da" class="outline-2">
<h2 id="org98486da">Org mode</h2>
<div class="outline-text-2" id="text-org98486da">
<p>
Org mode 原本是一个基于 outline 的任务管理，但是因为提供了丰富的语言标记，以及结合 emacs 提供导出、发布等各种操作，它已然成为一个强大的笔记、管理、收集等集一体的系统。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">org</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;keeping notes, maintaining ToDo lists,&quot;</span>
<span class="w">        </span><span class="s">&quot;and doing project planning&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:after</span><span class="w"> </span><span class="nv">org</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">org-todo-keywords</span><span class="w"> </span><span class="o">&#39;</span><span class="p">((</span><span class="nv">sequence</span><span class="w"> </span><span class="s">&quot;TODO(t)&quot;</span>
<span class="w">                                           </span><span class="s">&quot;DOING(i)&quot;</span>
<span class="w">                                           </span><span class="s">&quot;WAIT(w@/!)&quot;</span>
<span class="w">                                           </span><span class="s">&quot;|&quot;</span>
<span class="w">                                           </span><span class="s">&quot;DONE(d!)&quot;</span>
<span class="w">                                           </span><span class="s">&quot;CANCELED(c@)&quot;</span><span class="p">)))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">org-edit-src-content-indentation</span><span class="w"> </span><span class="nv">0</span>
<span class="w">             </span><span class="nv">org-auto-align-tags</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">             </span><span class="nv">org-tags-column</span><span class="w"> </span><span class="nv">0</span>
<span class="w">             </span><span class="nv">org-use-sub-superscripts</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">             </span><span class="nv">org-link-file-path-type</span><span class="w"> </span><span class="ss">&#39;relative</span>
<span class="w">             </span><span class="nv">org-startup-truncated</span><span class="w"> </span><span class="no">t</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:face</span><span class="w"> </span><span class="nv">org-checkbox</span><span class="w"> </span><span class="nb">:box</span><span class="w"> </span><span class="no">nil</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:face</span><span class="w"> </span><span class="nv">org-level-1</span><span class="w"> </span><span class="nb">:weight</span><span class="w"> </span><span class="ss">&#39;semi-bold</span><span class="w"> </span><span class="nb">:height</span><span class="w"> </span><span class="mf">1.5</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:face</span><span class="w"> </span><span class="nv">org-level-2</span><span class="w"> </span><span class="nb">:weight</span><span class="w"> </span><span class="ss">&#39;semi-bold</span><span class="w"> </span><span class="nb">:height</span><span class="w"> </span><span class="mf">1.4</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:face</span><span class="w"> </span><span class="nv">org-level-3</span><span class="w"> </span><span class="nb">:weight</span><span class="w"> </span><span class="ss">&#39;semi-bold</span><span class="w"> </span><span class="nb">:height</span><span class="w"> </span><span class="mf">1.3</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:face</span><span class="w"> </span><span class="nv">org-level-4</span><span class="w"> </span><span class="nb">:weight</span><span class="w"> </span><span class="ss">&#39;semi-bold</span><span class="w"> </span><span class="nb">:height</span><span class="w"> </span><span class="mf">1.2</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:face</span><span class="w"> </span><span class="nv">org-level-5</span><span class="w"> </span><span class="nb">:weight</span><span class="w"> </span><span class="ss">&#39;semi-bold</span><span class="w"> </span><span class="nb">:height</span><span class="w"> </span><span class="mf">1.1</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:face</span><span class="w"> </span><span class="nv">org-level-6</span><span class="w"> </span><span class="nb">:weight</span><span class="w"> </span><span class="ss">&#39;semi-bold</span><span class="w"> </span><span class="nb">:height</span><span class="w"> </span><span class="mf">1.0</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:hook</span><span class="w"> </span><span class="p">(</span><span class="nb">lambda</span><span class="w"> </span><span class="p">()</span>
<span class="w">           </span><span class="p">(</span><span class="nv">setup-lazy-dust/org-heading</span><span class="p">)</span>
<span class="w">           </span><span class="p">(</span><span class="nv">setup-lazy-dust/org-insert</span><span class="p">))))</span>
 </pre>
</div>
</div>

<div id="outline-container-org5efca74" class="outline-3">
<h3 id="org5efca74">快速改变 heading</h3>
<div class="outline-text-3" id="text-org5efca74">
<p>
通过快捷键来快速调整 headline 等级。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">dust/org-heading</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:lazy</span><span class="w"> </span><span class="nv">dust/org-heading</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:require</span><span class="w"> </span><span class="nv">s</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/org-headline-set</span><span class="w"> </span><span class="p">(</span><span class="nv">N</span><span class="p">)</span>
<span class="w">      </span><span class="s">&quot;Set org headline&quot;</span>
<span class="w">      </span><span class="p">(</span><span class="nb">when</span><span class="w"> </span><span class="p">(</span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="nv">org-at-heading-p</span><span class="p">)</span>
<span class="w">                 </span><span class="p">(</span><span class="nf">/=</span><span class="w"> </span><span class="nv">N</span>
<span class="w">                     </span><span class="p">(</span><span class="k">save-excursion</span>
<span class="w">                       </span><span class="p">(</span><span class="nf">beginning-of-line</span><span class="p">)</span>
<span class="w">                       </span><span class="p">(</span><span class="nf">length</span>
<span class="w">                        </span><span class="p">(</span><span class="nf">nth</span><span class="w"> </span><span class="nv">1</span>
<span class="w">                             </span><span class="p">(</span><span class="nv">s-match</span><span class="w"> </span><span class="nv">org-heading-regexp</span>
<span class="w">                                      </span><span class="p">(</span><span class="nf">buffer-substring-no-properties</span>
<span class="w">                                       </span><span class="p">(</span><span class="nf">point</span><span class="p">)</span>
<span class="w">                                       </span><span class="p">(</span><span class="nf">+</span><span class="w"> </span><span class="p">(</span><span class="nf">point</span><span class="p">)</span><span class="w"> </span><span class="mi">10</span><span class="p">))))))))</span>
<span class="w">        </span><span class="p">(</span><span class="nv">org-toggle-heading</span><span class="p">))</span>
<span class="w">      </span><span class="p">(</span><span class="nb">when</span><span class="w"> </span><span class="p">(</span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="nv">&amp;gt</span><span class="c1">;= N 1)</span>
<span class="w">                 </span><span class="p">(</span><span class="nv">&amp;lt</span><span class="c1">;= N 6))</span>
<span class="w">        </span><span class="p">(</span><span class="nv">org-toggle-heading</span><span class="w"> </span><span class="nv">N</span><span class="p">)))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/org-headline-set-1</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nv">dust/org-headline-set</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/org-headline-set-2</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nv">dust/org-headline-set</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/org-headline-set-3</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nv">dust/org-headline-set</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/org-headline-set-4</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nv">dust/org-headline-set</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/org-headline-set-5</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nv">dust/org-headline-set</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/org-headline-set-6</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nv">dust/org-headline-set</span><span class="w"> </span><span class="mi">6</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:bind-into</span><span class="w"> </span><span class="nv">org-mode-map</span>
<span class="w">      </span><span class="s">&quot;C-c h 1&quot;</span><span class="w"> </span><span class="nv">dust/org-headline-set-1</span>
<span class="w">      </span><span class="s">&quot;C-c h 2&quot;</span><span class="w"> </span><span class="nv">dust/org-headline-set-2</span>
<span class="w">      </span><span class="s">&quot;C-c h 3&quot;</span><span class="w"> </span><span class="nv">dust/org-headline-set-3</span>
<span class="w">      </span><span class="s">&quot;C-c h 4&quot;</span><span class="w"> </span><span class="nv">dust/org-headline-set-4</span>
<span class="w">      </span><span class="s">&quot;C-c h 5&quot;</span><span class="w"> </span><span class="nv">dust/org-headline-set-5</span>
<span class="w">      </span><span class="s">&quot;C-c h 6&quot;</span><span class="w"> </span><span class="nv">dust/org-headline-set-6</span><span class="p">)))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org272b3fa" class="outline-3">
<h3 id="org272b3fa">快速插入</h3>
<div class="outline-text-3" id="text-org272b3fa">
<ol class="org-ol">
<li>输入一个 URL, 尝试自动获取返回的 HTML 的 <code>&lt;title&gt;</code>, 如果有就把它作为 org-link 的 description.</li>
<li>给定一个存放图片的目录，按最近修改时间排序</li>
<li>按键录入</li>
</ol>
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">dust/org-insert</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:lazy</span><span class="w"> </span><span class="nv">dust/org-insert</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:require</span><span class="w"> </span><span class="nv">dash</span><span class="w"> </span><span class="nv">f</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/org-insert-uri</span><span class="w"> </span><span class="p">()</span>
<span class="w">      </span><span class="s">&quot;Try to fetch HTML by URL, parsing it to get title.&quot;</span>
<span class="w">      </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nv">title</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">(</span><span class="nv">uri</span><span class="w"> </span><span class="p">(</span><span class="nf">read-from-minibuffer</span><span class="w"> </span><span class="s">&quot;Uri: &quot;</span><span class="p">)))</span>
<span class="w">        </span><span class="p">(</span><span class="nb">with-current-buffer</span><span class="w"> </span><span class="p">(</span><span class="nv">url-retrieve-synchronously</span>
<span class="w">                              </span><span class="nv">uri</span><span class="w"> </span><span class="no">t</span><span class="w"> </span><span class="no">nil</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span>
<span class="w">          </span><span class="p">(</span><span class="k">let*</span><span class="w"> </span><span class="p">((</span><span class="nv">dom</span><span class="w"> </span><span class="p">(</span><span class="nf">libxml-parse-html-region</span>
<span class="w">                       </span><span class="p">(</span><span class="nf">point-min</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">point-max</span><span class="p">))))</span>
<span class="w">            </span><span class="p">(</span><span class="k">setq</span><span class="w"> </span><span class="nv">title</span><span class="w"> </span>
<span class="w">                  </span><span class="p">(</span><span class="k">and</span><span class="w"> </span><span class="nv">dom</span>
<span class="w">                       </span><span class="p">(</span><span class="nv">dom-text</span><span class="w"> </span><span class="p">(</span><span class="nv">dom-by-tag</span><span class="w"> </span><span class="nv">dom</span><span class="w"> </span><span class="ss">&#39;title</span><span class="p">))))))</span>
<span class="w">        </span><span class="p">(</span><span class="nb">unless</span><span class="w"> </span><span class="p">(</span><span class="k">or</span><span class="w"> </span><span class="nv">title</span>
<span class="w">                    </span><span class="p">(</span><span class="nv">length=</span><span class="w"> </span><span class="nv">title</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span>
<span class="w">          </span><span class="p">(</span><span class="k">setq</span><span class="w"> </span><span class="nv">title</span>
<span class="w">                </span><span class="p">(</span><span class="nf">read-from-minibuffer</span>
<span class="w">                 </span><span class="s">&quot;Failed to get title. Input descript: &quot;</span><span class="p">)))</span>
<span class="w">        </span><span class="p">(</span><span class="nf">insert</span><span class="w"> </span><span class="p">(</span><span class="nf">format</span><span class="w"> </span><span class="s">&quot;[[%s][%s]]&quot;</span><span class="w"> </span><span class="nv">uri</span><span class="w"> </span><span class="p">(</span><span class="nv">s-trim</span><span class="w"> </span><span class="nv">title</span><span class="p">)))))</span>
<span class="w">    </span><span class="p">(</span><span class="k">defvar</span><span class="w"> </span><span class="nv">dust/org-image-directory</span><span class="w"> </span><span class="s">&quot;~/Note/assets&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/org-image--sort-completion-table</span><span class="w"> </span><span class="p">(</span><span class="nv">completions</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="nb">lambda</span><span class="w"> </span><span class="p">(</span><span class="nf">string</span><span class="w"> </span><span class="nv">pred</span><span class="w"> </span><span class="nv">action</span><span class="p">)</span>
<span class="w">        </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nf">eq</span><span class="w"> </span><span class="nv">action</span><span class="w"> </span><span class="ss">&#39;metadata</span><span class="p">)</span>
<span class="w">            </span><span class="o">`</span><span class="p">(</span><span class="nv">metadata</span><span class="w"> </span><span class="p">(</span><span class="nv">display-sort-function</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="o">,</span><span class="nf">#&#39;identity</span><span class="p">))</span>
<span class="w">          </span><span class="p">(</span><span class="nv">complete-with-action</span><span class="w"> </span><span class="nv">action</span><span class="w"> </span><span class="nv">completions</span><span class="w"> </span><span class="nf">string</span><span class="w"> </span><span class="nv">pred</span><span class="p">))))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/org-insert-image</span><span class="w"> </span><span class="p">()</span>
<span class="w">      </span><span class="s">&quot;Insert image from Special directory into current buffer.&quot;</span>
<span class="w">      </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nv">images</span><span class="w"> </span><span class="p">(</span><span class="nv">--sort</span><span class="w"> </span><span class="p">(</span><span class="nv">&amp;gt</span><span class="c1">;= (f-modification-time it &#39;seconds)</span>
<span class="w">                                </span><span class="p">(</span><span class="nv">f-modification-time</span><span class="w"> </span><span class="nv">other</span><span class="w"> </span><span class="ss">&#39;seconds</span><span class="p">))</span>
<span class="w">                            </span><span class="p">(</span><span class="nv">f-files</span><span class="w"> </span><span class="nv">dust/org-image-directory</span><span class="p">)))</span>
<span class="w">            </span><span class="p">(</span><span class="nv">cur-file</span><span class="w"> </span><span class="p">(</span><span class="nv">f-this-file</span><span class="p">)))</span>
<span class="w">        </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nv">not</span><span class="w"> </span><span class="nv">cur-file</span><span class="p">)</span>
<span class="w">            </span><span class="p">(</span><span class="nf">message</span><span class="w"> </span><span class="s">&quot;Current buffer is not a file: %s&quot;</span><span class="w"> </span><span class="p">(</span><span class="nf">buffer-name</span>
<span class="w">                                                         </span><span class="p">(</span><span class="nf">current-buffer</span><span class="p">)))</span>
<span class="w">          </span><span class="p">(</span><span class="nf">insert</span><span class="w"> </span><span class="p">(</span><span class="nf">format</span><span class="w"> </span><span class="s">&quot;[[file:%s]]\n&quot;</span>
<span class="w">                          </span><span class="p">(</span><span class="nv">f-relative</span>
<span class="w">                           </span><span class="p">(</span><span class="nf">completing-read</span>
<span class="w">                            </span><span class="s">&quot;Insert image: &quot;</span>
<span class="w">                            </span><span class="p">(</span><span class="nv">dust/org-image--sort-completion-table</span><span class="w"> </span><span class="nv">images</span><span class="p">)</span>
<span class="w">                            </span><span class="no">nil</span><span class="w"> </span><span class="no">t</span><span class="p">)</span>
<span class="w">                           </span><span class="p">(</span><span class="nv">f-dirname</span><span class="w"> </span><span class="nv">cur-file</span><span class="p">)))))))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/org-insert-key-sequence</span><span class="w"> </span><span class="p">()</span>
<span class="w">      </span><span class="s">&quot;Insert key sequnce&quot;</span>
<span class="w">      </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="nf">insert</span><span class="w"> </span><span class="p">(</span><span class="nf">key-description</span>
<span class="w">               </span><span class="p">(</span><span class="nf">read-key-sequence-vector</span><span class="w"> </span><span class="s">&quot;Pressing... &quot;</span><span class="p">))))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:bind-into</span><span class="w"> </span><span class="nv">org-mode-map</span>
<span class="w">      </span><span class="s">&quot;C-c C-i&quot;</span><span class="w"> </span><span class="nv">dust/org-insert-uri</span>
<span class="w">      </span><span class="s">&quot;C-c C-m&quot;</span><span class="w"> </span><span class="nv">dust/org-insert-image</span>
<span class="w">      </span><span class="s">&quot;C-c M-k&quot;</span><span class="w"> </span><span class="nv">dust/org-insert-key-sequence</span><span class="p">)))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org47e1205" class="outline-3">
<h3 id="org47e1205">Org Agenda</h3>
<div class="outline-text-3" id="text-org47e1205">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">org-agenda</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Org Agenda settings&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:modalka</span><span class="w"> </span><span class="s">&quot;C-\\&quot;</span><span class="w"> </span><span class="nv">org-cycle-agenda-files</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:after</span><span class="w"> </span><span class="nv">org-agenda</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">org-agenda-tags-column</span><span class="w"> </span><span class="nv">0</span>
<span class="w">             </span><span class="nv">org-agenda-use-time-grid</span><span class="w"> </span><span class="nv">t</span>
<span class="w">             </span><span class="nv">org-agenda-time-grid</span><span class="w"> </span><span class="o">&#39;</span><span class="p">((</span><span class="nv">daily</span><span class="w"> </span><span class="nv">today</span><span class="w"> </span><span class="nv">require-timed</span><span class="p">)</span>
<span class="w">                                    </span><span class="p">(</span><span class="mi">700</span><span class="w"> </span><span class="mi">1200</span><span class="w"> </span><span class="mi">1800</span><span class="w"> </span><span class="mi">2300</span><span class="p">)</span>
<span class="w">                                    </span><span class="s">&quot;......&quot;</span>
<span class="w">                                    </span><span class="s">&quot;----------------&quot;</span><span class="p">)</span>
<span class="w">             </span><span class="nv">org-agenda-start-with-follow-mode</span><span class="w"> </span><span class="nv">t</span>
<span class="w">             </span><span class="nv">org-agenda-skip-scheduled-if-done</span><span class="w"> </span><span class="no">t</span><span class="p">)))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org53b1abf" class="outline-3">
<h3 id="org53b1abf">样式美化</h3>
<div class="outline-text-3" id="text-org53b1abf">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">org-modern</span><span class="w"> </span><span class="s">&quot;https://github.com/minad/org-modern&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;A modern style for Org buffers&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">global-org-modern-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">org-hide-emphasis-markers</span><span class="w"> </span><span class="nv">t</span>
<span class="w">           </span><span class="nv">org-modern-list</span><span class="w"> </span><span class="o">&#39;</span><span class="p">((</span><span class="sc">?+</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">&quot;◦&quot;</span><span class="p">)</span>
<span class="w">                             </span><span class="p">(</span><span class="sc">?-</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">&quot;•&quot;</span><span class="p">)</span>
<span class="w">                             </span><span class="p">(</span><span class="sc">?*</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">&quot;•&quot;</span><span class="p">))</span>
<span class="w">           </span><span class="nv">org-modern-checkbox</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">           </span><span class="nv">org-modern-todo-faces</span>
<span class="w">           </span><span class="o">`</span><span class="p">((</span><span class="s">&quot;TODO&quot;</span><span class="w">  </span><span class="nb">:background</span><span class="w"> </span><span class="s">&quot;red3&quot;</span><span class="w"> </span><span class="nb">:foreground</span><span class="w"> </span><span class="s">&quot;white&quot;</span><span class="w"> </span><span class="nb">:weight</span><span class="w"> </span><span class="nv">bold</span><span class="p">)</span>
<span class="w">             </span><span class="p">(</span><span class="s">&quot;DOING&quot;</span><span class="w"> </span><span class="nb">:background</span><span class="w"> </span><span class="s">&quot;SteelBlue&quot;</span><span class="w"> </span><span class="nb">:foreground</span><span class="w"> </span><span class="s">&quot;white&quot;</span><span class="w"> </span><span class="nb">:weight</span><span class="w"> </span><span class="nv">bold</span><span class="p">)</span>
<span class="w">             </span><span class="p">(</span><span class="s">&quot;WAIT&quot;</span><span class="w"> </span><span class="nb">:background</span><span class="w"> </span><span class="s">&quot;orange&quot;</span><span class="w"> </span><span class="nb">:foreground</span><span class="w"> </span><span class="s">&quot;white&quot;</span><span class="w"> </span><span class="nb">:weight</span><span class="w"> </span><span class="nv">bold</span><span class="p">)</span>
<span class="w">             </span><span class="p">(</span><span class="s">&quot;DONE&quot;</span><span class="w"> </span><span class="nb">:background</span><span class="w"> </span><span class="s">&quot;SeaGreen4&quot;</span><span class="w"> </span><span class="nb">:foreground</span><span class="w"> </span><span class="s">&quot;white&quot;</span><span class="w"> </span><span class="nb">:weight</span><span class="w"> </span><span class="nv">bold</span><span class="p">)</span>
<span class="w">             </span><span class="p">(</span><span class="s">&quot;CANCELED&quot;</span>
<span class="w">              </span><span class="nb">:foreground</span><span class="w"> </span><span class="o">,</span><span class="p">(</span><span class="nv">face-attribute</span><span class="w"> </span><span class="ss">&#39;fringe</span><span class="w"> </span><span class="nb">:foreground</span><span class="p">)</span>
<span class="w">              </span><span class="nb">:weight</span><span class="w"> </span><span class="nv">bold</span>
<span class="w">              </span><span class="nb">:strike-through</span><span class="w"> </span><span class="o">,</span><span class="p">(</span><span class="nv">face-attribute</span><span class="w"> </span><span class="ss">&#39;fringe</span><span class="w"> </span><span class="nb">:foreground</span><span class="p">))))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:with-mode</span><span class="w"> </span><span class="nv">global-org-modern-mode</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">org-mode</span><span class="p">)))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-orgb7290b0" class="outline-3">
<h3 id="orgb7290b0">排版</h3>
<div class="outline-text-3" id="text-orgb7290b0">
<p>
采用左右两侧留白，页面集中到中部的排版。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">olivetti</span><span class="w"> </span><span class="s">&quot;https://github.com/rnkn/olivetti&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;A simple Emacs minor mode for a nice writing environment.&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:diminish</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">olivetti-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">olivetti-body-width</span><span class="w"> </span><span class="mi">120</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">org-mode</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-orgf746616" class="outline-3">
<h3 id="orgf746616">Latex 导出</h3>
<div class="outline-text-3" id="text-orgf746616">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">org-latex</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Org Latex Environment&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:after</span><span class="w"> </span><span class="nv">org</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">org-latex-listings</span><span class="w"> </span><span class="nv">t</span>
<span class="w">             </span><span class="nv">org-latex-pdf-process</span>
<span class="w">             </span><span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;xelatex -interaction nonstopmode -output-directory %o %f&quot;</span>
<span class="w">               </span><span class="s">&quot;xelatex -interaction nonstopmode -output-directory %o %f&quot;</span>
<span class="w">               </span><span class="s">&quot;xelatex -interaction nonstopmode -output-directory %o %f&quot;</span><span class="p">)</span>
<span class="w">             </span><span class="nv">org-latex-compiler</span><span class="w"> </span><span class="s">&quot;xelatex&quot;</span>
<span class="w">             </span><span class="p">(</span><span class="nf">append</span><span class="w"> </span><span class="nv">org-latex-packages-alist</span><span class="p">)</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="s">&quot;xeCJK&quot;</span><span class="p">))</span>
<span class="w">    </span><span class="c1">;; Beamer</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">org-beamer-frame-level</span><span class="w"> </span><span class="nv">2</span>
<span class="w">             </span><span class="nv">org-beamer-outline-frame-title</span><span class="w"> </span><span class="s">&quot;Content&quot;</span><span class="p">)))</span>
 </pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgad64202" class="outline-2">
<h2 id="orgad64202">工具</h2>
<div class="outline-text-2" id="text-orgad64202">
</div>
<div id="outline-container-org0856ec3" class="outline-3">
<h3 id="org0856ec3">输入法</h3>
<div class="outline-text-3" id="text-org0856ec3">
<p>
Emacs 的 RIME 输入法，只要断言做得好，就可以丝滑地在中英文输入法之间切换，且不会影响快捷键的使用。
</p>

<p>
在激活了 emacs-rime 后退出 emacs 会进入一段时间的卡死状态，在 Issue <a href="https://github.com/DogLooksGood/emacs-rime/issues/161#issuecomment-979907791" target="_blank">#161</a> 中给出了一个方案，就是在 emacs 关闭时主动关闭 rime-lib. 这个函数是从 so 库里面都出来的，我找不到哪里可以 with-eval-after-load. 所以我用了一个 trick, 在激活输入法后给 <code>kill-emacs-hook</code> 加上 <code>rime-lib-finalize</code>.
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">rime</span><span class="w"> </span><span class="s">&quot;https://github.com/DogLooksGood/emacs-rime&quot;</span>
<span class="w">             </span><span class="nv">posframe</span><span class="w"> </span><span class="s">&quot;https://github.com/tumashu/posframe&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;RIME input method in Emacs&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:lazy</span><span class="w"> </span><span class="nv">rime</span><span class="w"> </span><span class="p">(</span><span class="nv">toggle-input-method</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:require</span><span class="w"> </span><span class="nv">rime</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">default-input-method</span><span class="w"> </span><span class="s">&quot;rime&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">my-predicate-punctuation-after-space-cc-p</span><span class="w"> </span><span class="p">()</span>
<span class="w">      </span><span class="p">(</span><span class="k">let*</span><span class="w"> </span><span class="p">((</span><span class="nv">start</span><span class="w"> </span><span class="p">(</span><span class="k">save-excursion</span>
<span class="w">                      </span><span class="p">(</span><span class="nf">re-search-backward</span>
<span class="w">                       </span><span class="s">&quot;[^\s]&quot;</span>
<span class="w">                       </span><span class="nv">nil</span>
<span class="w">                       </span><span class="no">t</span><span class="p">)))</span>
<span class="w">             </span><span class="p">(</span><span class="nf">string</span><span class="w"> </span><span class="p">(</span><span class="nf">buffer-substring</span>
<span class="w">                      </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="nv">start</span><span class="w"> </span><span class="nv">start</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">                      </span><span class="p">(</span><span class="nf">point</span><span class="p">))))</span>
<span class="w">        </span><span class="p">(</span><span class="nf">string-match</span><span class="w"> </span><span class="s">&quot;\\cc +&quot;</span><span class="w"> </span><span class="nf">string</span><span class="p">)))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">rime-inline-ascii-trigger</span><span class="w"> </span><span class="ss">&#39;shift-l</span>
<span class="w">             </span><span class="nv">rime-show-preedit</span><span class="w"> </span><span class="ss">&#39;inline</span>
<span class="w">             </span><span class="nv">rime-show-candidate</span><span class="w"> </span><span class="ss">&#39;posframe</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">rime-disable-predicates</span>
<span class="w">             </span><span class="o">&#39;</span><span class="p">(</span><span class="nv">rime-predicate-prog-in-code-p</span>
<span class="w">               </span><span class="nv">my-predicate-punctuation-after-space-cc-p</span>
<span class="w">               </span><span class="nv">rime-predicate-after-alphabet-char-p</span>
<span class="w">               </span><span class="nv">rime-predicate-org-in-src-block-p</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:with-hook</span><span class="w"> </span><span class="nv">input-method-activate-hook</span>
<span class="w">      </span><span class="p">(</span><span class="nb">:hook</span><span class="w"> </span><span class="p">(</span><span class="nb">lambda</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="nv">add-hook</span><span class="w"> </span><span class="ss">&#39;kill-emacs-hook</span><span class="w"> </span><span class="nf">#&#39;</span><span class="nv">rime-lib-finalize</span><span class="p">)))))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:modalka</span><span class="w"> </span><span class="s">&quot;C-&amp;lt;SPC&amp;gt;&quot;</span><span class="w"> </span><span class="nv">setup-lazy-rime</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>
<div id="outline-container-org96e4bcc" class="outline-3">
<h3 id="org96e4bcc">文件管理</h3>
<div class="outline-text-3" id="text-org96e4bcc">
<p>
Dirvish 是一个非常优秀的文件管理器，优美的前端，集成 Dired, 它完全能够作为一个独立的基于命令行的文件管理器使用（我确实也是把它作为系统默认的文件管理器使用）
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">dirvish</span><span class="w"> </span><span class="s">&quot;https://github.com/alexluigit/dirvish&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;An improved version of the Emacs inbuilt package Dired&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:lazy</span><span class="w"> </span><span class="nv">dirvish</span><span class="w"> </span><span class="p">(</span><span class="nv">dirvish</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:require</span><span class="w"> </span><span class="nv">dirvish</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:load-path</span><span class="w"> </span><span class="s">&quot;extensions&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:also-load</span><span class="w"> </span><span class="nv">dirvish-icons</span>
<span class="w">                </span><span class="nv">dirvish-emerge</span>
<span class="w">                </span><span class="nv">dirvish-quick-access</span>
<span class="w">                </span><span class="nv">dirvish-subtree</span>
<span class="w">                </span><span class="nv">subr-xc</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">dirvish-quick-access-entries</span>
<span class="w">             </span><span class="o">&#39;</span><span class="p">((</span><span class="s">&quot;h&quot;</span><span class="w"> </span><span class="s">&quot;~/&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="p">(</span><span class="s">&quot;e&quot;</span><span class="w"> </span><span class="s">&quot;~/.emacs.d/&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="p">(</span><span class="s">&quot;g&quot;</span><span class="w"> </span><span class="s">&quot;~/gh-repo/&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="p">(</span><span class="s">&quot;n&quot;</span><span class="w"> </span><span class="s">&quot;~/Note/&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="p">(</span><span class="s">&quot;G&quot;</span><span class="w"> </span><span class="s">&quot;~/.emacs.d/etc/gnus/&quot;</span><span class="p">)))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">dirvish-preview-dispatchers</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="nv">image</span><span class="w"> </span><span class="nv">gif</span><span class="w"> </span><span class="nv">audio</span><span class="w"> </span><span class="nv">archive</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nv">dirvish-define-preview</span><span class="w"> </span><span class="nv">exa</span><span class="w"> </span><span class="p">(</span><span class="nv">file</span><span class="p">)</span>
<span class="w">      </span><span class="s">&quot;Use </span><span class="ss">`exa&#39;</span><span class="s"> to generate directory preview.&quot;</span>
<span class="w">      </span><span class="nb">:require</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;exa&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">; tell Dirvish to check if we have the executable</span>
<span class="w">      </span><span class="p">(</span><span class="nb">when</span><span class="w"> </span><span class="p">(</span><span class="nf">file-directory-p</span><span class="w"> </span><span class="nv">file</span><span class="p">)</span><span class="w"> </span><span class="c1">; we only interest in directories here</span>
<span class="w">        </span><span class="o">`</span><span class="p">(</span><span class="nv">shell</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;exa&quot;</span><span class="w"> </span><span class="s">&quot;-al&quot;</span><span class="w"> </span><span class="s">&quot;--color=always&quot;</span><span class="w"> </span><span class="s">&quot;--icons&quot;</span>
<span class="w">                   </span><span class="s">&quot;--group-directories-first&quot;</span><span class="w"> </span><span class="o">,</span><span class="nv">file</span><span class="p">))))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="p">(</span><span class="nf">append</span><span class="w"> </span><span class="nv">dirvish-preview-dispatchers</span><span class="p">)</span><span class="w"> </span><span class="ss">&#39;exa</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/dirvish--truncate-line</span><span class="w"> </span><span class="p">(</span><span class="nv">&amp;amp</span><span class="c1">;rest _)</span>
<span class="w">      </span><span class="p">(</span><span class="nb">setq-local</span><span class="w"> </span><span class="nv">truncate-lines</span><span class="w"> </span><span class="no">t</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nv">dirvish-emerge-define-predicate</span><span class="w"> </span><span class="nv">is-dir</span>
<span class="w">      </span><span class="s">&quot;If item is a directory&quot;</span>
<span class="w">      </span><span class="p">(</span><span class="nf">equal</span><span class="w"> </span><span class="p">(</span><span class="nf">car</span><span class="w"> </span><span class="nv">type</span><span class="p">)</span><span class="w"> </span><span class="ss">&#39;dir</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">dirvish-use-header-line</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">             </span><span class="nv">dirvish-attributes</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="nv">subtree-state</span><span class="w"> </span><span class="nv">all-the-icons</span><span class="w"> </span><span class="nv">file-size</span><span class="p">)</span>
<span class="w">             </span><span class="nv">delete-by-moving-to-trash</span><span class="w"> </span><span class="nv">t</span>
<span class="w">             </span><span class="nv">dirvish-mode-line-height</span><span class="w"> </span><span class="nv">21</span>
<span class="w">             </span><span class="nv">dired-listing-switches</span>
<span class="w">             </span><span class="s">&quot;-l --almost-all --human-readable --group-directories-first --no-group --time-style=iso&quot;</span>
<span class="w">             </span><span class="nv">dirvish-emerge-groups</span>
<span class="w">             </span><span class="o">&#39;</span><span class="p">((</span><span class="s">&quot;Hidden&quot;</span><span class="w"> </span><span class="p">(</span><span class="nv">regex</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">&quot;^\\.&quot;</span><span class="p">))</span>
<span class="w">               </span><span class="p">(</span><span class="s">&quot;Directory&quot;</span><span class="w"> </span><span class="p">(</span><span class="nv">predicate</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">is-dir</span><span class="p">))</span>
<span class="w">               </span><span class="p">(</span><span class="s">&quot;Documents&quot;</span><span class="w"> </span><span class="p">(</span><span class="nv">extensions</span><span class="w"> </span><span class="s">&quot;pdf&quot;</span><span class="w"> </span><span class="s">&quot;tex&quot;</span><span class="w"> </span><span class="s">&quot;bib&quot;</span><span class="w"> </span><span class="s">&quot;epub&quot;</span><span class="p">))</span>
<span class="w">               </span><span class="p">(</span><span class="s">&quot;Video&quot;</span><span class="w"> </span><span class="p">(</span><span class="nv">extensions</span><span class="w"> </span><span class="s">&quot;mp4&quot;</span><span class="w"> </span><span class="s">&quot;mkv&quot;</span><span class="w"> </span><span class="s">&quot;webm&quot;</span><span class="p">))</span>
<span class="w">               </span><span class="p">(</span><span class="s">&quot;Picture&quot;</span><span class="w"> </span><span class="p">(</span><span class="nv">extensions</span><span class="w"> </span><span class="s">&quot;jpg&quot;</span><span class="w"> </span><span class="s">&quot;png&quot;</span><span class="w"> </span><span class="s">&quot;svg&quot;</span><span class="w"> </span><span class="s">&quot;gif&quot;</span><span class="p">))</span>
<span class="w">               </span><span class="p">(</span><span class="s">&quot;Audio&quot;</span><span class="w"> </span><span class="p">(</span><span class="nv">extensions</span><span class="w"> </span><span class="s">&quot;mp3&quot;</span><span class="w"> </span><span class="s">&quot;flac&quot;</span><span class="w"> </span><span class="s">&quot;wav&quot;</span><span class="w"> </span><span class="s">&quot;ape&quot;</span><span class="w"> </span><span class="s">&quot;aac&quot;</span><span class="p">))</span>
<span class="w">               </span><span class="p">(</span><span class="s">&quot;Archive&quot;</span><span class="w"> </span><span class="p">(</span><span class="nv">extensions</span><span class="w"> </span><span class="s">&quot;gz&quot;</span><span class="w"> </span><span class="s">&quot;rar&quot;</span><span class="w"> </span><span class="s">&quot;zip&quot;</span><span class="p">))</span>
<span class="w">               </span><span class="p">(</span><span class="s">&quot;Org&quot;</span><span class="w"> </span><span class="p">(</span><span class="nv">extensions</span><span class="w"> </span><span class="s">&quot;org&quot;</span><span class="p">))</span>
<span class="w">               </span><span class="p">(</span><span class="s">&quot;Emacs Lisp&quot;</span><span class="w"> </span><span class="p">(</span><span class="nv">extensions</span><span class="w"> </span><span class="s">&quot;el&quot;</span><span class="p">))</span>
<span class="w">               </span><span class="p">(</span><span class="s">&quot;Python&quot;</span><span class="w"> </span><span class="p">(</span><span class="nv">extensions</span><span class="w"> </span><span class="s">&quot;py&quot;</span><span class="p">))</span>
<span class="w">               </span><span class="p">(</span><span class="s">&quot;Files&quot;</span><span class="w"> </span><span class="p">(</span><span class="nv">regex</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">&quot;.*&quot;</span><span class="p">))))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">dirvish-override-dired-mode</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:with-hook</span><span class="w"> </span><span class="nv">dirvish-find-entry-hook</span>
<span class="w">      </span><span class="p">(</span><span class="nb">:hook</span><span class="w"> </span><span class="nv">dust/dirvish--truncate-line</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:with-mode</span><span class="w"> </span><span class="nv">dirvish-emerge-mode</span>
<span class="w">      </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">dirvish-setup</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:bind-into</span><span class="w"> </span><span class="nv">dirvish-mode-map</span>
<span class="w">      </span><span class="s">&quot;a&quot;</span><span class="w"> </span><span class="nv">dirvish-quick-access</span>
<span class="w">      </span><span class="s">&quot;j&quot;</span><span class="w"> </span><span class="nv">dired-next-line</span>
<span class="w">      </span><span class="s">&quot;k&quot;</span><span class="w"> </span><span class="nv">dired-previous-line</span>
<span class="w">      </span><span class="s">&quot;f&quot;</span><span class="w"> </span><span class="nv">dired-goto-file</span>
<span class="w">      </span><span class="s">&quot;b&quot;</span><span class="w"> </span><span class="nv">dired-up-directory</span>
<span class="w">      </span><span class="s">&quot;n&quot;</span><span class="w"> </span><span class="nv">dirvish-emerge-next-group</span>
<span class="w">      </span><span class="s">&quot;p&quot;</span><span class="w"> </span><span class="nv">dirvish-emerge-previous-group</span>
<span class="w">      </span><span class="s">&quot;TAB&quot;</span><span class="w"> </span><span class="nv">dirvish-subtree-toggle</span>
<span class="w">      </span><span class="s">&quot;M-t&quot;</span><span class="w"> </span><span class="nv">dirvish-layout-toggle</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:modalka</span><span class="w"> </span><span class="s">&quot;C-x C-d&quot;</span><span class="w"> </span><span class="nv">setup-lazy-dirvish</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>
<div id="outline-container-org5f5c84d" class="outline-3">
<h3 id="org5f5c84d">中文分词</h3>
<div class="outline-text-3" id="text-org5f5c84d">
<p>
基于中文分词的词语移动。Emacs 内置的 forward-word/backward-word 遇上中文会直接跑到句子结束。用了 jieba 分词就可以实现中文词语的 forward/backward.
</p>

<p>
目前只在 org mode 下开启，我对于中文分词的需求也来源于 org mode.
</p>

<p>
jieba.el 在每个 Emacs 应用打开都会启动一个 node-js 的服务器，我想把 jieba.el 作前后端分离，在我的系统中只跑一个，所有客户端都连接它即可。一来减少内存占用，二来加快启动，这样就可以全局下开启 jieba mode 而不需要考虑拖慢启动时间。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">jieba</span><span class="w"> </span><span class="s">&quot;https://github.com/cireu/jieba.el&quot;</span>
<span class="w">             </span><span class="nv">jsonrpc</span><span class="w"> </span><span class="s">&quot;https://github.com/paritytech/jsonrpc/&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Things about selection and deletion supporting CN words&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:lazy</span><span class="w"> </span><span class="nv">jieba</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:require</span><span class="w"> </span><span class="nv">jieba</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:diminish</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">defalias</span><span class="w"> </span><span class="ss">&#39;dust/forward-word</span><span class="w"> </span><span class="ss">&#39;jieba-forward-word</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">defalias</span><span class="w"> </span><span class="ss">&#39;dust/backward-word</span><span class="w"> </span><span class="ss">&#39;jieba-backward-word</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">defalias</span><span class="w"> </span><span class="ss">&#39;dust/select-word-at-point</span><span class="w"> </span><span class="ss">&#39;jieba-mark-word</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">jieba-mode</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:with-function</span><span class="w"> </span><span class="nv">setup-lazy-jieba</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">org-mode</span><span class="p">)))</span>
 </pre>
</div>
</div>
</div>
<div id="outline-container-org2c24b33" class="outline-3">
<h3 id="org2c24b33">大纲展示</h3>
<div class="outline-text-3" id="text-org2c24b33">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">imenu-list</span><span class="w"> </span><span class="s">&quot;https://github.com/bmag/imenu-list&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;A automatically updated buffer with imenu entries.&quot;</span><span class="p">)</span><span class="w">  </span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">imenu-list-smart-toggle</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:modalka</span><span class="w"> </span><span class="s">&quot;C-&#39;&quot;</span><span class="w"> </span><span class="nv">imenu-list-smart-toggle</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">imenu-list-focus-after-activation</span><span class="w"> </span><span class="nv">t</span>
<span class="w">           </span><span class="nv">imenu-list-position</span><span class="w"> </span><span class="ss">&#39;left</span>
<span class="w">           </span><span class="nv">imenu-list-size</span><span class="w"> </span><span class="mf">0.2</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/imenu-list--truncate-line</span><span class="w"> </span><span class="p">(</span><span class="nv">&amp;amp</span><span class="c1">;rest _)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">with-current-buffer</span><span class="w"> </span><span class="p">(</span><span class="nv">imenu-list-get-buffer-create</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="nb">setq-local</span><span class="w"> </span><span class="nv">truncate-lines</span><span class="w"> </span><span class="no">t</span><span class="p">)))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:after</span><span class="w"> </span><span class="nv">imenu-list</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:with-hook</span><span class="w"> </span><span class="nv">imenu-list-after-jump-hook</span>
<span class="w">      </span><span class="p">(</span><span class="nb">:hook</span><span class="w"> </span><span class="nv">recenter-top-bottom</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:with-hook</span><span class="w"> </span><span class="nv">imenu-list-update-hook</span>
<span class="w">      </span><span class="p">(</span><span class="nb">:hook</span><span class="w"> </span><span class="nv">dust/imenu-list--truncate-line</span><span class="p">))))</span>
 </pre>
</div>
</div>
</div>
<div id="outline-container-orgd54467f" class="outline-3">
<h3 id="orgd54467f">摘抄库</h3>
<div class="outline-text-3" id="text-orgd54467f">
<p>
自己写的一个摘抄管理，用 sqlite 数据库。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">excerpt</span><span class="w"> </span><span class="s">&quot;https://github.com/fingerknight/excerpt.el&quot;</span>
<span class="w">             </span><span class="nv">emacsql</span><span class="w"> </span><span class="s">&quot;https://github.com/magit/emacsql&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Excerpt management&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">excerpt</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">excerpt-dir</span><span class="w"> </span><span class="p">(</span><span class="nv">no-littering-expand-var-file-name</span><span class="w"> </span><span class="s">&quot;excerpt&quot;</span><span class="p">)))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org0a64e63" class="outline-3">
<h3 id="org0a64e63">记忆工具</h3>
<div class="outline-text-3" id="text-org0a64e63">
<p>
卡片记忆方法，虽然并不是很卡片。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">org-drill</span><span class="w"> </span><span class="s">&quot;https://github.com/louietan/org-drill&quot;</span>
<span class="w">             </span><span class="nv">persist</span><span class="w"> </span><span class="s">&quot;https://github.com/emacs-straight/persist&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;An Spaced Repetition System&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">org-drill</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">drill-directory</span><span class="w"> </span><span class="s">&quot;~/Drill/&quot;</span>
<span class="w">           </span><span class="nv">org-drill-maximum-items-per-session</span><span class="w"> </span><span class="nv">40</span>
<span class="w">           </span><span class="nv">org-drill-maximum-duration</span><span class="w"> </span><span class="mi">30</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/drill</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="s">&quot;Start to drill.&quot;</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">setq</span><span class="w"> </span><span class="nv">org-drill-scope</span>
<span class="w">          </span><span class="p">(</span><span class="nv">f-files</span><span class="w"> </span><span class="p">(</span><span class="nv">f-expand</span><span class="w"> </span><span class="p">(</span><span class="nf">completing-read</span>
<span class="w">                              </span><span class="s">&quot;What to drill: &quot;</span>
<span class="w">                              </span><span class="p">(</span><span class="nv">-map</span><span class="w"> </span><span class="nf">#&#39;</span><span class="nv">f-base</span><span class="w">                </span>
<span class="w">                                    </span><span class="p">(</span><span class="nv">f-directories</span><span class="w"> </span><span class="nv">drill-directory</span><span class="p">))</span>
<span class="w">                              </span><span class="no">nil</span><span class="w"> </span><span class="no">t</span><span class="p">)</span>
<span class="w">                             </span><span class="nv">drill-directory</span><span class="p">)))</span>
<span class="w">    </span><span class="p">(</span><span class="nv">org-drill</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defalias</span><span class="w"> </span><span class="ss">&#39;destructuring-bind</span><span class="w"> </span><span class="ss">&#39;cl-destructuring-bind</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org40caf26" class="outline-3">
<h3 id="org40caf26">音乐播放器</h3>
<div class="outline-text-3" id="text-org40caf26">
<p>
MPD 的前端，其实还是用的 MPC, 所以它是 MPD 前端的前端。简单但够用。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">simple-mpc</span><span class="w"> </span><span class="s">&quot;https://github.com/jorenvo/simple-mpc&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;A GNU Emacs major mode that acts as a front end to mpc.&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">simple-mpc</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">simple-mpc-arguments</span><span class="w"> </span><span class="s">&quot;--host=/tmp/mpd-socket&quot;</span>
<span class="w">           </span><span class="nv">simple-mpc-playlist-format</span><span class="w"> </span><span class="s">&quot;%title%\t%artist%\t%time%&quot;</span>
<span class="w">           </span><span class="nv">simple-mpc-table-separator</span><span class="w"> </span><span class="s">&quot;\t&quot;</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org9f9850f" class="outline-3">
<h3 id="org9f9850f">邮件和订阅</h3>
<div class="outline-text-3" id="text-org9f9850f">
<p>
详见
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">mu4e</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;a tool for dealing with e-mail messages stored in the Maildir-format&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:load-path</span><span class="w"> </span><span class="s">&quot;/usr/share/emacs/site-lisp/mu4e/&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">mu4e</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:after</span><span class="w"> </span><span class="nv">mu4e</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="p">(</span><span class="nf">append</span><span class="w"> </span><span class="nv">mu4e-contexts</span><span class="p">)</span>
<span class="w">             </span><span class="p">(</span><span class="k">let*</span><span class="w"> </span><span class="p">((</span><span class="nv">context-name</span><span class="w"> </span><span class="s">&quot;outlook&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">(</span><span class="nv">dir-name</span><span class="w"> </span><span class="p">(</span><span class="nf">concat</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="w"> </span><span class="nv">context-name</span><span class="p">)))</span>
<span class="w">               </span><span class="p">(</span><span class="nv">make-mu4e-context</span>
<span class="w">                </span><span class="nb">:name</span><span class="w"> </span><span class="nv">context-name</span>
<span class="w">                </span><span class="nb">:match-func</span>
<span class="w">                </span><span class="o">`</span><span class="p">(</span><span class="nb">lambda</span><span class="w"> </span><span class="p">(</span><span class="nv">msg</span><span class="p">)</span>
<span class="w">                   </span><span class="p">(</span><span class="nb">when</span><span class="w"> </span><span class="nv">msg</span>
<span class="w">                     </span><span class="p">(</span><span class="nv">string-match-p</span>
<span class="w">                      </span><span class="o">,</span><span class="p">(</span><span class="nf">concat</span><span class="w"> </span><span class="s">&quot;^&quot;</span><span class="w"> </span><span class="nv">dir-name</span><span class="p">)</span>
<span class="w">                      </span><span class="p">(</span><span class="nv">mu4e-message-field</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="nb">:maildir</span><span class="p">))))</span>
<span class="w">                </span><span class="nb">:vars</span>
<span class="w">                </span><span class="o">`</span><span class="p">((</span><span class="nv">user-mail-address</span><span class="w">    </span><span class="o">.</span><span class="w"> </span><span class="s">&quot;mrdust1880@outlook.com&quot;</span><span class="p">)</span>
<span class="w">                  </span><span class="p">(</span><span class="nf">user-full-name</span><span class="w">       </span><span class="o">.</span><span class="w"> </span><span class="s">&quot;Mr.Dust&quot;</span><span class="p">)</span>
<span class="w">                  </span><span class="p">(</span><span class="nv">mu4e-sent-folder</span><span class="w">     </span><span class="o">.</span><span class="w"> </span><span class="o">,</span><span class="p">(</span><span class="nf">concat</span><span class="w"> </span><span class="nv">dir-name</span><span class="w"> </span><span class="s">&quot;/Sent&quot;</span><span class="p">))</span>
<span class="w">                  </span><span class="p">(</span><span class="nv">mu4e-drafts-folder</span><span class="w">   </span><span class="o">.</span><span class="w"> </span><span class="o">,</span><span class="p">(</span><span class="nf">concat</span><span class="w"> </span><span class="nv">dir-name</span><span class="w"> </span><span class="s">&quot;/Drafts&quot;</span><span class="p">))</span>
<span class="w">                  </span><span class="p">(</span><span class="nv">mu4e-trash-folder</span><span class="w">    </span><span class="o">.</span><span class="w"> </span><span class="o">,</span><span class="p">(</span><span class="nf">concat</span><span class="w"> </span><span class="nv">dir-name</span><span class="w"> </span><span class="s">&quot;/Deleted&quot;</span><span class="p">))</span>
<span class="w">                  </span><span class="p">(</span><span class="nv">mu4e-refile-folder</span><span class="w">   </span><span class="o">.</span><span class="w"> </span><span class="o">,</span><span class="p">(</span><span class="nf">concat</span><span class="w"> </span><span class="nv">dir-name</span><span class="w"> </span><span class="s">&quot;/存档&quot;</span><span class="p">))</span>
<span class="w">                  </span><span class="p">(</span><span class="nv">mu4e-compose-signature</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">&quot;Dare to know.&quot;</span><span class="p">))))</span>
<span class="w">             </span><span class="nv">mu4e-change-filenames-when-moving</span><span class="w"> </span><span class="nv">t</span>
<span class="w">             </span><span class="nv">mu4e-get-mail-command</span><span class="w"> </span><span class="s">&quot;update-mail&quot;</span>
<span class="w">             </span><span class="nv">gnus-blocked-images</span><span class="w"> </span><span class="no">nil</span><span class="p">)))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-orgdd8e7bf" class="outline-3">
<h3 id="orgdd8e7bf">日志</h3>
<div class="outline-text-3" id="text-orgdd8e7bf">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">org-journal</span><span class="w"> </span><span class="s">&quot;https://github.com/bastibe/org-journal&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;A simple personal diary / journal using in Emacs.&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">org-journal-new-entry</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">org-journal-file-header-func</span><span class="w"> </span><span class="p">(</span><span class="nv">time</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;Custom function to create journal header.&quot;</span>
<span class="w">    </span><span class="p">(</span><span class="nf">concat</span><span class="w"> </span><span class="s">&quot;#+title: Daily Journal\n&quot;</span>
<span class="w">            </span><span class="s">&quot;#+startup: overview\n\n&quot;</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">org-journal-find-location</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="c1">;; Open today&#39;s journal, but specify a non-nil prefix argument in order to</span>
<span class="w">    </span><span class="c1">;; inhibit inserting the heading; org-capture will insert the heading.</span>
<span class="w">    </span><span class="p">(</span><span class="nv">org-journal-new-entry</span><span class="w"> </span><span class="no">t</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">goto-char</span><span class="w"> </span><span class="p">(</span><span class="nf">point-max</span><span class="p">)))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:after</span><span class="w"> </span><span class="nv">org-journal</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;https://github.com/bastibe/org-journal/issues/369&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">defconst</span><span class="w"> </span><span class="nv">org-journal--cache-file</span>
<span class="w">      </span><span class="p">(</span><span class="nv">no-littering-expand-var-file-name</span><span class="w"> </span><span class="s">&quot;org-journal.cache&quot;</span><span class="p">)))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">org-journal-dir</span><span class="w"> </span><span class="s">&quot;~/Journal&quot;</span>
<span class="w">           </span><span class="nv">org-journal-find-file</span><span class="w"> </span><span class="ss">&#39;find-file</span>
<span class="w">           </span><span class="nv">org-journal-date-format</span><span class="w"> </span><span class="s">&quot;%Y-%m-%d, %a&quot;</span>
<span class="w">           </span><span class="nv">org-journal-carryover-items</span>
<span class="w">           </span><span class="s">&quot;TODO=\&quot;TODO\&quot;|TODO=\&quot;DOING\&quot;|TODO=\&quot;WAIT\&quot;&quot;</span>
<span class="w">           </span><span class="nv">org-journal-file-type</span><span class="w"> </span><span class="ss">&#39;daily</span>
<span class="w">           </span><span class="nv">org-journal-file-header</span><span class="w"> </span><span class="ss">&#39;org-journal-file-header-func</span>
<span class="w">           </span><span class="nv">org-journal-enable-cache</span><span class="w"> </span><span class="nv">t</span>
<span class="w">           </span><span class="nv">org-journal-file-format</span><span class="w"> </span><span class="s">&quot;%Y%m%d.org&quot;</span>
<span class="w">           </span><span class="nv">org-journal-hide-entries-p</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">           </span><span class="nv">org-journal-enable-agenda-integration</span><span class="w"> </span><span class="no">t</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">dust/org-journal-new-journal</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nv">org-journal-new-entry</span><span class="w"> </span><span class="no">t</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:modalka</span><span class="w"> </span><span class="s">&quot;C-c C-j&quot;</span><span class="w"> </span><span class="nv">dust/org-journal-new-journal</span><span class="p">))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org3c3706f" class="outline-3">
<h3 id="org3c3706f">番茄闹钟</h3>
<div class="outline-text-3" id="text-org3c3706f">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">org-pomodoro</span><span class="w"> </span><span class="s">&quot;https://github.com/marcinkoziej/org-pomodoro&quot;</span>
<span class="w">             </span><span class="nv">alert</span><span class="w"> </span><span class="s">&quot;https://github.com/jwiegley/alert&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Basic support for Pomodoro technique in Org Mode.&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">org-pomodoro</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">org-pomodoro-start-sound-p</span><span class="w"> </span><span class="nv">t</span>
<span class="w">           </span><span class="nv">org-pomodoro-length</span><span class="w"> </span><span class="nv">25</span>
<span class="w">           </span><span class="nv">org-pomodoro-short-break-length</span><span class="w"> </span><span class="nv">5</span>
<span class="w">           </span><span class="nv">org-pomodoro-long-break-length</span><span class="w"> </span><span class="mi">30</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:bind-into</span><span class="w"> </span><span class="nv">org-agenda-mode-map</span><span class="w"> </span><span class="s">&quot;G&quot;</span><span class="w"> </span><span class="nv">org-pomodoro</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:with-hook</span><span class="w"> </span><span class="nv">org-pomodoro-long-break-finished-hook</span>
<span class="w">    </span><span class="p">(</span><span class="nb">lambda</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="k">setq</span><span class="w"> </span><span class="nv">org-pomodoro-count</span><span class="w"> </span><span class="mi">0</span><span class="p">))))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org2babb8b" class="outline-3">
<h3 id="org2babb8b">笔记管理</h3>
<div class="outline-text-3" id="text-org2babb8b">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="p">(</span><span class="nb">:git</span><span class="w"> </span><span class="nv">denote</span><span class="w"> </span><span class="s">&quot;https://github.com/protesilaos/denote&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;A simple note-taking tool for Emacs&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">denote</span><span class="w"> </span><span class="nv">denote-dired-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">denote-template</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="s">&quot;Create note while prompting for a subdirectory.</span>
<span class="nv">Available</span><span class="w"> </span><span class="nv">candidates</span><span class="w"> </span><span class="nv">include</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">value</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">variable</span>
<span class="o">`</span><span class="nv">denote-directory</span><span class="o">&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nv">any</span><span class="w"> </span><span class="nv">subdirectory</span><span class="w"> </span><span class="nv">thereof.</span>
<span class="nv">This</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">equivalent</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">calling</span><span class="w"> </span><span class="o">`</span><span class="nv">denote</span><span class="o">&#39;</span><span class="w"> </span><span class="nb">when</span><span class="w"> </span><span class="o">`</span><span class="nv">denote-prompts</span><span class="o">&#39;</span><span class="w"> </span><span class="nv">is</span>
<span class="nf">set</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="nv">subdirectory</span><span class="w"> </span><span class="nv">title</span><span class="w"> </span><span class="nv">keywords</span><span class="p">)</span><span class="o">.</span><span class="s">&quot;</span>
<span class="w">    </span><span class="p">(</span><span class="nb">declare</span><span class="w"> </span><span class="p">(</span><span class="nv">interactive-only</span><span class="w"> </span><span class="no">t</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nv">denote-prompts</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="nv">template</span><span class="w"> </span><span class="nv">subdirectory</span><span class="w"> </span><span class="nv">title</span><span class="w"> </span><span class="nv">keywords</span><span class="p">)))</span>
<span class="w">      </span><span class="p">(</span><span class="nf">call-interactively</span><span class="w"> </span><span class="nf">#&#39;</span><span class="nv">denote</span><span class="p">)))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span>
<span class="w">   </span><span class="nv">denote-directory</span><span class="w"> </span><span class="s">&quot;~/Note&quot;</span>
<span class="w">   </span><span class="nv">denote-date-format</span><span class="w"> </span><span class="s">&quot;&amp;lt;%Y-%m-%d %a&amp;gt;&quot;</span>
<span class="w">   </span><span class="nv">denote-infer-keywords</span><span class="w"> </span><span class="nv">t</span>
<span class="w">   </span><span class="nv">denote-sort-keywords</span><span class="w"> </span><span class="nv">t</span>
<span class="w">   </span><span class="nv">denote-file-type</span><span class="w"> </span><span class="ss">&#39;org</span>
<span class="w">   </span><span class="nv">denote-prompts</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="nv">subdirectory</span><span class="w"> </span><span class="nv">title</span><span class="w"> </span><span class="nv">keywords</span><span class="p">)</span>
<span class="w">   </span><span class="nv">denote-excluded-directories-regexp</span><span class="w"> </span><span class="s">&quot;^assets\\|^static&quot;</span>
<span class="w">   </span><span class="c1">;; Pick dates, where relevant, with Org&#39;s advanced interface:</span>
<span class="w">   </span><span class="nv">denote-date-prompt-use-org-read-date</span><span class="w"> </span><span class="nv">t</span>
<span class="w">   </span><span class="nv">denote-allow-multi-word-keywords</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">   </span><span class="nv">xref-search-program</span><span class="w"> </span><span class="ss">&#39;ripgrep</span>
<span class="w">   </span><span class="nv">denote-templates</span>
<span class="w">   </span><span class="o">`</span><span class="p">((</span><span class="nv">book</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="o">,</span><span class="p">(</span><span class="nf">concat</span><span class="w"> </span><span class="s">&quot;#+book_author: \n&quot;</span>
<span class="w">                      </span><span class="s">&quot;#+book_translator: \n&quot;</span>
<span class="w">                      </span><span class="s">&quot;#+book_publisher: \n&quot;</span>
<span class="w">                      </span><span class="s">&quot;#+book_publish_date: \n\n&quot;</span>
<span class="w">                      </span><span class="s">&quot;#+startup: overview\n\n&quot;</span>
<span class="w">                      </span><span class="s">&quot;* Outline\n&quot;</span>
<span class="w">                      </span><span class="s">&quot;:PROPERTIES:\n&quot;</span>
<span class="w">                      </span><span class="s">&quot;:VISIBILITY: all\n&quot;</span>
<span class="w">                      </span><span class="s">&quot;:END:\n\n&quot;</span>
<span class="w">                      </span><span class="s">&quot;* Conclusion\n&quot;</span>
<span class="w">                      </span><span class="s">&quot;:PROPERTIES:\n&quot;</span>
<span class="w">                      </span><span class="s">&quot;:VISIBILITY: all\n&quot;</span>
<span class="w">                      </span><span class="s">&quot;:END:\n\n&quot;</span>
<span class="w">                      </span><span class="s">&quot;* Excerpts\n&quot;</span>
<span class="w">                      </span><span class="s">&quot;:PROPERTIES:\n&quot;</span>
<span class="w">                      </span><span class="s">&quot;:VISIBILITY: children\n&quot;</span>
<span class="w">                      </span><span class="s">&quot;:END:\n&quot;</span><span class="p">))</span>
<span class="w">     </span><span class="p">(</span><span class="nv">blog</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="o">,</span><span class="p">(</span><span class="nf">concat</span><span class="w"> </span><span class="s">&quot;#+publish: nil\n\n&quot;</span><span class="p">))))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:after</span><span class="w"> </span><span class="nv">denote</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:face</span><span class="w"> </span><span class="nv">denote-faces-date</span>
<span class="w">      </span><span class="nb">:foreground</span><span class="w"> </span><span class="p">(</span><span class="nv">face-attribute</span><span class="w"> </span><span class="ss">&#39;font-lock-function-name-face</span><span class="w"> </span><span class="nb">:foreground</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:face</span><span class="w"> </span><span class="nv">denote-faces-delimiter</span>
<span class="w">      </span><span class="nb">:foreground</span><span class="w"> </span><span class="p">(</span><span class="nv">face-attribute</span><span class="w"> </span><span class="ss">&#39;font-lock-comment-face</span><span class="w"> </span><span class="nb">:foreground</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:face</span><span class="w"> </span><span class="nv">denote-faces-extension</span>
<span class="w">      </span><span class="nb">:foreground</span><span class="w"> </span><span class="p">(</span><span class="nv">face-attribute</span><span class="w"> </span><span class="ss">&#39;font-lock-comment-face</span><span class="w"> </span><span class="nb">:foreground</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:face</span><span class="w"> </span><span class="nv">denote-faces-keywords</span>
<span class="w">      </span><span class="nb">:foreground</span><span class="w"> </span><span class="p">(</span><span class="nv">face-attribute</span><span class="w"> </span><span class="ss">&#39;font-lock-keyword-face</span><span class="w"> </span><span class="nb">:foreground</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:face</span><span class="w"> </span><span class="nv">denote-faces-title</span>
<span class="w">      </span><span class="nb">:foreground</span><span class="w"> </span><span class="p">(</span><span class="nv">face-attribute</span><span class="w"> </span><span class="ss">&#39;font-lock-string-face</span><span class="w"> </span><span class="nb">:foreground</span><span class="p">)))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:with-mode</span><span class="w"> </span><span class="nv">denote-dired-mode</span>
<span class="w">    </span><span class="p">(</span><span class="nb">:hook-into</span><span class="w"> </span><span class="nv">dired-mode</span><span class="p">)))</span>
 </pre>
</div>
</div>
</div>

<div id="outline-container-org34dec69" class="outline-3">
<h3 id="org34dec69">博客生成</h3>
<div class="outline-text-3" id="text-org34dec69">
<p>
基于 <a href="https://github.com/bastibe/org-static-blog" target="_blank">org-static-blog</a> 写的自用的 publish 系统。
</p>

<div class="org-src-container">
<pre> <span class="p">(</span><span class="nv">setup</span><span class="w"> </span><span class="nv">org-blog</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:doc</span><span class="w"> </span><span class="s">&quot;Blog publishing system&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:load-path</span><span class="w"> </span><span class="s">&quot;~/gh-repo/org-blog&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:autoload</span><span class="w"> </span><span class="nv">org-blog-publish</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">org-blog-publish-directory</span><span class="w"> </span><span class="s">&quot;~/blog/&quot;</span>
<span class="w">           </span><span class="nv">org-blog-posts-directory</span><span class="w"> </span><span class="s">&quot;~/Note/&quot;</span>
<span class="w">           </span><span class="nv">org-blog-static-directory</span><span class="w"> </span><span class="s">&quot;~/Note/static/&quot;</span>
<span class="w">           </span><span class="nv">org-blog-assets-directory</span><span class="w"> </span><span class="s">&quot;~/Note/assets/&quot;</span>
<span class="w">           </span><span class="nv">org-blog-cache-file</span><span class="w"> </span><span class="p">(</span><span class="nv">no-littering-expand-var-file-name</span>
<span class="w">                                </span><span class="s">&quot;org-blog-cache.json&quot;</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">org-blog-meta-title</span><span class="w"> </span><span class="s">&quot;手指骑士的病房&quot;</span>
<span class="w">           </span><span class="nv">org-blog-meta-slogan</span><span class="w"> </span><span class="s">&quot;I choose to see the beauty.&quot;</span>
<span class="w">           </span><span class="nv">org-blog-meta-author</span><span class="w"> </span><span class="s">&quot;Finger Knight&quot;</span>
<span class="w">           </span><span class="nv">org-blog-index-length</span><span class="w"> </span><span class="nv">5</span>
<span class="w">           </span><span class="nv">org-blog-use-preview</span><span class="w"> </span><span class="nv">t</span>
<span class="w">           </span><span class="nv">org-blog-enable-tags</span><span class="w"> </span><span class="nv">t</span>
<span class="w">           </span><span class="nv">org-blog-use-pygmentize</span><span class="w"> </span><span class="nv">t</span>
<span class="w">           </span><span class="nv">org-export-with-sub-superscripts</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">           </span><span class="nv">org-export-with-toc</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">           </span><span class="nv">org-export-with-section-numbers</span><span class="w"> </span><span class="no">nil</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">org-blog-page-head-template</span>
<span class="w">           </span><span class="p">(</span><span class="nf">list</span><span class="w"> </span><span class="s">&quot;&amp;lt;link rel=\&quot;icon\&quot; href=\&quot;/static/favicon.ico\&quot;&amp;gt;&quot;</span>
<span class="w">                 </span><span class="s">&quot;&amp;lt;link href= \&quot;/static/style/style.css\&quot; rel=\&quot;stylesheet\&quot; type=\&quot;text/css\&quot; /&amp;gt;&quot;</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">org-blog-page-header-template</span>
<span class="w">           </span><span class="p">(</span><span class="nf">concat</span><span class="w"> </span><span class="s">&quot;&amp;lt;div class=\&quot;home-page\&quot;&amp;gt;\n&quot;</span>
<span class="w">                   </span><span class="p">(</span><span class="nf">format</span><span class="w"> </span><span class="s">&quot;&amp;lt;a href=\&quot;/\&quot;&amp;gt;%s&amp;lt;/a&amp;gt;&quot;</span><span class="w"> </span><span class="nv">org-blog-meta-title</span><span class="p">)</span>
<span class="w">                   </span><span class="s">&quot;&amp;lt;/div&amp;gt;&quot;</span>
<span class="w">                   </span><span class="s">&quot;&amp;lt;div class=\&quot;nav\&quot;&amp;gt;\n&quot;</span>
<span class="w">                   </span><span class="s">&quot;&amp;lt;div class=\&quot;nav item\&quot;&amp;gt;\n&quot;</span>
<span class="w">                   </span><span class="s">&quot;&amp;lt;a href=\&quot;/tags\&quot;&amp;gt;标签&amp;lt;/a&amp;gt;\n&quot;</span>
<span class="w">                   </span><span class="s">&quot;&amp;lt;/div&amp;gt;\n&quot;</span>
<span class="w">                   </span><span class="s">&quot;&amp;lt;div class=\&quot;nav item\&quot;&amp;gt;\n&quot;</span>
<span class="w">                   </span><span class="s">&quot;&amp;lt;a href=\&quot;/archive\&quot;&amp;gt;归档&amp;lt;/a&amp;gt;\n&quot;</span>
<span class="w">                   </span><span class="s">&quot;&amp;lt;/div&amp;gt;\n&quot;</span>
<span class="w">                   </span><span class="s">&quot;&amp;lt;div class=\&quot;nav item\&quot;&amp;gt;\n&quot;</span>
<span class="w">                   </span><span class="s">&quot;&amp;lt;a href=\&quot;/about\&quot;&amp;gt;关于&amp;lt;/a&amp;gt;\n&quot;</span>
<span class="w">                   </span><span class="s">&quot;&amp;lt;/div&amp;gt;\n&quot;</span>
<span class="w">                   </span><span class="s">&quot;&amp;lt;div class=\&quot;nav item\&quot;&amp;gt;\n&quot;</span>
<span class="w">                   </span><span class="s">&quot;&amp;lt;a href=\&quot;/emacs\&quot;&amp;gt;Emacs&amp;lt;/a&amp;gt;\n&quot;</span>
<span class="w">                   </span><span class="s">&quot;&amp;lt;/div&amp;gt;\n&quot;</span>
<span class="w">                   </span><span class="s">&quot;&amp;lt;/div&amp;gt;\n&quot;</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">:option</span><span class="w"> </span><span class="nv">org-blog-third-party</span>
<span class="w">           </span><span class="p">(</span><span class="nf">list</span>
<span class="w">            </span><span class="p">(</span><span class="nf">cons</span><span class="w"> </span><span class="ss">&#39;math</span>
<span class="w">                  </span><span class="p">(</span><span class="nf">cons</span>
<span class="w">                   </span><span class="s">&quot;&amp;lt;link rel=\&quot;stylesheet\&quot; href=\&quot;/static/katex/katex.min.css\&quot;&amp;gt;&quot;</span>
<span class="w">                   </span><span class="p">(</span><span class="nf">concat</span><span class="w"> </span><span class="s">&quot;&amp;lt;script defer src=\&quot;/static/katex/katex.min.js\&quot;&amp;gt;&amp;lt;/script&amp;gt;\n&quot;</span>
<span class="w">                           </span><span class="s">&quot;&amp;lt;script defer src=\&quot;/static/katex/auto-render.min.js\&quot;&amp;gt;&amp;lt;/script&amp;gt;\n&quot;</span>
<span class="w">                           </span><span class="s">&quot;&amp;lt;script&amp;gt;\n&quot;</span>
<span class="w">                           </span><span class="s">&quot;let macros = {</span>
<span class="nv">\&quot;\\\\C\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\mathbb{C}\&quot;,</span>
<span class="nv">\&quot;\\\\N\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\mathbb{N}\&quot;,</span>
<span class="nv">\&quot;\\\\Q\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\mathbb{Q}\&quot;,</span>
<span class="nv">\&quot;\\\\R\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\mathbb{R}\&quot;,</span>
<span class="nv">\&quot;\\\\Z\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\mathbb{Z}\&quot;,</span>
<span class="nv">\&quot;</span><span class="err">’</span><span class="nv">\&quot;:</span><span class="w"> </span><span class="nv">\&quot;</span><span class="ss">&#39;\&quot;</span>
<span class="nv">}</span><span class="c1">;\n&quot;</span>
<span class="w">                           </span><span class="s">&quot;document.addEventListener(\&quot;DOMContentLoaded\&quot;, function() {</span>
<span class="nv">renderMathInElement</span><span class="p">(</span><span class="nv">document.getElementById</span><span class="p">(</span><span class="nv">\&quot;content\&quot;</span><span class="p">)</span><span class="o">,</span><span class="w"> </span><span class="nv">{</span>
<span class="nv">strict:</span><span class="w"> </span><span class="nv">false,</span>
<span class="nv">delimiters:</span><span class="w"> </span><span class="p">[</span>
<span class="nv">{\&quot;display\&quot;:</span><span class="w"> </span><span class="nv">true,\&quot;left\&quot;:</span><span class="w"> </span><span class="nv">\&quot;$$\&quot;,\&quot;right\&quot;:</span><span class="w"> </span><span class="nv">\&quot;$$\&quot;},</span>
<span class="nv">{\&quot;display\&quot;:</span><span class="w"> </span><span class="nv">true,\&quot;left\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\</span><span class="p">[</span><span class="nv">\&quot;,\&quot;right\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\</span><span class="p">]</span><span class="nv">\&quot;},</span>
<span class="nv">{\&quot;display\&quot;:</span><span class="w"> </span><span class="nv">true,\&quot;left\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\begin{equation}\&quot;,\&quot;right\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\end{equation}\&quot;},</span>
<span class="nv">{\&quot;display\&quot;:</span><span class="w"> </span><span class="nv">true,\&quot;left\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\begin{equation*}\&quot;,\&quot;right\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\end{equation*}\&quot;},</span>
<span class="nv">{\&quot;display\&quot;:</span><span class="w"> </span><span class="nv">true,\&quot;left\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\begin{align}\&quot;,\&quot;right\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\end{align}\&quot;},</span>
<span class="nv">{\&quot;display\&quot;:</span><span class="w"> </span><span class="nv">true,\&quot;left\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\begin{align*}\&quot;,\&quot;right\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\end{align*}\&quot;},</span>
<span class="nv">{\&quot;display\&quot;:</span><span class="w"> </span><span class="nv">true,\&quot;left\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\begin{alignat}\&quot;,\&quot;right\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\end{alignat}\&quot;},</span>
<span class="nv">{\&quot;display\&quot;:</span><span class="w"> </span><span class="nv">true,\&quot;left\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\begin{alignat*}\&quot;,\&quot;right\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\end{alignat*}\&quot;},</span>
<span class="nv">{\&quot;display\&quot;:</span><span class="w"> </span><span class="nv">true,\&quot;left\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\begin{gather}\&quot;,\&quot;right\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\end{gather}\&quot;},</span>
<span class="nv">{\&quot;display\&quot;:</span><span class="w"> </span><span class="nv">true,\&quot;left\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\begin{CD}\&quot;,\&quot;right\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\end{CD}\&quot;},</span>
<span class="nv">{\&quot;display\&quot;:</span><span class="w"> </span><span class="nv">false,\&quot;left\&quot;:</span><span class="w"> </span><span class="nv">\&quot;$\&quot;,\&quot;right\&quot;:</span><span class="w"> </span><span class="nv">\&quot;$\&quot;},</span>
<span class="nv">{\&quot;display\&quot;:</span><span class="w"> </span><span class="nv">false,\&quot;left\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\</span><span class="p">(</span><span class="nv">\&quot;,\&quot;right\&quot;:</span><span class="w"> </span><span class="nv">\&quot;\\\\</span><span class="p">)</span><span class="nv">\&quot;}</span>
<span class="p">]</span><span class="o">,</span>
<span class="nv">macros}</span><span class="p">)</span><span class="c1">;})\n&quot;</span>
<span class="w">                           </span><span class="s">&quot;&amp;lt;/script&amp;gt;&quot;</span><span class="p">)))</span>
<span class="w">            </span><span class="p">(</span><span class="nf">cons</span><span class="w"> </span><span class="ss">&#39;highlight</span>
<span class="w">                  </span><span class="p">(</span><span class="nf">cons</span>
<span class="w">                   </span><span class="s">&quot;&amp;lt;link rel=\&quot;stylesheet\&quot; href=\&quot;/static/highlight/dracula.css\&quot;&amp;gt;&quot;</span>
<span class="w">                   </span><span class="p">(</span><span class="nf">concat</span><span class="w"> </span><span class="s">&quot;&amp;lt;script src=\&quot;/static/highlight/highlight.min.js\&quot;&amp;gt;&amp;lt;/script&amp;gt;\n&quot;</span>
<span class="w">                           </span><span class="s">&quot;&amp;lt;script&amp;gt;\n&quot;</span>
<span class="w">                           </span><span class="s">&quot;Array.from(document.querySelectorAll(&#39;#content pre&#39;)).forEach(</span>
<span class="nv">node</span><span class="w"> </span><span class="nv">=&amp;gt</span><span class="c1">; {</span>
<span class="k">let</span><span class="w"> </span><span class="nv">codeElement</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">node.querySelector</span><span class="p">(</span><span class="nv">\&quot;code\&quot;</span><span class="p">)</span><span class="o">,</span>
<span class="w">    </span><span class="nv">excludes</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">[</span><span class="nv">\&quot;mermaid\&quot;</span><span class="p">]</span><span class="c1">;</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nv">!codeElement</span><span class="p">)</span><span class="nv">{</span>
<span class="nb">return</span>
<span class="nv">}</span>
<span class="k">let</span><span class="w"> </span><span class="nv">language</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">codeElement.getAttribute</span><span class="p">(</span><span class="nv">\&quot;class\&quot;</span><span class="p">)</span><span class="o">.</span><span class="nv">replace</span><span class="p">(</span><span class="nv">/^language-/,</span><span class="w"> </span><span class="nv">\&quot;\&quot;</span><span class="p">)</span><span class="c1">;</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nv">excludes.includes</span><span class="p">(</span><span class="nv">language</span><span class="p">))</span><span class="w"> </span><span class="nv">{</span>
<span class="nb">return</span>
<span class="nv">}</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nv">language</span><span class="w"> </span><span class="nv">==</span><span class="w"> </span><span class="nv">\&quot;emacs-lisp\&quot;</span><span class="w"> </span><span class="nv">||</span><span class="w"> </span><span class="nv">language</span><span class="w"> </span><span class="nv">==</span><span class="w"> </span><span class="nv">\&quot;elisp\&quot;</span><span class="p">)</span><span class="w"> </span><span class="nv">{</span>
<span class="nv">codeElement.setAttribute</span><span class="p">(</span><span class="nv">\&quot;class\&quot;,</span><span class="w"> </span><span class="nv">\&quot;language-lisp\&quot;</span><span class="p">)</span><span class="c1">;</span>
<span class="nv">}</span>
<span class="nv">hljs.highlightElement</span><span class="p">(</span><span class="nv">codeElement</span><span class="p">)</span><span class="c1">;</span>
<span class="nv">}</span><span class="p">)</span><span class="c1">;\n&quot;</span>
<span class="w">                           </span><span class="s">&quot;&amp;lt;/script&amp;gt;&quot;</span><span class="p">)))</span>
<span class="w">            </span><span class="p">(</span><span class="nf">cons</span><span class="w"> </span><span class="ss">&#39;mermaid</span>
<span class="w">                  </span><span class="p">(</span><span class="nf">cons</span>
<span class="w">                   </span><span class="s">&quot;&quot;</span>
<span class="w">                   </span><span class="p">(</span><span class="nf">concat</span><span class="w"> </span><span class="s">&quot;&amp;lt;script src=\&quot;/static/mermaid/mermaid.min.js\&quot;&amp;gt;&amp;lt;/script&amp;gt;\n&quot;</span>
<span class="w">                           </span><span class="s">&quot;&amp;lt;script&amp;gt;\n&quot;</span>
<span class="w">                           </span><span class="s">&quot;mermaid.initialize({theme: &#39;neutral&#39;, securityLevel: &#39;loose&#39;});\n&quot;</span>
<span class="w">                           </span><span class="s">&quot;&amp;lt;/script&amp;gt;&quot;</span><span class="p">)))</span>
<span class="w">            </span><span class="p">(</span><span class="nf">cons</span><span class="w"> </span><span class="ss">&#39;highlight-pygments</span>
<span class="w">                  </span><span class="p">(</span><span class="nf">cons</span>
<span class="w">                   </span><span class="s">&quot;&amp;lt;link rel=\&quot;stylesheet\&quot; href=\&quot;/static/pygments/dracula.css\&quot;&amp;gt;&quot;</span>
<span class="w">                   </span><span class="s">&quot;&quot;</span><span class="p">))</span>
<span class="w">            </span><span class="p">)))</span>
 </pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgdbf8249" class="outline-2">
<h2 id="orgdbf8249">配置结束</h2>
<div class="outline-text-2" id="text-orgdbf8249">
<div class="org-src-container">
<pre> <span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">startup-echo-area-message</span><span class="w"> </span><span class="p">()</span>
<span class="w">  </span><span class="p">(</span><span class="nv">emacs-init-time</span><span class="w"> </span><span class="s">&quot;Emacs starts in %.2f sec. Enjoy hacking :)&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nb">provide</span><span class="w"> </span><span class="ss">&#39;init</span><span class="p">)</span>
 </pre>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="text-footnotes" role="doc-endnotes">
<ol>
<li id="fn:1">
<p class="footpara">
<a href="https://emacs.nasy.moe" target="_blank">Nasy Emacs 配置</a>
<a href="#fnr:1.1" class="footnote-backref" role="doc-backlink">↩︎</a>
<a href="#fnr:1.2" class="footnote-backref" role="doc-backlink">↩︎</a>
</p>
</li>
<li id="fn:2">
<p class="footpara">
<a href="https://github.com/alexluigit/emacs-grandview" target="_blank">GitHub - alexluigit/emacs-grandview: 原非大观。</a>
<a href="#fnr:2.1" class="footnote-backref" role="doc-backlink">↩︎</a>
<a href="#fnr:2.2" class="footnote-backref" role="doc-backlink">↩︎</a>
</p>
</li>
<li id="fn:3">
<p class="footpara">
<a href="https://emacs-china.org/t/lsp-bridge/20786/1208?u=fingerknight" target="_blank">lsp-bridge &#x2013; 速度最快的语法补全插件 - #1208，来自 blove - Emacs-general - Emacs China</a>
<a href="#fnr:3.1" class="footnote-backref" role="doc-backlink">↩︎</a>
</p>
</li>
<li id="fn:4">
<p class="footpara">
<a href="https://www.emacswiki.org/emacs/SetupEl" target="_blank">EmacsWiki: Setup El</a>
<a href="#fnr:4.1" class="footnote-backref" role="doc-backlink">↩︎</a>
<a href="#fnr:4.2" class="footnote-backref" role="doc-backlink">↩︎</a>
<a href="#fnr:4.3" class="footnote-backref" role="doc-backlink">↩︎</a>
</p>
</li>
</ol>
</div>
</div>
</div>
<div id="postamble" class="status">
</div>
</div>
<div class="footer">
<center> The End </center></div>
</body>
</html>
